--TABLE: ATIVIDADE--------------------------------------------------------
CREATE TABLE "WMS"."ATIVIDADE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"LOTE_ID" NUMBER, 
	"CARGA_ID" NUMBER, 
	"PESSOA_ID" NUMBER, 
	"PRIORIDADE" NUMBER, 
	"LOTE" NUMBER, 
	"LS" VARCHAR2(2), 
	"PRODUTO_ID" NUMBER, 
	"QTD_PEDIDO" NUMBER, 
	"EMB_ID" NUMBER, 
	"EMB" VARCHAR2(2), 
	"QTD_EMB" NUMBER, 
	"PESO" NUMBER, 
	"VOLUME" NUMBER, 
	"STATUS" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"SEP_ID" NUMBER, 
	"SEP_QTD" NUMBER, 
	"SEP_ENDERECO" VARCHAR2(100), 
	"SEP_START" DATE, 
	"SEP_END" DATE, 
	"CONF_ID" NUMBER, 
	"CONF_QTD" NUMBER, 
	"CORTE_QTD" NUMBER, 
	"CONF_START" DATE, 
	"CONF_END" DATE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "ATIVIDADE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ATIVIDADE_LOTE_ID_FK" FOREIGN KEY ("LOTE_ID")
	  REFERENCES "WMS"."LOTE" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "ATIVIDADE_CARGA_ID_FK" FOREIGN KEY ("CARGA_ID")
	  REFERENCES "WMS"."CARGA" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: BOX--------------------------------------------------------
CREATE TABLE "WMS"."BOX" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"PRIORIDADE" NUMBER NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "BOX_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: CARGA--------------------------------------------------------
CREATE TABLE "WMS"."CARGA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"LOTES" NUMBER, 
	"PRIORIDADE" NUMBER, 
	"BOX_ID" NUMBER, 
	"PESO" NUMBER, 
	"VOLUME" NUMBER, 
	"STATUS" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"DATE_START" DATE, 
	"DATE_END" DATE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"TIPO" VARCHAR2(1), 
	 CONSTRAINT "CARGA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: CARGA_IMPORT--------------------------------------------------------
CREATE TABLE "WMS"."CARGA_IMPORT" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"STATUS" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"PRIORIDADE" NUMBER, 
	"LOTES" NUMBER, 
	"PESO" NUMBER, 
	"VOLUME" NUMBER, 
	"BOX_ID" NUMBER, 
	"DESTINO" VARCHAR2(4000), 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"TIPO" VARCHAR2(1), 
	"IMPRESSORA_ID" NUMBER, 
	 CONSTRAINT "CARGA_IMPORT_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: CORTE--------------------------------------------------------
CREATE TABLE "WMS"."CORTE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CARGA_ID" NUMBER NOT NULL ENABLE, 
	"LOTE" NUMBER NOT NULL ENABLE, 
	"PRODUTO_ID" NUMBER NOT NULL ENABLE, 
	"CONF_ID" NUMBER NOT NULL ENABLE, 
	"CONF_QTD" VARCHAR2(4000) NOT NULL ENABLE, 
	"QTD_PEDIDO" VARCHAR2(4000) NOT NULL ENABLE, 
	"DONE" NUMBER NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"PESSOA_ID" NUMBER, 
	"QTD_EMB" NUMBER, 
	 CONSTRAINT "CORTE_DONE_CC" CHECK (done in (0,1)) ENABLE, 
	 CONSTRAINT "CORTE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: CORTE_LOG--------------------------------------------------------
CREATE TABLE "WMS"."CORTE_LOG" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CORTE_ID" NUMBER NOT NULL ENABLE, 
	"PESSOA_ID" NUMBER NOT NULL ENABLE, 
	"QTD_EMB" NUMBER, 
	"QTD_PEDIDO" NUMBER, 
	"QTD_DIGITADO" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "CORTE_LOG_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: EMBALAGEM_CODIGO--------------------------------------------------------
CREATE TABLE "WMS"."EMBALAGEM_CODIGO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"EMBALAGEM_ID" NUMBER NOT NULL ENABLE, 
	"CODIGO" VARCHAR2(100) NOT NULL ENABLE, 
	"TIPO" VARCHAR2(1) NOT NULL ENABLE, 
	 CONSTRAINT "EMBALAGEM_CODIG_TIPO_CODIGO_CC" CHECK ("TIPO"='E' OR "TIPO"='D' OR "TIPO"='I' OR "TIPO"='T') DISABLE, 
	 CONSTRAINT "EMBALAGEM_CODIGO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: EMPRESA--------------------------------------------------------
CREATE TABLE "WMS"."EMPRESA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(4000), 
	 CONSTRAINT "EMPRESA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"RUA" VARCHAR2(3) NOT NULL ENABLE, 
	"PREDIO" NUMBER NOT NULL ENABLE, 
	"APARTAMENTO" NUMBER NOT NULL ENABLE, 
	"SALA" NUMBER NOT NULL ENABLE, 
	"PULMAO" NUMBER, 
	"PRODUTO_ID" NUMBER, 
	"QTD_ATUAL" NUMBER, 
	"STATUS" VARCHAR2(60), 
	"TIPO_ID" NUMBER, 
	"ESPECIE_ID" NUMBER, 
	"TERREO" NUMBER, 
	"EMBALAGEM_ID" NUMBER, 
	"EXPEDICAO" NUMBER, 
	"TIPO_REPOSICAO" VARCHAR2(1), 
	"TIPO_ESPECIAL" NUMBER, 
	"GERAR_REPOSICAO" NUMBER, 
	"VIRTUAL" NUMBER, 
	 CONSTRAINT "ENDERECO_PULMAO_CC" CHECK (pulmao in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ENDERECO_TERREO_CC" CHECK (terreo in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_EXPEDICAO_CC" CHECK (expedicao in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_STATUS_CC" CHECK (status in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_TIPO_ID_FK" FOREIGN KEY ("TIPO_ID")
	  REFERENCES "WMS"."ENDERECO_TIPO" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "ENDERECO_ESPECIE_ID_FK" FOREIGN KEY ("ESPECIE_ID")
	  REFERENCES "WMS"."ENDERECO_ESPECIE" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "ENDERECO_EMBALAGEM_ID_FK" FOREIGN KEY ("EMBALAGEM_ID")
	  REFERENCES "WMS"."PRODUTO_EMBALAGEM" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO_ARMAZENAGEM--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO_ARMAZENAGEM" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ENDERECO_ID" NUMBER, 
	"ARMAZENAGEM_ID" NUMBER, 
	 CONSTRAINT "ENDERECO_ARMAZENAG_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ENDERECO_ARMAZE_ENDERECO_ID_FK" FOREIGN KEY ("ENDERECO_ID")
	  REFERENCES "WMS"."ENDERECO" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "ENDERECO_ARMA_ARMAZENAGEM_I_FK" FOREIGN KEY ("ARMAZENAGEM_ID")
	  REFERENCES "WMS"."TIPO_ARMAZENAGEM" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO_ESPECIE--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO_ESPECIE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(100) NOT NULL ENABLE, 
	"STATUS" NUMBER, 
	"SIGLA" VARCHAR2(1), 
	 CONSTRAINT "ENDERECO_ESPECIE_STATUS_CC" CHECK (status in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_ESPECIE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO_RUA--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO_RUA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"RUA" VARCHAR2(3) NOT NULL ENABLE, 
	"EXPEDICAO" NUMBER, 
	"VIRTUAL" NUMBER, 
	"MAX_ATV_ABAST" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "ENDERECO_RUA_EXPEDICAO_CC" CHECK (expedicao in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_RUA_VIRTUAL_CC" CHECK (virtual in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_RUA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO_TIPO--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO_TIPO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(100) NOT NULL ENABLE, 
	"ALTURA" NUMBER, 
	"LARGURA" NUMBER, 
	"PROFUNDIDADE" NUMBER, 
	"ORDEM" NUMBER, 
	"STATUS" NUMBER, 
	 CONSTRAINT "ENDERECO_TIPO_STATUS_CC" CHECK (status in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_TIPO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ENDERECO_VALIDADE--------------------------------------------------------
CREATE TABLE "WMS"."ENDERECO_VALIDADE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ENDERECO_ID" NUMBER, 
	"QTD_ATUAL" NUMBER NOT NULL ENABLE, 
	"DATA_VALIDADE" DATE NOT NULL ENABLE, 
	"DATA_RECEBIMENTO" DATE NOT NULL ENABLE, 
	"SATUS" NUMBER, 
	 CONSTRAINT "ENDERECO_VALIDADE_SATUS_CC" CHECK (satus in (0,1)) ENABLE, 
	 CONSTRAINT "ENDERECO_VALIDADE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ENDERECO_VALIDA_ENDERECO_ID_FK" FOREIGN KEY ("ENDERECO_ID")
	  REFERENCES "WMS"."ENDERECO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ERRO_SEPARACAO--------------------------------------------------------
CREATE TABLE "WMS"."ERRO_SEPARACAO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ATIVIDADE_ID" NUMBER NOT NULL ENABLE, 
	"QTD_ERRO" NUMBER NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "ERRO_SEPARACAO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: ERRO_SEPARACAO_ALERTA--------------------------------------------------------
CREATE TABLE "WMS"."ERRO_SEPARACAO_ALERTA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ERRO_SEPARACAO_ID" NUMBER, 
	"BOX_ID" NUMBER NOT NULL ENABLE, 
	"LOCAL" VARCHAR2(4000), 
	"DONE_PUBLICO" NUMBER, 
	"DONE_PRIVADO" NUMBER, 
	"DONE_ADMIN" NUMBER DEFAULT ON NULL '1' NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "ERRO_SEPARACAO_DONE_PUBLIC_CC" CHECK (done_publico in (0,1)) ENABLE, 
	 CONSTRAINT "ERRO_SEPARACAO_DONE_PRIVAD_CC" CHECK (done_privado in (0,1)) ENABLE, 
	 CONSTRAINT "ERRO_SEPARACAO_DONE_ADMIN_CC" CHECK (done_admin in (0,1)) ENABLE, 
	 CONSTRAINT "ERRO_SEPARACAO_ALE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ERRO_SEPARACA_ERRO_SEPARACA_FK" FOREIGN KEY ("ERRO_SEPARACAO_ID")
	  REFERENCES "WMS"."ERRO_SEPARACAO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: FORNECEDOR--------------------------------------------------------
CREATE TABLE "WMS"."FORNECEDOR" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(4000), 
	 CONSTRAINT "FORNECEDOR_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: GRUPO_ACESSO--------------------------------------------------------
CREATE TABLE "WMS"."GRUPO_ACESSO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(4000), 
	 CONSTRAINT "GRUPO_ACESSO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: GRUPO_PERMISSAO--------------------------------------------------------
CREATE TABLE "WMS"."GRUPO_PERMISSAO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"GRUPO_ACESSO_ID" NUMBER, 
	"LIST_ENTRY_ID" NUMBER, 
	 CONSTRAINT "GRUPO_PERMISSAO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "GRUPO_PERMISS_GRUPO_ACESSO_FK" FOREIGN KEY ("GRUPO_ACESSO_ID")
	  REFERENCES "WMS"."GRUPO_ACESSO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: HISTORY--------------------------------------------------------
CREATE TABLE "WMS"."HISTORY" 
   (	"ID" NUMBER, 
	"TABLE_NAME" VARCHAR2(128), 
	"COLUMN_NAME" VARCHAR2(128), 
	"ACTION" VARCHAR2(1), 
	"ACTION_DATE" DATE, 
	"ACTION_BY" VARCHAR2(255), 
	"DATA_TYPE" VARCHAR2(255), 
	"PK1" NUMBER, 
	"TAB_ROW_VERSION" NUMBER(*,0), 
	"OLD_VC" VARCHAR2(4000), 
	"NEW_VC" VARCHAR2(4000), 
	"OLD_NUMBER" NUMBER, 
	"NEW_NUMBER" NUMBER, 
	"OLD_DATE" DATE, 
	"NEW_DATE" DATE, 
	"OLD_TS" TIMESTAMP (6), 
	"NEW_TS" TIMESTAMP (6), 
	"OLD_TSWTZ" TIMESTAMP (6) WITH TIME ZONE, 
	"NEW_TSWTZ" TIMESTAMP (6) WITH TIME ZONE, 
	"OLD_TSWLTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE, 
	"NEW_TSWLTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE, 
	"OLD_CLOB" CLOB, 
	"NEW_CLOB" CLOB, 
	"OLD_BLOB" BLOB, 
	"NEW_BLOB" BLOB, 
	 CHECK (action in ('I','U','D')) ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: HTMLDB_PLAN_TABLE--------------------------------------------------------
CREATE TABLE "WMS"."HTMLDB_PLAN_TABLE" 
   (	"STATEMENT_ID" VARCHAR2(30), 
	"PLAN_ID" NUMBER, 
	"TIMESTAMP" DATE, 
	"REMARKS" VARCHAR2(4000), 
	"OPERATION" VARCHAR2(30), 
	"OPTIONS" VARCHAR2(255), 
	"OBJECT_NODE" VARCHAR2(128), 
	"OBJECT_OWNER" VARCHAR2(128), 
	"OBJECT_NAME" VARCHAR2(128), 
	"OBJECT_ALIAS" VARCHAR2(261), 
	"OBJECT_INSTANCE" NUMBER(*,0), 
	"OBJECT_TYPE" VARCHAR2(128), 
	"OPTIMIZER" VARCHAR2(255), 
	"SEARCH_COLUMNS" NUMBER, 
	"ID" NUMBER(*,0), 
	"PARENT_ID" NUMBER(*,0), 
	"DEPTH" NUMBER(*,0), 
	"POSITION" NUMBER(*,0), 
	"COST" NUMBER(*,0), 
	"CARDINALITY" NUMBER(*,0), 
	"BYTES" NUMBER(*,0), 
	"OTHER_TAG" VARCHAR2(255), 
	"PARTITION_START" VARCHAR2(255), 
	"PARTITION_STOP" VARCHAR2(255), 
	"PARTITION_ID" NUMBER(*,0), 
	"OTHER" LONG, 
	"DISTRIBUTION" VARCHAR2(30), 
	"CPU_COST" NUMBER(*,0), 
	"IO_COST" NUMBER(*,0), 
	"TEMP_SPACE" NUMBER(*,0), 
	"ACCESS_PREDICATES" VARCHAR2(4000), 
	"FILTER_PREDICATES" VARCHAR2(4000), 
	"PROJECTION" VARCHAR2(4000), 
	"TIME" NUMBER(*,0), 
	"QBLOCK_NAME" VARCHAR2(128)
   ) ;
--------------------------------------------------------------------------------
--TABLE: IMPRESSORA--------------------------------------------------------
CREATE TABLE "WMS"."IMPRESSORA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(4000), 
	"IP" VARCHAR2(4000), 
	"DESCRICAO" VARCHAR2(4000), 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "IMPRESSORA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: LINHADESEPARACAO--------------------------------------------------------
CREATE TABLE "WMS"."LINHADESEPARACAO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"LS" VARCHAR2(2), 
	"NOME" VARCHAR2(4000), 
	"ATACADOVAREJO" VARCHAR2(1), 
	"TIPOSEPAR" VARCHAR2(1), 
	"STATUS" NUMBER, 
	"PESOMAX" NUMBER, 
	"VOLUMEMAX" NUMBER, 
	"MAXATV_ABAST" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "LINHADESEPARACAO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "LINHADESEPARACAO_UNQ_LS" UNIQUE ("LS")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: LOTE--------------------------------------------------------
CREATE TABLE "WMS"."LOTE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CARGA_ID" NUMBER, 
	"PESSOA_ID" NUMBER, 
	"PRIORIDADE" NUMBER, 
	"LOTE" NUMBER, 
	"LS_ID" NUMBER, 
	"LS" VARCHAR2(2), 
	"PESO" NUMBER, 
	"VOLUME" NUMBER, 
	"QTD_ITEM" NUMBER, 
	"QTD_VOLUME" NUMBER, 
	"STATUS" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"SEP_ID" NUMBER, 
	"SEP_START" DATE, 
	"SEP_END" DATE, 
	"CONF_ID" NUMBER, 
	"CONF_START" DATE, 
	"CONF_END" DATE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "LOTE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "LOTE_CARGA_ID_FK" FOREIGN KEY ("CARGA_ID")
	  REFERENCES "WMS"."CARGA" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: LOTE_PRINT_LOG--------------------------------------------------------
CREATE TABLE "WMS"."LOTE_PRINT_LOG" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CARGA_ID" NUMBER, 
	"LOTE" VARCHAR2(4000), 
	"SEP_ID" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "LOTE_PRINT_LOG_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: MOVIMENTACAO--------------------------------------------------------
CREATE TABLE "WMS"."MOVIMENTACAO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"TIPO" VARCHAR2(1), 
	"ORIGEM_ID" NUMBER, 
	"DESTINO_ID" NUMBER, 
	"STATUS" NUMBER, 
	"EMP_ID" NUMBER, 
	"EMP_START" DATE, 
	"EMP_END" DATE, 
	"ABAST_ID" NUMBER, 
	"ABAST_START" DATE, 
	"ABAST_END" DATE, 
	"LOTE_ID" NUMBER, 
	"QTD" NUMBER, 
	"EMB" VARCHAR2(2), 
	"QTD_EMB" NUMBER, 
	"PALETE_ID" NUMBER, 
	"PRIORIDADE" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_CON" CHECK ( "TIPO" in ('A','D','R','P','E')) ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_EMP_ID_FK" FOREIGN KEY ("EMP_ID")
	  REFERENCES "WMS"."PRODUTIVO" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_ABAST_ID_FK" FOREIGN KEY ("ABAST_ID")
	  REFERENCES "WMS"."PRODUTIVO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: MOVIMENTACAO_PALETE--------------------------------------------------------
CREATE TABLE "WMS"."MOVIMENTACAO_PALETE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"MOVIMENTACAO_ID" NUMBER, 
	"PALETE_ID" NUMBER, 
	 CONSTRAINT "MOVIMENTACAO_PALET_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "MOVI_PALETE_MOV_FK" FOREIGN KEY ("MOVIMENTACAO_ID")
	  REFERENCES "WMS"."MOVIMENTACAO" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "MOVI_PALET_PALETE_FK" FOREIGN KEY ("PALETE_ID")
	  REFERENCES "WMS"."PALETE" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: MOVIMENTACAO_VISUAL--------------------------------------------------------
CREATE TABLE "WMS"."MOVIMENTACAO_VISUAL" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ORIGEM_ID" NUMBER NOT NULL ENABLE, 
	"DESTINO_ID" NUMBER NOT NULL ENABLE, 
	"QTD" NUMBER NOT NULL ENABLE, 
	"EMBALAGEM_ID" NUMBER NOT NULL ENABLE, 
	"TIPO" VARCHAR2(4000) NOT NULL ENABLE, 
	"PALETE_ID" NUMBER, 
	"MOVIMENTACAO_ID" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_VISUA_TIPO_CC" CHECK (tipo in ('A','D','R')) ENABLE, 
	 CONSTRAINT "MOVIMENTACAO_VISUA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PALETE--------------------------------------------------------
CREATE TABLE "WMS"."PALETE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"QTD" NUMBER NOT NULL ENABLE, 
	"ENDERECO_ID" NUMBER NOT NULL ENABLE, 
	"EMBALAGEM_ID" NUMBER NOT NULL ENABLE, 
	"STATUS" NUMBER NOT NULL ENABLE, 
	"CONF_ID" NUMBER, 
	"CONF_QTD" NUMBER, 
	"CONF_START" DATE, 
	"CONF_END" DATE, 
	"VALIDADE" DATE, 
	"CARGA_ID" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "PALETE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PALETE_VALIDADE--------------------------------------------------------
CREATE TABLE "WMS"."PALETE_VALIDADE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"PALETE_ID" NUMBER NOT NULL ENABLE, 
	"VALIDADE" DATE NOT NULL ENABLE, 
	"STATUS" NUMBER NOT NULL ENABLE, 
	"CONF_QTD" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "PALETE_VALIDADE_STATUS_CC" CHECK (status in ('-1','0','1')) ENABLE, 
	 CONSTRAINT "PALETE_VALIDADE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PALETE_VALIDADE_PALETE_ID_FK" FOREIGN KEY ("PALETE_ID")
	  REFERENCES "WMS"."PALETE" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PARAMETRO_ZPL--------------------------------------------------------
CREATE TABLE "WMS"."PARAMETRO_ZPL" 
   (	"PADRAOETQ" VARCHAR2(20) NOT NULL ENABLE, 
	"TIPOETIQUETA" VARCHAR2(30) NOT NULL ENABLE, 
	"MODELOIMP" VARCHAR2(10) NOT NULL ENABLE, 
	"ETQLINHA" NUMBER(3,0) NOT NULL ENABLE, 
	"ETQCOLUNA" NUMBER(3,0) NOT NULL ENABLE, 
	"PRECOMANDO" VARCHAR2(40) NOT NULL ENABLE, 
	"COLUNABANCO" VARCHAR2(30) NOT NULL ENABLE, 
	"SUFCOMANDO" VARCHAR2(25), 
	"INDTIPOCOMPLEMENTO" VARCHAR2(1), 
	"QTDCOMPLETACOLUNA" NUMBER(3,0), 
	"TIPCOMANDO" VARCHAR2(1), 
	"NROEMPRESA" NUMBER(3,0), 
	"SEQPARAMETQ" NUMBER(*,0) NOT NULL ENABLE, 
	"SCRIPT" VARCHAR2(250)
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRINT_ERROR--------------------------------------------------------
CREATE TABLE "WMS"."PRINT_ERROR" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CARGA_ID" NUMBER NOT NULL ENABLE, 
	"LOTE" NUMBER, 
	"INFO" VARCHAR2(4000), 
	"ALERT_STATUS" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "PRINT_ERROR_ALERT_STATUS_CC" CHECK (alert_status in (0,1)) ENABLE, 
	 CONSTRAINT "PRINT_ERROR_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTIVO--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTIVO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"STATUS" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"NOME" VARCHAR2(255) NOT NULL ENABLE, 
	"APELIDO" VARCHAR2(255) NOT NULL ENABLE, 
	"NOME_API_MSG" VARCHAR2(255) NOT NULL ENABLE, 
	"ATIVIDADE" VARCHAR2(1), 
	"FUNCAO" VARCHAR2(1), 
	"PADRAO" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"EXCLUSIVO" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"ORDER_ATV" VARCHAR2(20) DEFAULT ON NULL 'DEFAULT' NOT NULL ENABLE, 
	"EMPNIVEL" NUMBER, 
	"EMPTIPO" NUMBER, 
	"ESTACAO" NUMBER DEFAULT ON NULL '0' NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"TIPO_ATIVIDADE" VARCHAR2(1), 
	 CONSTRAINT "PRODUTIVO_ATIVIDADE_CC" CHECK (atividade in ('A','C','E','S','T')) ENABLE, 
	 CONSTRAINT "PRODUTIVO_FUNCAO_CC" CHECK (funcao in ('A','C','E','M','N','S','T')) ENABLE, 
	 CONSTRAINT "PRODUTIVO_PADRAO_CC" CHECK (padrao in (0,1)) ENABLE, 
	 CONSTRAINT "PRODUTIVO_EXCLUSIVO_CC" CHECK (exclusivo in (0,1)) ENABLE, 
	 CONSTRAINT "PRODUTIVO_ESTACAO_CC" CHECK (estacao in (0,1)) ENABLE, 
	 CONSTRAINT "PRODUTIVO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTIVO_STATUS_CC" CHECK ( "STATUS" in (-1,0,1)) ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTIVO_BOX--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTIVO_BOX" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"PRODUTIVO_ID" NUMBER, 
	"BOX" NUMBER NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "PRODUTIVO_BOX_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTIVO_BOX_PRODUTIVO_ID_FK" FOREIGN KEY ("PRODUTIVO_ID")
	  REFERENCES "WMS"."PRODUTIVO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTIVO_FUNCAO--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTIVO_FUNCAO" 
   (	"DESCFUNCAO" VARCHAR2(14), 
	"TIPFUNCAO" VARCHAR2(5) NOT NULL ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTIVO_LS--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTIVO_LS" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"PRODUTIVO_ID" NUMBER, 
	"LS_ID" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "PRODUTIVO_LS_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTIVO_LS_PRODUTIVO_ID_FK" FOREIGN KEY ("PRODUTIVO_ID")
	  REFERENCES "WMS"."PRODUTIVO" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "PRODUTIVO_LS_LS_ID_FK" FOREIGN KEY ("LS_ID")
	  REFERENCES "WMS"."LINHADESEPARACAO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTIVO_RUA--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTIVO_RUA" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"PRODUTIVO_ID" NUMBER, 
	"RUA" VARCHAR2(3) NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "PRODUTIVO_RUA_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTIVO_RUA_PRODUTIVO_ID_FK" FOREIGN KEY ("PRODUTIVO_ID")
	  REFERENCES "WMS"."PRODUTIVO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTO--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(1000), 
	"ENDERECO_TIPO_ID" NUMBER, 
	"TIPO_ARMAZENAGEM_ID" NUMBER, 
	"DIAS_VALIDADE" NUMBER, 
	"STATUS" NUMBER, 
	"EMBALAGEM_ID" NUMBER, 
	"FORNECEDOR_ID" NUMBER, 
	"REFFABRICANTE" VARCHAR2(61), 
	 CONSTRAINT "PRODUTO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTO_STATUS_CC" CHECK (status in ('0','1')) ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTO_EMBALAGEM--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTO_EMBALAGEM" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"LS" VARCHAR2(3), 
	"PRODUTO_ID" NUMBER, 
	"EMB" VARCHAR2(2), 
	"QTD_EMB" NUMBER, 
	"PESO_BRUTO" NUMBER, 
	"PESO_LIQUIDO" NUMBER, 
	"ALTURA" NUMBER, 
	"LARGURA" NUMBER, 
	"PROFUNDIDADE" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "PRODUTO_EMBALAGEM_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PRODUTO_ESPECIE--------------------------------------------------------
CREATE TABLE "WMS"."PRODUTO_ESPECIE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"ESPECIE_ID" NUMBER, 
	"EMBALAGEM_ID" NUMBER, 
	"ESTOQUE_MIN" NUMBER, 
	"LASTRO" NUMBER, 
	"ALTURA" NUMBER, 
	"SOBRA" NUMBER, 
	"PRODUTO_ID" NUMBER, 
	"DATA" DATE, 
	 CONSTRAINT "PRODUTO_ESPECIE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUTO_ESPECIE_ESPECIE_ID_FK" FOREIGN KEY ("ESPECIE_ID")
	  REFERENCES "WMS"."ENDERECO_ESPECIE" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "PRODUTO_ESPECIE_EMBALAGEM_I_FK" FOREIGN KEY ("EMBALAGEM_ID")
	  REFERENCES "WMS"."PRODUTO_EMBALAGEM" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: PULMAO_BOX--------------------------------------------------------
CREATE TABLE "WMS"."PULMAO_BOX" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"CARGA_ID" NUMBER, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255) NOT NULL ENABLE, 
	 CONSTRAINT "PULMAO_BOX_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PULMAO_BOX_CARGA_ID_FK" FOREIGN KEY ("CARGA_ID")
	  REFERENCES "WMS"."CARGA" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: REGRA_VALIDADE--------------------------------------------------------
CREATE TABLE "WMS"."REGRA_VALIDADE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"EMPRESA_ID" NUMBER, 
	"FORNECEDOR_ID" NUMBER, 
	"PRODUTO_ID" NUMBER, 
	"VALOR_RECEBIMENTO" NUMBER, 
	"VALOR_EXPEDICAO" NUMBER, 
	 CONSTRAINT "REGRA_VALIDADE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "REGRA_VALIDADE_EMPRESA_ID_FK" FOREIGN KEY ("EMPRESA_ID")
	  REFERENCES "WMS"."EMPRESA" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "REGRA_VALIDADE_FORNECEDOR_I_FK" FOREIGN KEY ("FORNECEDOR_ID")
	  REFERENCES "WMS"."FORNECEDOR" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "REGRA_VALIDADE_PRODUTO_ID_FK" FOREIGN KEY ("PRODUTO_ID")
	  REFERENCES "WMS"."PRODUTO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: TESTE--------------------------------------------------------
CREATE TABLE "WMS"."TESTE" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"C_NUM" VARCHAR2(4000), 
	"C_VC" VARCHAR2(4000), 
	"C_DATE" DATE, 
	 CONSTRAINT "TESTE_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: TESTE_DIFF--------------------------------------------------------
CREATE TABLE "WMS"."TESTE_DIFF" 
   (	"C_NUMBER" NUMBER, 
	"C_VC100" VARCHAR2(100), 
	 CONSTRAINT "TESTE_DIFF_PK" PRIMARY KEY ("C_NUMBER")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: TIPO_ARMAZENAGEM--------------------------------------------------------
CREATE TABLE "WMS"."TIPO_ARMAZENAGEM" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"NOME" VARCHAR2(100) NOT NULL ENABLE, 
	"STATUS" NUMBER, 
	 CONSTRAINT "TIPO_ARMAZENAGEM_STATUS_CC" CHECK (status in (0,1)) ENABLE, 
	 CONSTRAINT "TIPO_ARMAZENAGEM_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;
--------------------------------------------------------------------------------
--TABLE: USUARIO--------------------------------------------------------
CREATE TABLE "WMS"."USUARIO" 
   (	"ID" NUMBER NOT NULL ENABLE, 
	"LOGIN" VARCHAR2(20), 
	"NOME" VARCHAR2(100), 
	"SENHA" VARCHAR2(20), 
	"MUDAR_SENHA" NUMBER, 
	"GRUPO_ID" NUMBER, 
	 CONSTRAINT "USUARIO_ID_PK" PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "USUARIO_GRUPO_ID_FK" FOREIGN KEY ("GRUPO_ID")
	  REFERENCES "WMS"."GRUPO_ACESSO" ("ID") ON DELETE CASCADE ENABLE
   ) ;
--------------------------------------------------------------------------------
--SEQUENCE: ACTION_ITEMS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ACTION_ITEMS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ATIVIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ATIVIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 2515710 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ATTACHMENTS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ATTACHMENTS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: BOX_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."BOX_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: CARGA_IMPORT_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."CARGA_IMPORT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: CARGA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."CARGA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: CORTE_LOG_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."CORTE_LOG_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 232411 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: CORTE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."CORTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21305 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEMO_CUST_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEMO_CUST_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 100 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEMO_ORDER_ITEMS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEMO_ORDER_ITEMS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 160 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEMO_ORD_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEMO_ORD_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 11 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEMO_PROD_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEMO_PROD_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 100 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEPT_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEPT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 50 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEV_ATIVIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEV_ATIVIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 62401 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEV_CARGA_IMPORT_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEV_CARGA_IMPORT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEV_CARGA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEV_CARGA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEV_HISTORY_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEV_HISTORY_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1656661 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: DEV_LOTE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."DEV_LOTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 13741 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: EMBALAGEM_CODIGO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."EMBALAGEM_CODIGO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 2386261 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: EMBALAGEM_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."EMBALAGEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: EMPRESA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."EMPRESA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: EMP_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."EMP_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 8000 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_ARMAZENAGEM_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_ARMAZENAGEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 4122541 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_ESPECIE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_ESPECIE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_RUA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_RUA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1241 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 34715 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_TIPO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_TIPO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ENDERECO_VALIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ENDERECO_VALIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ERRO_SEPARACAO_ALERTA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ERRO_SEPARACAO_ALERTA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 44079 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: ERRO_SEPARACAO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."ERRO_SEPARACAO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 22945 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: FORNECEDOR_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."FORNECEDOR_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: GRUPO_ACESSO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."GRUPO_ACESSO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: GRUPO_PERMISSAO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."GRUPO_PERMISSAO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 161 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: HISTORY_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."HISTORY_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 41790490 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: IMPRESSORA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."IMPRESSORA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 121 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: LINHADESEPARACAO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."LINHADESEPARACAO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 281 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: LINKS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."LINKS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: LOTE_PRINT_LOG_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."LOTE_PRINT_LOG_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 302820 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: LOTE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."LOTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 565704 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: MILESTONES_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."MILESTONES_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: MOVIMENTACAO_PALETE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."MOVIMENTACAO_PALETE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 341 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: MOVIMENTACAO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."MOVIMENTACAO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1541 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: MOVIMENTACAO_VISUAL_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."MOVIMENTACAO_VISUAL_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 41 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PALETE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PALETE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 410515 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PALETE_VALIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PALETE_VALIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 101 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRINT_ERROR_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRINT_ERROR_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTIVO_BOX_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTIVO_BOX_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 101 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTIVO_LS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTIVO_LS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 15218 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTIVO_RUA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTIVO_RUA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 281 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTIVO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTIVO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTO_CODIGO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTO_CODIGO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 12361 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTO_EMBALAGEM_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTO_EMBALAGEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 105221 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTO_ESPECIE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTO_ESPECIE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1378221 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTO_NORMA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTO_NORMA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PRODUTO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PRODUTO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PROJECTS_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PROJECTS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: PULMAO_BOX_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."PULMAO_BOX_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 4573 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: REGRA_VALIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."REGRA_VALIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 41 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TESTE_DIFF_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TESTE_DIFF_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TESTE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TESTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 9181 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TEST_ATIVIDADE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TEST_ATIVIDADE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 797781 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TEST_CARGA_IMPORT_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TEST_CARGA_IMPORT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TEST_CARGA_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TEST_CARGA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TEST_HISTORY_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TEST_HISTORY_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 15647261 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TEST_LOTE_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TEST_LOTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 176361 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: TIPO_ARMAZENAGEM_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."TIPO_ARMAZENAGEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 181 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--SEQUENCE: USUARIO_SEQ--------------------------------------------------------
CREATE SEQUENCE  "WMS"."USUARIO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 81 CACHE 20 NOORDER  NOCYCLE  NOPARTITION ;
--------------------------------------------------------------------------------
--VIEW: ENDERECO_APANHA--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."ENDERECO_APANHA" ("ID", "TIPO_ID", "ESPECIE_ID", "RUA", "PREDIO", "APARTAMENTO", "SALA", "PULMAO", "TERREO", "PRODUTO_ID", "PRODUTO", "EMBALAGEM_ID", "EMBALAGEM", "QTD_EMB", "LS", "QTD_ATUAL", "EXPEDICAO", "STATUS") AS 
  select A.ID,  
      A.TIPO_ID,  
      A.ESPECIE_ID,  
      A.RUA,  
      A.PREDIO,  
      A.APARTAMENTO,  
      A.SALA,  
      A.PULMAO,  
      A.TERREO,  
      A.PRODUTO_ID,  
      B.NOME as PRODUTO,  
      A.EMBALAGEM_ID,  
      C.EMB as EMBALAGEM,  
      C.QTD_EMB,  
      C.LS,  
      A.QTD_ATUAL,  
      A.EXPEDICAO,  
      A.STATUS  
  from endereco a  
 inner join produto b  
    on a.produto_id = b.id  
 inner join produto_embalagem c  
    on a.embalagem_id = c.id  
 where a.pulmao = 0  
   and a.rua not in ('996','998','999','AV')  
---------------------------- 
;
--------------------------------------------------------------------------------
--VIEW: EXPEDICAO_INFO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."EXPEDICAO_INFO" ("CARGA_ID", "LOTE_ID", "LOTE", "ATIVIDADE_ID", "PRIORIDADE", "LS", "CARGA_STATUS", "LOTE_STATUS", "ATIVIDADE_STATUS", "PRODUTO_ID", "EMB", "QTD_EMB", "QTD_PEDIDO", "PESO", "VOLUME", "SEP_ID", "SEPARADOR", "SEP_QTD", "SEP_START", "SEP_END", "CONF_ID", "CONFERENTE", "CONF_QTD", "CONF_START", "CONF_END") AS 
  select A.ID   as CARGA_ID, 
       B.ID   as LOTE_ID, 
       B.LOTE as LOTE, 
       C.ID   as ATIVIDADE_ID, 
       C.PRIORIDADE, 
       C.LS, 
       A.STATUS as CARGA_STATUS, 
       B.STATUS as LOTE_STATUS, 
       C.STATUS as ATIVIDADE_STATUS, 
       C.PRODUTO_ID, 
       C.EMB, 
       C.QTD_EMB, 
       C.QTD_PEDIDO, 
       C.PESO, 
       C.VOLUME, 
       C.SEP_ID, 
       D.APELIDO as SEPARADOR, 
       C.SEP_QTD, 
       C.SEP_START, 
       C.SEP_END, 
       C.CONF_ID, 
       E.APELIDO as CONFERENTE, 
       C.CONF_QTD, 
       C.CONF_START, 
       C.CONF_END 
  from WMS.CARGA     A, 
       WMS.LOTE      B, 
       WMS.ATIVIDADE C, 
       WMS.PRODUTIVO D, 
       WMS.PRODUTIVO E 
 where A.ID = B.CARGA_ID 
   and A.ID = C.CARGA_ID 
   and B.LOTE = C.LOTE 
   and C.SEP_ID = D.ID 
   and C.CONF_ID = E.ID 
;
--------------------------------------------------------------------------------
--VIEW: HISTORY_V--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."HISTORY_V" ("ID", "TABLE_NAME", "COLUMN_NAME", "ACTION", "ACTION_DATE", "ACTION_BY", "TABLE_PRIMARY_KEY", "TABLE_ROW_VERSION", "CHANGE") AS 
  select id,  
       table_name,  
       column_name,  
       decode(action,'U','Update','D','Delete') action,  
       action_date,  
       action_by,  
       pk1 table_primary_key,  
       tab_row_version table_row_version,  
       decode(data_type,  
         'NUMBER',old_number||' > '||new_number,  
         'VARCHAR2',substr(old_vc,1,50)||' > '||substr(new_vc,1,50),  
         'DATE',to_char(old_date,'YYYYMMDD HH24:MI:SS')||' > '||to_char(new_date,'YYYYMMDD HH24:MI:SS'),  
         'TIMESTAMP',to_char(old_ts,'YYYYMMDD HH24:MI:SS')||' > '||to_char(new_ts,'YYYYMMDD HH24:MI:SS'),  
         'TIMESTAMP WITH TIMEZONE',to_char(old_tswtz,'YYYYMMDD HH24:MI:SS')||' > '||to_char(new_tswtz,'YYYYMMDD HH24:MI:SS'),  
         'TIMESTAMP WITH LOCAL TIMEZONE',to_char(old_tswltz,'YYYYMMDD HH24:MI:SS')||' > '||to_char(new_tswltz,'YYYYMMDD HH24:MI:SS'),  
         'BLOB','length '||sys.dbms_lob.getlength(old_blob)||' > '||' length '||sys.dbms_lob.getlength(new_blob),  
         'CLOB',sys.dbms_lob.substr(old_vc,50,1)||' > '||sys.dbms_lob.substr(new_vc,50,1)  
         ) change  
from history  
;
--------------------------------------------------------------------------------
--VIEW: HISTORY_V_CUSTOM--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."HISTORY_V_CUSTOM" ("ID", "TABLE_NAME", "COLUMN_NAME", "ACTION", "ACTION_DATE", "ACTION_BY", "PK1", "OLD_VALUE", "NEW_VALUE") AS 
  select id,  
       table_name,  
       column_name,  
       action, 
       action_date,  
       action_by,  
       pk1,  
       decode(data_type,  
         'NUMBER',to_char(old_number),  
         'VARCHAR2',substr(old_vc,1,50),  
         'DATE',to_char(old_date,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP',to_char(old_ts,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP WITH TIMEZONE',to_char(old_tswtz,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP WITH LOCAL TIMEZONE',to_char(old_tswltz,'HH24:MI:SS DD/MM/YYYY'),  
         'BLOB','length '||sys.dbms_lob.getlength(old_blob),  
         'CLOB',sys.dbms_lob.substr(old_vc,50,1) 
         ) old_value, 
       decode(data_type,  
         'NUMBER',to_char(new_number),  
         'VARCHAR2',substr(new_vc,1,50),  
         'DATE',to_char(new_date,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP',to_char(new_ts,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP WITH TIMEZONE',to_char(new_tswtz,'HH24:MI:SS DD/MM/YYYY'),  
         'TIMESTAMP WITH LOCAL TIMEZONE',to_char(new_tswltz,'HH24:MI:SS DD/MM/YYYY'),  
         'BLOB','length '||sys.dbms_lob.getlength(new_blob),  
         'CLOB',sys.dbms_lob.substr(new_vc,50,1)  
         ) new_value 
from wms.history 
;
--------------------------------------------------------------------------------
--VIEW: PRODUTO_EMBALAGEM_AV--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."PRODUTO_EMBALAGEM_AV" ("LS", "PRODUTO_ID", "EMB", "QTD_EMB", "PESO_BRUTO", "PESO_LIQUIDO", "ALTURA", "LARGURA", "PROFUNDIDADE", "ATACADOVAREJO") AS 
  select A.LS, 
       A.PRODUTO_ID, 
       A.EMB, 
       A.QTD_EMB, 
       A.PESO_BRUTO, 
       A.PESO_LIQUIDO, 
       A.ALTURA, 
       A.LARGURA, 
       A.PROFUNDIDADE, 
       B.ATACADOVAREJO 
  from WMS.PRODUTO_EMBALAGEM A, 
       WMS.LINHADESEPARACAO B 
 where A.LS = B.LS 
;
--------------------------------------------------------------------------------
--VIEW: VW_ATIVIDADE_CONF--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."VW_ATIVIDADE_CONF" ("CARGA", "SEQLOTE", "CODPROD", "PROD", "PRODFULL", "EMBCODE", "EMB", "LOCAL", "BOX", "CODRUA", "NROPREDIO", "QTDEMBALAGEM", "EMBALAGEM", "QTD_PEDIDO", "SEP_QTD", "CONF_QTD", "PESSOA_ID", "ATIVIDADE_ID") AS 
  SELECT A.CARGA_ID CARGA, 
         A.LOTE SEQLOTE, 
         A.PRODUTO_ID CODPROD, 
         REPLACE(RPAD(SUBSTR(B.DESCCOMPLETA, 1, 25), 25, CHR(32)),'''','') PROD, 
         replace(B.DESCCOMPLETA,'''','') PRODFULL, 
         (SELECT MAX(TO_NUMBER(REGEXP_REPLACE(D.CODACESSO, '[^0-9]+', ''))) 
            FROM CONSINCO.MAP_PRODCODIGO D 
           WHERE D.SEQPRODUTO = A.PRODUTO_ID 
             AND D.QTDEMBALAGEM = G.QTDEMBALAGEM) EMBCODE, 
         G.EMBALAGEM || '-' || G.QTDEMBALAGEM EMB, 
         E.CODRUA || '.' || E.NROPREDIO || '.' || E.NROAPARTAMENTO || '.' || 
         E.NROSALA LOCAL, 
         F.NROBOX BOX, 
         E.CODRUA AS CODRUA, 
         E.NROPREDIO AS NROPREDIO, 
         G.QTDEMBALAGEM, 
         G.EMBALAGEM, 
         A.QTD_PEDIDO, 
         A.SEP_QTD, 
         A.CONF_QTD, 
         A.PESSOA_ID, 
         A.ID AS ATIVIDADE_ID 
    FROM WMS.ATIVIDADE             A, 
         CONSINCO.MAP_PRODUTO      B, 
         CONSINCO.MAP_FAMEMBALAGEM G, 
         WMS.V_ENDERECO_EMB        E, 
         CONSINCO.MLO_CARGAEXPED   F 
   WHERE B.SEQFAMILIA   = G.SEQFAMILIA 
     AND B.SEQPRODUTO   = A.PRODUTO_ID 
     --AND A.EMB          = G.EMBALAGEM 
     AND A.PRODUTO_ID   = B.SEQPRODUTO 
     AND F.NROCARGA     = A.CARGA_ID 
     AND E.SEQPRODUTO = A.PRODUTO_ID 
     AND E.QTDEMBALAGEM = A.QTD_EMB 
     AND A.QTD_EMB = G.QTDEMBALAGEM 
   ORDER BY E.CODRUA, E.NROPREDIO DESC 
;
--------------------------------------------------------------------------------
--VIEW: VW_ZPL_PRINT--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."VW_ZPL_PRINT" ("LINHA", "CONTROLEETQ", "SEQLOTE", "NROEMPRESA", "SEQPESSOA", "CIDADE", "UF", "NROPALETE", "NOMEROTA", "SEQUENCIACLIENTE", "TIPEMBALADO", "SEQPALETE", "NROBOX", "NROETQLOTESEPAR", "NROSEQLOTE", "QTDETIQUETA", "PRODUTIVO", "NROQUEBRA", "NROCARGA", "CODDEPOSSEPAR", "CODLINHASEPAR", "DESCLINHASEPAR", "DESTINO", "DTAHORGERACAO", "TARJA", "ETIQUETA", "ORDERBY_1", "LINHASEPAR") AS 
  Select A.LOTE AS LINHA, 
       A.LOTE AS CONTROLEETQ, 
       A.LOTE AS SEQLOTE, 
       1 AS NROEMPRESA, 
       case when A.PESSOA_ID = 0 then 'BLOCADO' else C.SEQPESSOA||'-'||C.NOMERAZAO end AS SEQPESSOA, 
       NULL AS CIDADE, 
       NULL AS UF, 
       0 AS NROPALETE, 
       '.' as NOMEROTA, 
       NULL AS SEQUENCIACLIENTE, 
       NULL TIPEMBALADO, 
       0 AS SEQPALETE, 
       D.BOX_ID AS NROBOX, 
       A.ID AS NROETQLOTESEPAR, 
       0 AS NROSEQLOTE, 
       0 AS QTDETIQUETA, 
       NULL AS PRODUTIVO, 
       0 AS NROQUEBRA, 
       A.CARGA_ID AS NROCARGA, 
       '01' AS CODDEPOSSEPAR, 
       A.LS_ID AS CODLINHASEPAR, 
       B.NOME AS DESCLINHASEPAR, 
       D.DESTINO, 
       D.CREATED AS DTAHORGERACAO, 
       '' AS TARJA, 
       A.LOTE AS ETIQUETA, 
       B.NOME AS ORDERBY_1, 
       B.NOME AS LINHASEPAR 
  From WMS.LOTE A 
  INNER JOIN WMS.LINHADESEPARACAO B ON A.LS = B.LS  
  LEFT JOIN consinco.GE_PESSOA C ON A.PESSOA_ID =  C.SEQPESSOA  
  INNER JOIN WMS.CARGA_IMPORT D ON  A.CARGA_ID = D.ID 
;
--------------------------------------------------------------------------------
--VIEW: VW_ZPL_PRINT_REC--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."VW_ZPL_PRINT_REC" ("ENDERECO", "ESP", "DESCRICAO1", "DESCCOMPLETA1", "DESCCOMPLETA2", "REFFABRICANTE", "NORMA", "EAN", "DUN", "SEQPALETERF", "NROCARGA", "TARJA", "DTA") AS 
  SELECT B.RUA || '.' || B.PREDIO || '.' || B.APARTAMENTO || '.' || B.SALA AS ENDERECO,
       E.NOME AS ESP,
       A.ID || '-' || A.DESTINO AS DESCRICAO1,
       SUBSTR(C.ID || '-' || C.NOME, 1, 39) AS DESCCOMPLETA1,
       SUBSTR(C.ID || '-' || C.NOME, 40, 80) AS DESCCOMPLETA2,
       C.REFFABRICANTE AS REFFABRICANTE,
       F.LASTRO || 'X' || F.ALTURA || ' ' || G.EMB || '-' || G.QTD_EMB AS NORMA,
       H.CODIGO AS EAN,
       I.CODIGO AS DUN,
       J.SEQPALETERF AS SEQPALETERF,
       A.ID AS NROCARGA,
       '' AS TARJA,
       '' AS DTA
  FROM WMS.ENDERECO B
 INNER JOIN WMS.PRODUTO C
    ON C.ID = B.PRODUTO_ID
 INNER JOIN WMS.PALETE D
    ON D.ENDERECO_ID = B.ID
 INNER JOIN WMS.ENDERECO_ESPECIE E
    ON E.ID = B.ESPECIE_ID
 INNER JOIN WMS.CARGA_IMPORT A
    ON A.ID = D.CARGA_ID
 INNER JOIN WMS.PRODUTO_ESPECIE F
    ON F.PRODUTO_ID = C.ID
   AND F.ESPECIE_ID = E.ID
 INNER JOIN WMS.PRODUTO_EMBALAGEM G
    ON G.PRODUTO_ID = C.ID
   AND G.ID = D.EMBALAGEM_ID
  LEFT JOIN WMS.EMBALAGEM_CODIGO H
    ON H.EMBALAGEM_ID = G.ID
   AND H.TIPO = 'E'
  LEFT JOIN WMS.EMBALAGEM_CODIGO I
    ON I.EMBALAGEM_ID = G.ID
   AND I.TIPO = 'D'
 inner join consinco.mlo_endereco j
    on j.seqendereco = b.id
order by rua, predio, apartamento, sala
;
--------------------------------------------------------------------------------
--VIEW: VW_ZPL_PRINT_REC_BKP--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."VW_ZPL_PRINT_REC_BKP" ("ENDERECO", "ESP", "DESCRICAO1", "DESCCOMPLETA1", "DESCCOMPLETA2", "REFFABRICANTE", "NORMA", "EAN", "DUN", "SEQPALETERF", "NROCARGA", "TARJA", "DTA") AS 
  SELECT B.RUA || '.' || B.PREDIO || '.' || B.APARTAMENTO || '.' || B.SALA AS ENDERECO,
       E.NOME AS ESP,
       A.ID || '-' || A.DESTINO AS DESCRICAO1,
       SUBSTR(C.ID || '-' || C.NOME, 1, 39) AS DESCCOMPLETA1,
       SUBSTR(C.ID || '-' || C.NOME, 40, 80) AS DESCCOMPLETA2,
       C.REFFABRICANTE AS REFFABRICANTE,
       F.LASTRO || 'X' || F.ALTURA || ' ' || G.EMB || '-' || G.QTD_EMB AS NORMA,
       H.CODIGO AS EAN,
       I.CODIGO AS DUN,
       D.ID AS SEQPALETERF,
       A.ID AS NROCARGA,
       '' AS TARJA,
       '' AS DTA
  FROM WMS.ENDERECO B
 INNER JOIN WMS.PRODUTO C
    ON C.ID = B.PRODUTO_ID
 INNER JOIN WMS.PALETE D
    ON D.ENDERECO_ID = B.ID
 INNER JOIN WMS.ENDERECO_ESPECIE E
    ON E.ID = B.ESPECIE_ID
 INNER JOIN WMS.CARGA_IMPORT A
    ON A.ID = D.CARGA_ID
 INNER JOIN WMS.PRODUTO_ESPECIE F
    ON F.PRODUTO_ID = C.ID
   AND F.ESPECIE_ID = E.ID
 INNER JOIN WMS.PRODUTO_EMBALAGEM G
    ON G.PRODUTO_ID = C.ID
   AND G.ID = D.EMBALAGEM_ID
  LEFT JOIN WMS.EMBALAGEM_CODIGO H
    ON H.EMBALAGEM_ID = G.ID
   AND H.TIPO = 'E'
  LEFT JOIN WMS.EMBALAGEM_CODIGO I
    ON I.EMBALAGEM_ID = G.ID
   AND I.TIPO = 'D'
;
--------------------------------------------------------------------------------
--VIEW: V_ATIVIDADE_CONF--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ATIVIDADE_CONF" ("CARGA", "SEQLOTE", "CODPROD", "PROD", "PRODFULL", "EMBCODE", "EMB", "LOCAL", "BOX", "CODRUA", "NROPREDIO", "QTDEMBALAGEM", "QTD_PEDIDO", "SEP_QTD", "CONF_QTD") AS 
  SELECT A.CARGA_ID CARGA, 
       A.LOTE SEQLOTE, 
       A.PRODUTO_ID CODPROD, 
       RPAD(SUBSTR(B.DESCCOMPLETA, 1, 25), 25, CHR(32)) PROD, 
       B.DESCCOMPLETA PRODFULL, 
       (SELECT MAX(TO_NUMBER(REGEXP_REPLACE(D.CODACESSO, '[^0-9]+', ''))) 
          FROM CONSINCO.MAP_PRODCODIGO D 
         WHERE D.SEQPRODUTO = A.PRODUTO_ID 
           AND D.QTDEMBALAGEM = G.QTDEMBALAGEM) EMBCODE, 
       G.EMBALAGEM || '-' || G.QTDEMBALAGEM EMB, 
       E.CODRUA || '.' || E.NROPREDIO || '.' || E.NROAPARTAMENTO || '.' || 
       E.NROSALA LOCAL, 
       F.NROBOX BOX, 
       E.CODRUA AS CODRUA, 
       E.NROPREDIO AS NROPREDIO, 
       G.QTDEMBALAGEM, 
       A.QTD_PEDIDO, 
       A.SEP_QTD, 
       A.CONF_QTD 
FROM WMS.ATIVIDADE             A, 
       CONSINCO.MAP_PRODUTO      B, 
       CONSINCO.MAP_FAMEMBALAGEM G, 
       WMS.V_ENDERECO_EMB     E, 
       CONSINCO.MLO_CARGAEXPED   F 
 WHERE B.SEQFAMILIA   = G.SEQFAMILIA 
   AND B.SEQPRODUTO   = A.PRODUTO_ID 
   --AND A.EMB          = G.EMBALAGEM 
   AND A.PRODUTO_ID   = B.SEQPRODUTO 
   AND F.NROCARGA     = A.CARGA_ID 
   AND E.SEQPRODUTO = A.PRODUTO_ID 
   AND E.QTDEMBALAGEM = A.QTD_EMB 
   AND A.QTD_EMB = G.QTDEMBALAGEM 
 ORDER BY E.CODRUA, E.NROPREDIO DESC 
;
--------------------------------------------------------------------------------
--VIEW: V_ATIVIDADE_INFO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ATIVIDADE_INFO" ("CARGA", "SEQLOTE", "CODPROD", "PROD", "PRODFULL", "EMBCODE", "EMB", "LOCAL", "BOX", "CODRUA", "NROPREDIO", "QTDEMBALAGEM", "QTDPED", "QTDSEP", "CONF_QTD", "DESTINO", "QTD_EMB") AS 
  SELECT A.CARGA_ID CARGA, 
       A.LOTE SEQLOTE, 
       A.PRODUTO_ID CODPROD, 
       RPAD(SUBSTR(B.DESCCOMPLETA, 1, 25), 25, CHR(32)) PROD, 
       B.DESCCOMPLETA PRODFULL, 
       (SELECT MIN(TO_NUMBER(REGEXP_REPLACE(D.CODACESSO, '[^0-9]+', ''))) 
          FROM CONSINCO.MAP_PRODCODIGO D 
         WHERE D.SEQPRODUTO = A.PRODUTO_ID 
           AND D.QTDEMBALAGEM = a.qtd_emb 
           AND D.INDUTILWMS = 'S' 
           AND D.TIPCODIGO IN ('E', 'D') ) EMBCODE, 
       G.EMBALAGEM || '-' || G.QTDEMBALAGEM EMB, 
       E.CODRUA || '.' || E.NROPREDIO || '.' || E.NROAPARTAMENTO || '.' || 
       E.NROSALA LOCAL, 
       F.NROBOX BOX, 
       E.CODRUA AS CODRUA, 
       E.NROPREDIO AS NROPREDIO, 
       G.QTDEMBALAGEM, 
       A.QTD_PEDIDO as QTDPED, 
       A.SEP_QTD as QTDSEP, 
       A.CONF_QTD, 
       F.DESTINO, 
       A.QTD_EMB 
FROM WMS.ATIVIDADE             A, 
       CONSINCO.MAP_PRODUTO      B, 
       CONSINCO.MAP_FAMEMBALAGEM G, 
       WMS.V_ENDERECO_EMB     E, 
       CONSINCO.MLO_CARGAEXPED   F 
 WHERE B.SEQFAMILIA   = G.SEQFAMILIA 
   AND B.SEQPRODUTO   = A.PRODUTO_ID 
   --AND A.EMB          = G.EMBALAGEM 
   AND A.PRODUTO_ID   = B.SEQPRODUTO 
   AND F.NROCARGA     = A.CARGA_ID 
   AND E.SEQPRODUTO = A.PRODUTO_ID 
   AND E.QTDEMBALAGEM = A.QTD_EMB 
   AND A.QTD_EMB = G.QTDEMBALAGEM 
 ORDER BY E.CODRUA, 
          (CASE 
            WHEN E.CODRUA IN (SELECT A.CODRUA 
                                FROM CONSINCO.MLO_RUA A 
                               WHERE A.INDNUMASCDESC = 'D' 
                                 AND A.NROEMPRESA = 1) THEN 
             E.NROPREDIO 
          END) DESC, 
          (CASE 
            WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                    FROM CONSINCO.MLO_RUA A 
                                   WHERE A.INDNUMASCDESC = 'D' 
                                     AND A.NROEMPRESA = 1) THEN 
             E.NROPREDIO 
          END) ASC, 
 
          (CASE 
            WHEN E.CODRUA IN (SELECT A.CODRUA 
                                FROM CONSINCO.MLO_RUA A 
                               WHERE A.INDNUMASCDESC = 'D' 
                                 AND A.NROEMPRESA = 1) THEN 
             E.NROAPARTAMENTO 
          END) DESC, 
          (CASE 
            WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                    FROM CONSINCO.MLO_RUA A 
                                   WHERE A.INDNUMASCDESC = 'D' 
                                     AND A.NROEMPRESA = 1) THEN 
             E.NROAPARTAMENTO 
          END) ASC, 
 
          (CASE 
            WHEN E.CODRUA IN (SELECT A.CODRUA 
                                FROM CONSINCO.MLO_RUA A 
                               WHERE A.INDNUMASCDESC = 'D' 
                                 AND A.NROEMPRESA = 1) THEN 
             E.NROSALA 
          END) DESC, 
          (CASE 
            WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                    FROM CONSINCO.MLO_RUA A 
                                   WHERE A.INDNUMASCDESC = 'D' 
                                     AND A.NROEMPRESA = 1) THEN 
             E.NROSALA 
          END) ASC 
;
--------------------------------------------------------------------------------
--VIEW: V_ATIVIDADE_MOV--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ATIVIDADE_MOV" ("LOCAL", "ID", "NOME", "EMB", "ENDERECO_ID") AS 
  select A.RUA || '.' || A.PREDIO || '.' || A.APARTAMENTO || '.' || A.SALA as local,
       null as ID,
       D.NOME,
       C.EMB || '-' || C.QTD_EMB as emb,
       a.id as endereco_id
  from ENDERECO A
 inner join PRODUTO_EMBALAGEM C
    on C.ID = A.EMBALAGEM_ID
 inner join PRODUTO D
    on D.ID = A.PRODUTO_ID
    and D.ID = C.PRODUTO_ID
 group by A.RUA || '.' || A.PREDIO || '.' || A.APARTAMENTO || '.' || A.SALA,
          D.NOME,
          C.EMB || '-' || C.QTD_EMB,
          a.id
;
--------------------------------------------------------------------------------
--VIEW: V_ATIVIDADE_SEP--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ATIVIDADE_SEP" ("CARGA", "SEQLOTE", "CODPROD", "PROD", "PRODFULL", "EMBCODE", "EMB", "LOCAL", "BOX", "CODRUA", "NROPREDIO", "QTDEMBALAGEM", "EMBALAGEM", "QTDPED", "QTDSEP", "CONF_QTD", "DESTINO", "QTD_EMB") AS 
  SELECT A.CARGA_ID CARGA, 
         A.LOTE SEQLOTE, 
         A.PRODUTO_ID CODPROD, 
         B.DESCCOMPLETA PROD, 
         B.DESCCOMPLETA PRODFULL, 
         nvl((SELECT MIN(TO_NUMBER(REGEXP_REPLACE(D.CODACESSO, '[^0-9]+', ''))) 
            FROM CONSINCO.MAP_PRODCODIGO D 
           WHERE D.SEQPRODUTO = A.PRODUTO_ID 
             AND D.QTDEMBALAGEM = a.qtd_emb 
             AND D.INDUTILWMS = 'S' 
             AND D.TIPCODIGO IN ('E', 'D') ),000000 )EMBCODE, 
         G.EMBALAGEM || '-' || G.QTDEMBALAGEM EMB, 
         E.CODRUA || '.' || E.NROPREDIO || '.' || E.NROAPARTAMENTO || '.' || 
         E.NROSALA LOCAL, 
         F.BOX_ID BOX, 
         E.CODRUA AS CODRUA, 
         E.NROPREDIO AS NROPREDIO, 
         G.QTDEMBALAGEM, 
         G.EMBALAGEM, 
         A.QTD_PEDIDO as QTDPED, 
         A.SEP_QTD as QTDSEP, 
         A.CONF_QTD, 
         F.DESTINO, 
         A.QTD_EMB 
    FROM WMS.ATIVIDADE             A, 
         CONSINCO.MAP_PRODUTO      B, 
         CONSINCO.MAP_FAMEMBALAGEM G, 
         WMS.V_ENDERECO_EMB        E, 
         WMS.CARGA_IMPORT          F 
   WHERE B.SEQFAMILIA   = G.SEQFAMILIA 
     AND B.SEQPRODUTO   = A.PRODUTO_ID 
     AND A.PRODUTO_ID   = B.SEQPRODUTO 
     AND F.ID           = A.CARGA_ID 
     AND E.SEQPRODUTO = A.PRODUTO_ID 
     AND E.QTDEMBALAGEM = A.QTD_EMB 
     AND A.QTD_EMB = G.QTDEMBALAGEM 
   ORDER BY E.CODRUA, 
            (CASE 
              WHEN E.CODRUA IN (SELECT A.CODRUA 
                                  FROM CONSINCO.MLO_RUA A 
                                 WHERE A.INDNUMASCDESC = 'D' 
                                   AND A.NROEMPRESA = 1) THEN 
               E.NROPREDIO 
            END) DESC, 
            (CASE 
              WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                      FROM CONSINCO.MLO_RUA A 
                                     WHERE A.INDNUMASCDESC = 'D' 
                                       AND A.NROEMPRESA = 1) THEN 
               E.NROPREDIO 
            END) ASC, 
 
            (CASE 
              WHEN E.CODRUA IN (SELECT A.CODRUA 
                                  FROM CONSINCO.MLO_RUA A 
                                 WHERE A.INDNUMASCDESC = 'D' 
                                   AND A.NROEMPRESA = 1) THEN 
               E.NROAPARTAMENTO 
            END) DESC, 
            (CASE 
              WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                      FROM CONSINCO.MLO_RUA A 
                                     WHERE A.INDNUMASCDESC = 'D' 
                                       AND A.NROEMPRESA = 1) THEN 
               E.NROAPARTAMENTO 
            END) ASC, 
 
            (CASE 
              WHEN E.CODRUA IN (SELECT A.CODRUA 
                                  FROM CONSINCO.MLO_RUA A 
                                 WHERE A.INDNUMASCDESC = 'D' 
                                   AND A.NROEMPRESA = 1) THEN 
               E.NROSALA 
            END) DESC, 
            (CASE 
              WHEN E.CODRUA NOT IN (SELECT A.CODRUA 
                                      FROM CONSINCO.MLO_RUA A 
                                     WHERE A.INDNUMASCDESC = 'D' 
                                       AND A.NROEMPRESA = 1) THEN 
               E.NROSALA 
            END) ASC 
;
--------------------------------------------------------------------------------
--VIEW: V_CAMARA_FRIA--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_CAMARA_FRIA" ("STATUS", "CARGA_ID", "LOTE", "CODRUA", "NROPREDIO", "NROAPARTAMENTO", "NROSALA", "SEP_ID", "PRODUTO_ID", "QTD_SEPARAR", "QTD_EMB", "QTD_SEPARADA", "PESSOA_ID") AS 
  SELECT A.STATUS,
       A.CARGA_ID,
       A.LOTE,
       B.CODRUA,
       B.NROPREDIO,
       B.NROAPARTAMENTO,
       B.NROSALA,
       A.SEP_ID,
       A.PRODUTO_ID,
       (A.QTD_PEDIDO/A.QTD_EMB) as QTD_SEPARAR,
       (A.QTD_EMB) as QTD_EMB,
       nvl((A.SEP_QTD/A.QTD_EMB),0) as QTD_SEPARADA,
       A.PESSOA_ID
  FROM WMS.ATIVIDADE      A,
       WMS.V_ENDERECO_EMB B
 WHERE A.PRODUTO_ID = B.SEQPRODUTO
   AND B.CODRUA in ('CF')
 ORDER BY 3, 4, 5, 6, 7, 8, 9
;
--------------------------------------------------------------------------------
--VIEW: V_CARGAS_SEM_LS--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_CARGAS_SEM_LS" ("NROCARGA", "DESCRICAO", "VALOR") AS 
  select a.nrocarga,
       a.descricao,
       wms.f_get_valor_carga(a.nrocarga) as valor
  from consinco.mrl_cargaexped a
  left join wms.carga_import b
    on b.id = a.nrocarga
 where b.id is null
   and tipentrega = 'E'
   and statuscarga in ('G','S')
   and nroempresa = 1
   and trunc(dtahorgeracao) = trunc(sysdate)
 order by 1 desc
;
--------------------------------------------------------------------------------
--VIEW: V_CARGA_CLIENTE_INFO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_CARGA_CLIENTE_INFO" ("CLIENTE_ID", "FANTASIA", "VALOR", "CARGA_ID") AS 
  select a.seqpessoa as cliente_id,
       c.fantasia,
       sum(b.vlrembinformado/b.qtdembalagem*b.qtdatendida) as valor,
       a.nrocarga as carga_id
  from consinco.mad_pedvenda a
 inner join consinco.mad_pedvendaitem b
    on b.nropedvenda = a.nropedvenda
 inner join consinco.ge_pessoa c
    on c.seqpessoa = a.seqpessoa
 group by a.seqpessoa, c.fantasia, a.nrocarga
;
--------------------------------------------------------------------------------
--VIEW: V_CARGA_CLIENTE_PEDIDO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_CARGA_CLIENTE_PEDIDO" ("PRODUTO_ID", "PRODUTO", "VALOR", "QTD", "QTDEMB", "CARGA_ID", "CLIENTE_ID") AS 
  select d.seqproduto as produto_id,
       d.desccompleta as produto,
       b.vlrembinformado as valor,
       b.qtdatendida as qtd,
       b.qtdembalagem as qtdemb,
       a.nrocarga as carga_id,
       a.seqpessoa as cliente_id
  from consinco.mad_pedvenda a
 inner join consinco.mad_pedvendaitem b
    on b.nropedvenda = a.nropedvenda
 inner join consinco.map_produto d
    on d.seqproduto = b.seqproduto
;
--------------------------------------------------------------------------------
--VIEW: V_EMBALAGEM_CODIGO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_EMBALAGEM_CODIGO" ("EMBALAGEM_ID", "CODIGO", "TIPO") AS 
  SELECT B.ID AS EMBALAGEM_ID, C.CODACESSO AS CODIGO, C.TIPCODIGO AS TIPO 
  FROM WMS.PRODUTO A 
 INNER JOIN WMS.PRODUTO_EMBALAGEM B 
    ON A.ID = B.PRODUTO_ID 
 INNER JOIN CONSINCO.MAP_PRODCODIGO C 
    ON A.ID = C.SEQPRODUTO 
   AND B.PRODUTO_ID = C.SEQPRODUTO 
;
--------------------------------------------------------------------------------
--VIEW: V_ENDERECO_EMB--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ENDERECO_EMB" ("SEQPRODUTO", "QTDEMBALAGEM", "EMBALAGEM", "NROAPARTAMENTO", "NROSALA", "CODRUA", "NROPREDIO") AS 
  SELECT A.SEQPRODUTO, 
       A.QTDEMBALAGEM, 
       A.EMBALAGEM, 
       MIN(B1.NROAPARTAMENTO) AS NROAPARTAMENTO, 
       MIN(B1.NROSALA) AS NROSALA, 
       MIN(B1.CODRUA) AS CODRUA, 
       MIN(B1.NROPREDIO) AS NROPREDIO 
  FROM CONSINCO.MLO_PRODEMBWM A1 
  , CONSINCO.MLO_ENDERECO B1 
  , CONSINCO.MLO_LINHASEPARPERM C1 
  , consinco.MLO_PRODEMBALAGEM A 
  , WMS.LINHADESEPARACAO C 
 WHERE  A1.SEQPRODUTO = B1.SEQPRODUTO 
   AND B1.SEQENDERECO = C1.SEQENDERECO 
   AND C1.CODLINHASEPAR = A1.CODLINHASEPAR 
   AND B1.ESPECIEENDERECO IN ('M', 'V', 'A') 
   AND C1.CODDISTRIBLINHA in ('N') 
   AND A.SEQPRODUTO = A1.SEQPRODUTO 
   AND A.QTDEMBALAGEM = A1.QTDEMBALAGEM 
   AND A.NROEMPRESA = 1 
   AND B1.INDTERREOAEREO = 'T' 
   AND B1.STATUSENDERECO = 'O' 
   AND B1.CODRUA NOT IN ( 'AV','990','995','996','997','998','999') 
   and C.LS = A1.CODLINHASEPAR 
   and A.STATUSEMBALAGEM = 'A' 
   GROUP BY A.SEQPRODUTO, 
       A.QTDEMBALAGEM, 
       A.EMBALAGEM 
;
--------------------------------------------------------------------------------
--VIEW: V_ENDERECO_EMB_BKP--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ENDERECO_EMB_BKP" ("SEQPRODUTO", "QTDEMBALAGEM", "EMBALAGEM", "NROAPARTAMENTO", "NROSALA", "CODRUA", "NROPREDIO") AS 
  SELECT A.PRODUTO_ID as SEQPRODUTO,
       A.QTD_EMB as QTDEMBALAGEM,
       A.EMB as EMBALAGEM,
       MIN(B.APARTAMENTO) AS NROAPARTAMENTO,
       MIN(B.SALA) AS NROSALA,
       MIN(B.RUA) AS CODRUA,
       MIN(B.PREDIO) AS NROPREDIO
  FROM WMS.PRODUTO_EMBALAGEM A
     , WMS.ENDERECO B
     , WMS.LINHADESEPARACAO C
     , WMS.PRODUTO D
 WHERE A.PRODUTO_ID = D.ID
   and A.ID = B.EMBALAGEM_ID
   and C.LS = A.LS
   and B.TERREO = 1
   and B.PULMAO = 0
   AND B.RUA NOT IN ( 'AV','990','995','996','997','998','999')
 group by A.PRODUTO_ID,
       A.QTD_EMB,
       A.EMB
;
--------------------------------------------------------------------------------
--VIEW: V_ESTACAO_SEP--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_ESTACAO_SEP" ("STATUS", "CARGA_ID", "LOTE", "CODRUA", "NROPREDIO", "NROAPARTAMENTO", "NROSALA", "SEP_ID", "PRODUTO_ID", "QTD_SEPARAR", "QTD_EMB", "QTD_SEPARADA", "PESSOA_ID") AS 
  SELECT A.STATUS, 
       A.CARGA_ID, 
       A.LOTE, 
       B.CODRUA, 
       B.NROPREDIO, 
       B.NROAPARTAMENTO, 
       B.NROSALA, 
       A.SEP_ID, 
       A.PRODUTO_ID, 
       (A.QTD_PEDIDO/A.QTD_EMB) as QTD_SEPARAR, 
       (A.QTD_EMB) as QTD_EMB, 
       nvl((A.SEP_QTD/A.QTD_EMB),0) as QTD_SEPARADA, 
       A.PESSOA_ID 
  FROM WMS.ATIVIDADE                A, 
       WMS.V_ENDERECO_EMB        B 
 WHERE A.PRODUTO_ID = B.SEQPRODUTO 
   AND B.CODRUA in ('B','C','D','N','O','P','CF','G') 
   AND A.QTD_EMB = B.QTDEMBALAGEM 
 ORDER BY 3, 4, 5, 6, 7, 8, 9 
;
--------------------------------------------------------------------------------
--VIEW: V_MENU_ACESSO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_MENU_ACESSO" ("LABEL_VALUE", "TARGET_VALUE", "IS_CURRENT", "IMAGE_VALUE", "IMAGE_ATTR_VALUE", "IMAGE_ALT_VALUE", "LIST_ENTRY_ID", "LIST_ENTRY_PARENT_ID", "PARENT_SEQUENCE", "DISPLAY_SEQUENCE") AS 
  select ENTRY_TEXT as label_value   
      , ENTRY_TARGET as target_value  
      , null is_current   
      , ENTRY_IMAGE as image_value   
      , null as image_attr_value   
      , null as image_alt_value   
      , A.LIST_ENTRY_ID  
      , A.LIST_ENTRY_PARENT_ID  
      , case  
          when LIST_ENTRY_PARENT_ID is null then  
            A.DISPLAY_SEQUENCE  
          else  
            (select A1.DISPLAY_SEQUENCE  
               from apex_application_list_entries A1  
              where A1.LIST_ENTRY_ID = A.LIST_ENTRY_PARENT_ID)  
        end as PARENT_SEQUENCE,  
        A.DISPLAY_SEQUENCE  
from apex_application_list_entries A  
inner join GRUPO_PERMISSAO B  
  on A.LIST_ENTRY_ID = B.LIST_ENTRY_ID  
inner join USUARIO C  
  on upper(C.LOGIN) = upper(v('APP_USER'))  
  and C.GRUPO_ID = B.GRUPO_ACESSO_ID  
where application_id = 101  
  and LIST_ID = 19812088044429116  
order by DISPLAY_SEQUENCE  
----------------------------  
;
--------------------------------------------------------------------------------
--VIEW: V_MH_ATIVIDADES_EXPEDICAO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_MH_ATIVIDADES_EXPEDICAO" ("ID", "TIPO", "ORIGEM_ID", "ORIGEM", "DESTINO_ID", "DESTINO", "PRIORIDADE") AS 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         C.rua as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   inner join endereco C 
      on A.destino_id = C.id 
   where A.tipo = 'R' 
     and A.status = 0 
  --Atividades de reposio da miudeza 
  union  
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         C.rua as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   inner join endereco C 
      on A.destino_id = C.id 
   where A.tipo = 'D' 
     and A.status = 2 
  --Atividades de reposio do apanha 
  union 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         'box' as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   where A.tipo = 'P' 
     and A.status = 2 
  --Atividades de pulmo box 
   order by 7, 6 
;
--------------------------------------------------------------------------------
--VIEW: V_MH_ATIVIDADES_RECEBIMENTO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_MH_ATIVIDADES_RECEBIMENTO" ("ID", "TIPO", "ORIGEM_ID", "ORIGEM", "DESTINO_ID", "DESTINO", "PRIORIDADE") AS 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         C.rua as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   inner join endereco C 
      on A.destino_id = C.id 
   where A.tipo = 'A' 
     and A.status = 0 
  --Atividades de subida de palete 
  union 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         'box' as origem, 
         A.destino_id, 
         B.rua as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.destino_id = B.id 
   where A.tipo = 'E' 
     and A.status = 0 
  --Atividades de recebimento de mercadoria 
   order by 7, 6 
;
--------------------------------------------------------------------------------
--VIEW: V_MV_ATIVIDADES_EXPEDICAO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_MV_ATIVIDADES_EXPEDICAO" ("ID", "TIPO", "ORIGEM_ID", "ORIGEM", "DESTINO_ID", "DESTINO", "PRIORIDADE") AS 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         C.rua as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   inner join endereco C 
      on A.destino_id = C.id 
   where A.tipo = 'D' 
     and A.status = 0 
  --Atividades de reposio do apanha 
  union 
  select A.id, 
         A.tipo, 
         A.origem_id, 
         B.rua as origem, 
         A.destino_id, 
         'box' as destino, 
         A.prioridade 
    from wms.movimentacao A 
   inner join endereco B 
      on A.origem_id = B.id 
   where A.tipo = 'P' 
     and A.status = 0 
  --Atividades de pulmo box 
   order by 7, 6 
;
--------------------------------------------------------------------------------
--VIEW: V_PRODUTO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_PRODUTO" ("ID", "NOME", "FORNECEDOR_ID", "REFFABRICANTE") AS 
  SELECT A.SEQPRODUTO   AS ID, 
       A.DESCCOMPLETA AS NOME, 
       WMS.F_FORNECEDOR_AGG(A.SEQPRODUTO) AS FORNECEDOR_ID, 
       A.REFFABRICANTE AS REFFABRICANTE 
  FROM CONSINCO.MLO_PRODUTO A 
 WHERE A.NROEMPRESA = 1 
;
--------------------------------------------------------------------------------
--VIEW: V_PRODUTO_EMBALAGEM--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_PRODUTO_EMBALAGEM" ("PRODUTO_ID", "EMB", "QTD_EMB", "PESO_BRUTO", "PESO_LIQUIDO", "ALTURA", "LARGURA", "PROFUNDIDADE") AS 
  SELECT A.SEQPRODUTO   AS PRODUTO_ID, 
       C.EMBALAGEM    AS EMB, 
       C.QTDEMBALAGEM AS QTD_EMB, 
       C.PESOBRUTO    AS PESO_BRUTO, 
       C.PESOLIQUIDO  AS PESO_LIQUIDO, 
       C.ALTURA       AS ALTURA, 
       C.LARGURA      AS LARGURA, 
       C.PROFUNDIDADE AS PROFUNDIDADE 
  FROM CONSINCO.MRL_PRODUTOEMPRESA A 
 INNER JOIN CONSINCO.MAP_PRODUTO B 
    ON B.SEQPRODUTO = A.SEQPRODUTO 
 INNER JOIN CONSINCO.MAP_FAMEMBALAGEM C 
    ON C.SEQFAMILIA = B.SEQFAMILIA 
 INNER JOIN CONSINCO.MAD_PARAMETRO D 
    ON D.NROEMPRESA = A.NROEMPRESA 
   AND D.INDINTMAXWM IN ('S', 'C') 
 INNER JOIN CONSINCO.MRL_FAMEMBEMPRESA E 
    ON E.SEQFAMILIA = C.SEQFAMILIA 
   AND E.QTDEMBALAGEM = C.QTDEMBALAGEM 
   AND E.NROEMPRESA = D.NROEMPRESA 
;
--------------------------------------------------------------------------------
--VIEW: V_PRODUTO_ESPECIE--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_PRODUTO_ESPECIE" ("ID", "ESPECIE_ID", "ESPECIE", "EMBALAGEM_ID", "EMB", "QTD_EMB", "LASTRO", "ALTURA", "ESTOQUE_MIN", "PRODUTO_ID") AS 
  select A.ID,  
       A.ESPECIE_ID,  
       B.NOME as ESPECIE,  
       A.EMBALAGEM_ID,  
       C.EMB,  
       C.QTD_EMB,  
       A.LASTRO,  
       A.ALTURA,  
       A.ESTOQUE_MIN,  
       A.PRODUTO_ID  
  from PRODUTO_ESPECIE A  
 inner join ENDERECO_ESPECIE B  
    on A.ESPECIE_ID = B.ID  
 inner join PRODUTO_EMBALAGEM C  
    on A.EMBALAGEM_ID = C.ID  
   and A.PRODUTO_ID = C.PRODUTO_ID  
 inner join PRODUTO D  
    on A.PRODUTO_ID = D.ID  
---------------------------- 
;
--------------------------------------------------------------------------------
--VIEW: V_PRODUTO_INFO--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_PRODUTO_INFO" ("PRODUTO_ID", "EMBALAGEM_ID", "PRODUTO_NOME", "PESO_BRUTO", "PESO_LIQUIDO", "ALTURA", "LARGURA", "PROFUNDIDADE", "VOLUME", "QTD_EMB", "EMB", "LS") AS 
  select distinct  
       A.ID as PRODUTO_ID,  
       B.ID as EMBALAGEM_ID,  
       A.NOME as PRODUTO_NOME,  
       B.PESO_BRUTO,  
       B.PESO_LIQUIDO,  
       B.ALTURA/100 as ALTURA,  
       B.LARGURA/100 as LARGURA,  
       B.PROFUNDIDADE/100 as PROFUNDIDADE,  
       B.ALTURA*B.LARGURA*B.PROFUNDIDADE/1000000 as VOLUME,  
       B.QTD_EMB,  
       B.EMB,  
       B.LS  
  from WMS.PRODUTO A  
 inner join WMS.PRODUTO_EMBALAGEM B  
    on A.ID = B.PRODUTO_ID  
 where B.LS not in ('PR')  
   and A.STATUS = 1  
---------------------------- 
;
--------------------------------------------------------------------------------
--VIEW: V_PULMAO_BOX--------------------------------------------------------
CREATE OR REPLACE FORCE EDITIONABLE VIEW "WMS"."V_PULMAO_BOX" ("SEQPRODUTO", "QTDMOVTO", "QTDEMBALAGEM", "EMBALAGEM", "QTD", "NROCARGA") AS 
  SELECT B.SEQPRODUTO, 
       sum(A.QTDMOVTO) QTDMOVTO, 
       B.QTDEMBALAGEM QTDEMBALAGEM, 
       B.EMBALAGEM EMBALAGEM, 
       sum(A.QTDMOVTO)/B.QTDEMBALAGEM QTD, 
       A.NROCARGA 
  from consinco.MLO_ENDERECOMOVTO A, 
       consinco.MLO_PRODEMBALAGEM B 
 where A.TIPMOVTO In ('R', 'M') 
   and A.INDENTRADASAIDA = 'S' 
   and A.NROEMPRESA = 1 
   and NVL(a.INDREPSEPPALINTEIRO, 'N') = 'S' 
   and A.SEQPRODUTO = B.SEQPRODUTO 
   and A.QTDEMBALAGEM = B.QTDEMBALAGEM 
   and A.NROEMPRESA = B.NROEMPRESA 
 group by B.SEQPRODUTO, 
          B.QTDEMBALAGEM, 
          B.EMBALAGEM, 
          A.NROCARGA 
 order by 1, 3 
;
--------------------------------------------------------------------------------
--FUNCTION: F_CARGA_SEM_LS--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_CARGA_SEM_LS" (code number, dtai date, dtaf date) 
   RETURN number 
IS 
qtd number; 
BEGIN 
SELECT count(*) into qtd 
FROM CONSINCO.MRL_CARGAEXPED C 
WHERE C.DTAHORGERACAO > SYSDATE - nvl(null,8) 
  AND C.STATUSCARGA <> 'F' 
  AND EXISTS (SELECT 1 FROM WMS.CARGA F WHERE F.ID = C.NROCARGA) 
  and C.NROCARGA not in (323679) 
  and C.NROCARGA in ( 
    select D.CARGA from APEX.TB_CDA_MOTORISTA_CARGA D 
    where D.PLC_CODIGO = code 
      and trunc(D.DTAINCLUSAO) between dtai and dtaf 
  ) 
  ; 
return qtd; 
 
END F_CARGA_SEM_LS; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_DELETE_ROW--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_DELETE_ROW" (  
    i_id in number,  
    i_ajax_callback in varchar2,  
    i_form_prefix in varchar2,  
    i_region_id in varchar2  
)  
return varchar2 is  
begin  
    return '<a class="cursor_pointer fa fa-trash-o" onclick="deleteRow('||  
           i_id||','''||i_ajax_callback||''','''||i_form_prefix||  
           ''','''||i_region_id||''')"></a>';  
end;  
/
--------------------------------------------------------------------------------
--FUNCTION: F_DESC_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_DESC_ENDERECO" (i_endereco_id IN number) 
return varchar2 as 
  v_result varchar2(100); 
begin 
  select RUA||'.'||PREDIO||'.'||APARTAMENTO||'.'||SALA 
    into v_result 
    from wms.endereco 
   where ID = i_endereco_id; 
   
  return v_result; 
  exception 
    when NO_DATA_FOUND then 
      return 'Endereo invlido'; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_ENDERCO_ABS--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_ENDERCO_ABS" (PNENDORG IN NUMBER, PNENDDES IN NUMBER, PNTIPO IN VARCHAR2, OPCAO NUMBER)
  RETURN VARCHAR2 IS
  ENDERCO_ORIGEM VARCHAR2(100);
  ENDERCO_DESTINO VARCHAR2(100);

BEGIN

  IF PNTIPO = 'P' THEN

select A.RUA || '.' || A.PREDIO || '.' || A.APARTAMENTO || '.' || A.SALA INTO ENDERCO_ORIGEM
  from WMS.ENDERECO A
 inner join WMS.PALETE B
    on B.ENDERECO_ID = A.ID
 inner join WMS.PRODUTO_EMBALAGEM C
    on C.ID = A.EMBALAGEM_ID
    inner join WMS.PRODUTO_EMBALAGEM C1
    on C1.ID = B.EMBALAGEM_ID
    inner join WMS.PRODUTO D
    on D.ID = A.PRODUTO_ID
    and D.ID = C.PRODUTO_ID
    and D.ID = C1.PRODUTO_ID
    WHERE A.ID =  PNENDORG;
        
    SELECT PNENDDES INTO ENDERCO_DESTINO FROM DUAL;
    IF OPCAO = 1 THEN
    RETURN ENDERCO_ORIGEM;
    END IF;
    IF OPCAO = 2 THEN
    RETURN ENDERCO_DESTINO;
    END IF;
  END IF;

   IF PNTIPO IN ( 'R','D' ) THEN

select A.RUA || '.' || A.PREDIO || '.' || A.APARTAMENTO || '.' || A.SALA INTO ENDERCO_ORIGEM
  from WMS.ENDERECO A
 inner join WMS.PALETE B
    on B.ENDERECO_ID = A.ID
 inner join WMS.PRODUTO_EMBALAGEM C
    on C.ID = A.EMBALAGEM_ID
    inner join WMS.PRODUTO_EMBALAGEM C1
    on C1.ID = B.EMBALAGEM_ID
    inner join WMS.PRODUTO D
    on D.ID = A.PRODUTO_ID
    and D.ID = C.PRODUTO_ID
    and D.ID = C1.PRODUTO_ID
    WHERE A.ID =  PNENDORG
;
select A.RUA || '.' || A.PREDIO || '.' || A.APARTAMENTO || '.' || A.SALA INTO ENDERCO_DESTINO
  from WMS.ENDERECO A
 inner join WMS.PALETE B
    on B.ENDERECO_ID = A.ID
 inner join WMS.PRODUTO_EMBALAGEM C
    on C.ID = A.EMBALAGEM_ID
    inner join WMS.PRODUTO_EMBALAGEM C1
    on C1.ID = B.EMBALAGEM_ID
    inner join WMS.PRODUTO D
    on D.ID = A.PRODUTO_ID
    and D.ID = C.PRODUTO_ID
    and D.ID = C1.PRODUTO_ID
    WHERE A.ID =  PNENDDES;

    IF OPCAO = 1 THEN
    RETURN ENDERCO_ORIGEM;
    END IF;
    IF OPCAO = 2 THEN
    RETURN ENDERCO_DESTINO;
    END IF;
  END IF;

END;
/
--------------------------------------------------------------------------------
--FUNCTION: F_FORNECEDOR_AGG--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_FORNECEDOR_AGG" (i_produto_id IN NUMBER)  
  RETURN NUMBER IS  
  v_seqfamilia    number;  
  v_fornecedor_id number;  
  v_seqfornecedor number;  
BEGIN  
  select seqfamilia  
    into v_seqfamilia  
    from consinco.map_produto  
   where seqproduto = i_produto_id;  
  SELECT C1.SEQFORNECEDOR  
    INTO v_seqfornecedor  
    FROM CONSINCO.MAP_FAMFORNEC C1  
   WHERE C1.PRINCIPAL = 'S'  
     AND C1.SEQFAMILIA = v_seqfamilia;  
  SELECT A1.CODIGO_AGRUPADO  
    INTO v_fornecedor_id  
    FROM APEX.TB_CDA_CONT_FORNECEDOR A1  
   INNER JOIN APEX.TB_CDA_CONT_FORNAGR B1  
      ON B1.CODIGO_AGRUPADO = A1.CODIGO_AGRUPADO  
     AND B1.AGRUPADO <> 'INATIVO'  
   WHERE A1.CODIGO_AGRUPADO NOT IN (25)  
     AND A1.SEQFORNECEDOR = v_seqfornecedor;  
  RETURN v_fornecedor_id;  
END;  
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_LOCAL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_LOCAL" (i_endereco_id in number)
return varchar2 as
  v_return varchar2(100);
begin
  select a.RUA ||'.'|| a.PREDIO||'.'||a.APARTAMENTO||'.'||a.SALA
    into v_return
    from wms.endereco a
   where a.id = i_endereco_id;
  return v_return;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_LOCAL_PTA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_LOCAL_PTA" (
  i_produto IN NUMBER
) return varchar2 is
v_local varchar2(100);
begin
  select RUA || '.' || PREDIO || '.' ||
         APARTAMENTO || '.' || SALA  
    into v_local
    from wms.ENDERECO A
   where A.ID = (
     select max(B.ID)
       from wms.ENDERECO B
      where B.RUA = '996'
        and B.QTD_ATUAL > 0
        and B.PRODUTO_ID = i_produto
   );
  
  return v_local;
  
  EXCEPTION
    when NO_DATA_FOUND
      then return '996';
    when OTHERS
      then return SQLERRM;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_PRODUTIVO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_PRODUTIVO" (i_produtivo_id in number)
return varchar2 as
  v_return varchar2(100);
begin
  select nome
    into v_return
    from wms.produtivo a
   where a.id = i_produtivo_id;
  return v_return;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_PRODUTO_END--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_PRODUTO_END" (i_endereco_id in number)
return varchar2 as
  v_return varchar2(100);
begin
  select b.emb || '-' || b.qtd_emb || ' / ' || c.nome
    into v_return
    from wms.endereco a
   inner join produto_embalagem b
      on a.embalagem_id = b.id
   inner join produto c
      on c.id = b.produto_id
   where a.id = i_endereco_id;
  return v_return;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_RUA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_RUA" (i_produto in number, i_qtd_emb in number, i_tipo in varchar2)
return varchar2 as
  v_return varchar2(100);
  v_exists number;
  v_rua varchar2(3);
  v_predio number;
  v_apto number;
  v_sala number;
begin
  select count(*)
    into v_exists
    from wms.V_ENDERECO_EMB a
   where a.SEQPRODUTO = i_produto
     and a.QTDEMBALAGEM = i_qtd_emb;

  if v_exists > 0 then
    select max(A.CODRUA)
      into v_rua
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb;
     
     select max(A.NROPREDIO)
      into v_predio
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua;
     
     select max(A.NROAPARTAMENTO)
      into v_apto
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio;
     
     select max(A.NROSALA)
      into v_sala
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio
       and a.NROAPARTAMENTO = v_apto;
  else
    select max(A.CODRUA)
      into v_rua
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto;
     
     select max(A.NROPREDIO)
      into v_predio
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua;
     
     select max(A.NROAPARTAMENTO)
      into v_apto
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio;
     
     select max(A.NROSALA)
      into v_sala
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio
       and a.NROAPARTAMENTO = v_apto;
  end if;
  if i_tipo = 'RUA' then
    return v_rua;
  elsif   i_tipo = 'PREDIO' then
    return v_predio;
  elsif i_tipo = 'APTO' then
    return v_apto;
  elsif i_tipo = 'SALA' then
    return v_sala;
  else
    return v_rua ||'.'||v_predio ||'.'||v_apto ||'.'||v_sala;
  end if;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_RUA_DEV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_RUA_DEV" (i_produto in number, i_qtd_emb in number, i_tipo in varchar2)
return varchar2 as
  v_return varchar2(100);
  v_exists number;
  v_rua varchar2(3);
  v_predio number;
  v_apto number;
  v_sala number;
begin
  select count(*)
    into v_exists
    from wms.V_ENDERECO_EMB a
   where a.SEQPRODUTO = i_produto
     and a.QTDEMBALAGEM = i_qtd_emb;

  if v_exists > 0 then
    select max(A.CODRUA)
      into v_rua
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb;
     
     select max(A.NROPREDIO)
      into v_predio
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua;
     
     select max(A.NROAPARTAMENTO)
      into v_apto
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio;
     
     select max(A.NROSALA)
      into v_sala
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.QTDEMBALAGEM = i_qtd_emb
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio
       and a.NROAPARTAMENTO = v_apto;
  else
    select max(A.CODRUA)
      into v_rua
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto;
     
     select max(A.NROPREDIO)
      into v_predio
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua;
     
     select max(A.NROAPARTAMENTO)
      into v_apto
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio;
     
     select max(A.NROSALA)
      into v_sala
      from wms.V_ENDERECO_EMB a
     where a.SEQPRODUTO = i_produto
       and a.CODRUA = v_rua
       and a.NROPREDIO = v_predio
       and a.NROAPARTAMENTO = v_apto;
  end if;
  if i_tipo = 'RUA' then
    return v_rua;
  elsif   i_tipo = 'PREDIO' then
    return v_predio;
  elsif i_tipo = 'APTO' then
    return v_apto;
  elsif i_tipo = 'SALA' then
    return v_sala;
  else
    return v_rua ||'.'||v_predio ||'.'||v_apto ||'.'||v_sala;
  end if;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_VALIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_VALIDADE" (  
  i_produto_id in number,  
  i_tipo in varchar2  
) return number as  
  v_produto_exists number;  
  v_fornecedor_id number;  
  v_fornecedor_exists number;  
  v_dias number;  
begin  
  select count(*)  
    into v_produto_exists  
    from REGRA_VALIDADE A  
   where PRODUTO_ID = i_produto_id  
     and A.TIPO_VALOR = i_tipo;  
    
  if v_produto_exists = 1 then  
    select case  
             when B.VALOR < 1  
               then B.VALOR * A.DIAS_VALIDADE  
             when B.VALOR >= 1 and B.TIPO_VALOR = 'E'  
               then A.DIAS_VALIDADE - B.VALOR  
             else B.VALOR  
           end  
      into v_dias  
      from PRODUTO A  
     inner join REGRA_VALIDADE B  
        on A.ID = B.PRODUTO_ID  
     where A.ID = i_produto_id  
       and B.TIPO_VALOR = i_tipo;  
    return v_dias;  
  end if;  
    
  select count(*)  
    into v_fornecedor_exists  
    from REGRA_VALIDADE A  
   where FORNECEDOR_ID = F_FORNECEDOR_AGG(i_produto_id)  
     and A.TIPO_VALOR = i_tipo;  
    
  if v_fornecedor_exists = 1 then  
    select case  
             when B.VALOR < 1  
               then B.VALOR * A.DIAS_VALIDADE  
             when B.VALOR >= 1 and B.TIPO_VALOR = 'E'  
               then A.DIAS_VALIDADE - B.VALOR  
             else B.VALOR  
           end  
      into v_dias  
      from PRODUTO A  
     inner join REGRA_VALIDADE B  
        on F_FORNECEDOR_AGG(A.ID) = B.FORNECEDOR_ID  
     where A.ID = i_produto_id  
       and B.TIPO_VALOR = i_tipo;  
    return v_dias;  
  end if;   
  select case  
           when B.VALOR < 1  
             then B.VALOR * A.DIAS_VALIDADE  
           when B.VALOR >= 1 and B.TIPO_VALOR = 'E'  
             then A.DIAS_VALIDADE - B.VALOR  
           else B.VALOR  
         end  
    into v_dias  
    from PRODUTO A  
   inner join REGRA_VALIDADE B  
      on B.EMPRESA_ID is not null  
   where A.ID = i_produto_id  
     and B.TIPO_VALOR = i_tipo;  
  return v_dias;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_VALOR_CARGA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_VALOR_CARGA" (i_carga number)
return number as
  v_return number;
begin
  select sum(b.qtdatendida/b.qtdembalagem*b.vlrembinformado)
    into v_return
    from consinco.mad_pedvenda a
   inner join consinco.mad_pedvendaitem b
      on b.nropedvenda = a.nropedvenda
   where a.nrocarga = i_carga
  ;
  return v_return;
end;
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_ZPL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_ZPL" (carga IN NUMBER, lote IN NUMBER) 
return varchar2 is 
  resp varchar2(4000) := ''; 
  q varchar2(1000); 
  line varchar2(1000); 
  logo varchar2(4000); 
  c1 SYS_REFCURSOR; 
  dthora varchar2(500); 
begin 
  logo := ''; 
  dthora := '^FS^FO580,329^AD^FC%,{,#^FD%d/%m/%y #H:#M:#S'; 
  for c in ( 
    SELECT W.PRECOMANDO, W.SUFCOMANDO, COLUNABANCO 
      FROM WMS.PARAMETRO_ZPL W 
     WHERE W.PADRAOETQ = 'GEN. SEPCARGA' 
  ) loop 
    q := 'SELECT '||c.COLUNABANCO||' FROM WMS.VW_ZPL_PRINT w where w.NROCARGA = :1 and w.SEQLOTE = :2'; 
    open c1 for q USING carga, lote; 
 
    LOOP 
      FETCH c1 INTO line; 
      EXIT WHEN c1%NOTFOUND; 
      line := c.PRECOMANDO || line || c.SUFCOMANDO; 
    END LOOP; 
    resp := resp || line; 
  end loop; 
  resp := resp ||dthora ||'^XZ'; 
  return resp; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_ZPL1--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_ZPL1" (carga IN NUMBER, lote IN NUMBER) 
return varchar2 is 
  resp varchar2(4000) := ''; 
  q varchar2(1000); 
  line varchar2(4000); 
  logo varchar2(4000); 
  dthora varchar2(500); 
  c1 SYS_REFCURSOR; 
begin 
dthora := '^FS^FO580,300^AD^FC%,{,#^FD%d/%m/%y #H:#M:#S'; 
  for c in ( 
    SELECT W.PRECOMANDO, W.SUFCOMANDO, COLUNABANCO 
      FROM CONSINCO.MLO_PARAMETQCONFIG W 
     WHERE W.PADRAOETQ = 'GEN. SEPCARGA' 
  ) loop 
    q := 'SELECT '||c.COLUNABANCO||' FROM WMS.VW_ZPL_PRINT w where w.NROCARGA = :1 and w.SEQLOTE = :2'; 
    open c1 for q USING carga, lote; 
 
    LOOP 
      FETCH c1 INTO line; 
      EXIT WHEN c1%NOTFOUND; 
      line := c.PRECOMANDO || line || c.SUFCOMANDO; 
    END LOOP; 
    resp := resp || line; 
  end loop; 
  resp := resp ||logo||dthora ||'^XZ'; 
  return resp; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_ZPL12--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_ZPL12" (carga IN NUMBER, lote IN NUMBER) 
return varchar2 is 
  resp varchar2(6000) := ''; 
  q varchar2(1000); 
  line varchar2(4000); 
  dthora varchar2(500); 
  c1 SYS_REFCURSOR; 
begin 
dthora := '^FS^FO580,329^AD^FC%,{,#^FD%d/%m/%y #H:#M:#S'; 
  for c in ( 
    SELECT W.PRECOMANDO, W.SUFCOMANDO, COLUNABANCO 
      FROM APEX.TB_CDA_ETQCONF01 W 
     WHERE W.PADRAOETQ = 'GEN. SEPCARGA' 
  ) loop 
    q := 'SELECT '||c.COLUNABANCO||' FROM WMS.VW_ZPL_PRINT w where w.NROCARGA = :1 and w.SEQLOTE = :2'; 
    open c1 for q USING carga, lote; 
 
    LOOP 
      FETCH c1 INTO line; 
      EXIT WHEN c1%NOTFOUND; 
      line := c.PRECOMANDO || line || c.SUFCOMANDO; 
    END LOOP; 
    resp := resp || line; 
  end loop; 
  resp := resp ||dthora ||'^XZ'; 
  return resp; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_GET_ZPL_REC--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_GET_ZPL_REC" (palete IN NUMBER)
return varchar2 is 
  resp varchar2(4000) := ''; 
  q varchar2(1000); 
  line varchar2(1000); 
  logo varchar2(4000); 
  c1 SYS_REFCURSOR; 
begin 
  logo := ''; 
  for c in ( 
    SELECT W.PRECOMANDO, W.SUFCOMANDO, COLUNABANCO 
      FROM WMS.PARAMETRO_ZPL W 
     WHERE W.SEQPARAMETQ = '101' 
  ) loop 
    q := 'SELECT '||c.COLUNABANCO||' FROM WMS.VW_ZPL_PRINT_REC w where seqpaleterf = :1'; 
    open c1 for q USING palete; 
 
    LOOP 
      FETCH c1 INTO line; 
      EXIT WHEN c1%NOTFOUND; 
      line := c.PRECOMANDO || line || c.SUFCOMANDO; 
    END LOOP; 
    resp := resp || line; 
  end loop; 
  resp := resp ||logo ||'^XZ'; 
  return resp; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_JOIN--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_JOIN" ( 
  i_table_name   varchar2, 
  i_column_name  varchar2, 
  i_separator    varchar2 default ';', 
  i_query_column varchar2 default null, 
  i_query_value  varchar2 default null 
) return varchar2 as 
  v_query_value varchar2(4000); 
  v_vc_arr2     apex_application_global.vc_arr2; 
  v_result      varchar2(32000); 
  v_statement   varchar2(4000); 
begin 
  v_statement := 'select ' || i_column_name || ' from ' || i_table_name; 
   
  if i_query_column is not null and i_query_value is not null then 
    begin 
      v_query_value := to_number(i_query_value); 
      exception when VALUE_ERROR then v_query_value := ''''||i_query_value||''''; 
    end; 
    v_statement := v_statement || 
                   ' where ' || i_query_column || ' = ' || v_query_value || 
                   ' order by 1'; 
  end if; 
  execute immediate v_statement bulk collect into v_vc_arr2; 
  v_result := apex_util.table_to_string (v_vc_arr2,';');  
  return v_result; 
end f_join; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_LOTE_C5_APEX--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_LOTE_C5_APEX" 
(i_carga in number, i_produto in number) 
return varchar2 
as 
v_lotes varchar2(1000); 
begin 
  for c1 in (select distinct seqlote from consinco.mlo_cargaesepara where nrocarga = i_carga and seqproduto = i_produto) loop 
    v_lotes := v_lotes || c1.seqlote || ', '; 
  end loop; 
  return v_lotes; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_REPOSICAO_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_REPOSICAO_ENDERECO" (i_id IN NUMBER)  
return number is  
v_qtd_reposicao number;  
begin  
  select C.LASTRO*C.ALTURA*D.QTD_EMB  
    into v_qtd_reposicao  
    from ENDERECO A  
   inner join ENDERECO_ESPECIE B  
      on A.TIPO_REPOSICAO = B.SIGLA  
   inner join PRODUTO_ESPECIE C  
      on A.ESPECIE_ID = C.ESPECIE_ID  
     and A.PRODUTO_ID = C.PRODUTO_ID  
   inner join PRODUTO_EMBALAGEM D  
      on D.ID = C.EMBALAGEM_ID  
   where A.ID = i_id  
  ;  
  return v_qtd_reposicao;  
    
  exception  
  when NO_DATA_FOUND then  
    return 0;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--FUNCTION: F_RUA_ATUAL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_RUA_ATUAL" ( 
  i_produtivo_id in number 
) return varchar2 as 
  v_rua_atual varchar2(3); 
  v_destino_id number; 
  v_tipo varchar2(1); 
begin 
  select max(destino_id), tipo 
    into v_destino_id, v_tipo 
    from movimentacao 
   where ((abast_id = i_produtivo_id and 
           abast_start is not null and 
           abast_end is null) or 
          (emp_id = i_produtivo_id and 
           emp_start is not null and 
           emp_end is null)) 
   group by tipo; 
  if v_tipo = 'P' then 
    v_rua_atual := 'box'; 
  else 
    select rua 
      into v_rua_atual 
      from endereco 
     where id = v_destino_id; 
  end if; 
  return v_tipo; 
   
  exception 
    when NO_DATA_FOUND then 
      return null; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_SEC2TIME--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_SEC2TIME" (vSec number, vMask varchar2 DEFAULT 'HH24:MI:SS') 
   RETURN varchar2 
IS 
h number; 
m number; 
s number; 
t varchar2(8); 
 
BEGIN 
if vSec is not null then 
  h := trunc(vSec/3600); 
  m := trunc(mod(vSec,3600)/60); 
  s := mod(mod(vSec,3600),60); 
  if vMask = 'HH24:MI' then 
    t := LPAD(to_char(h),2,'0')|| ':' || LPAD(to_char(m),2,'0'); 
  elsif vMask = 'HH24:MI:SS' then 
    t := LPAD(to_char(h),2,'0')|| ':' || LPAD(to_char(m),2,'0') || ':' || LPAD(to_char(s),2,'0'); 
  end if; 
else 
  t := null; 
end if; 
return t; 
END f_sec2time; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_SEP_PROX_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_SEP_PROX_ATIVIDADE" (i_produtivo IN NUMBER) 
return number is 
  v_carga number; --carga 
  v_lote_id number := 0; --lote 
  v_prioridade number; 
  v_exclusivo number; 
begin 
  select EXCLUSIVO 
    into v_exclusivo 
    from PRODUTIVO 
   where ID = i_produtivo; 
   
  if v_exclusivo = 1 then 
    select min(A.PRIORIDADE) 
      into v_prioridade 
      from CARGA A, 
           LOTE B, 
           PRODUTIVO_LS C, 
           LINHADESEPARACAO D 
     where A.ID = B.CARGA_ID 
       and B.LS = D.LS 
       and D.ID = C.LS_ID 
       and C.PRODUTIVO_ID = i_produtivo 
       and B.STATUS = 0 
    ; 
    select min(A.ID) 
      into v_carga 
      from CARGA A, 
           LOTE B, 
           PRODUTIVO_LS C, 
           LINHADESEPARACAO D 
     where A.ID = B.CARGA_ID 
       and B.LS = D.LS 
       and D.ID = C.LS_ID 
       and C.PRODUTIVO_ID = i_produtivo 
       and B.STATUS = 0 
       and A.PRIORIDADE = v_prioridade 
    ; 
    select min(B.ID) 
      into v_lote_id 
      from CARGA            A, 
           LOTE             B, 
           PRODUTIVO_LS     C, 
           LINHADESEPARACAO D 
     where A.ID = B.CARGA_ID 
       and B.LS = D.LS 
       and D.ID = C.LS_ID 
       and C.PRODUTIVO_ID = i_produtivo 
       and B.STATUS = 0 
       and A.ID = v_carga 
    ; 
  else 
    null; 
  end if; 
  if v_prioridade is null or v_carga is null or v_lote_id is null then 
    return 0; 
  else 
    return v_lote_id; 
  end if; 
   
   
  EXCEPTION 
    when NO_DATA_FOUND then 
      return 0; 
    when OTHERS then 
      return SQLCODE; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_STATUS_DESC--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_STATUS_DESC" (i_status in number)  
return varchar2 is  
    v_return varchar2(10);  
begin  
  select decode(i_status,0,'Inativo',1,'Ativo')  
    into v_return  
    from dual;  
  return v_return;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--FUNCTION: F_TESTE_DIFF--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_TESTE_DIFF" (i_in in number) return number as  
begin  
  return 1;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--FUNCTION: F_ULTIMA_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_ULTIMA_ATIVIDADE" ( 
  i_produtivo_id in number 
) return number as 
  v_atividade varchar2(1); 
  v_return number; 
begin 
  select atividade 
    into v_atividade 
    from produtivo 
   where id = i_produtivo_id 
  ; 
  if v_atividade in ('S') then 
    select nvl((select id from ( 
                  select id, 
                         row_number() over(partition by 1 order by sep_end desc) as seqnum 
                    from lote 
                   where sep_id = i_produtivo_id 
                     and sep_end is not null) 
             where seqnum = 1),0) 
      into v_return 
      from dual; 
  elsif v_atividade in ('C') then 
    select nvl((select id from ( 
                  select id, 
                         row_number() over(partition by 1 order by conf_end desc) as seqnum 
                    from lote 
                   where conf_id = i_produtivo_id 
                     and conf_end is not null) 
             where seqnum = 1),0) 
      into v_return 
      from dual; 
  elsif v_atividade in ('A') then 
    select nvl((select destino_id from ( 
                  select destino_id, 
                         row_number() over(partition by 1 order by abast_end desc) as seqnum 
                    from movimentacao 
                   where abast_id = i_produtivo_id 
                     and abast_end is not null) 
             where seqnum = 1),0) 
      into v_return 
      from dual; 
  elsif v_atividade in ('E') then 
    select nvl((select id from ( 
                  select id, 
                         row_number() over(partition by 1 order by emp_id desc) as seqnum 
                    from movimentacao 
                   where emp_id = i_produtivo_id 
                     and emp_end is not null) 
             where seqnum = 1),0) 
      into v_return 
      from dual; 
  end if; 
  return v_return; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_ULTIMA_RUA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_ULTIMA_RUA" ( 
  i_produtivo_id in number, 
  i_hoje in number default 0 
) return varchar2 as 
  v_ultima_atividade number; 
  v_ultima_rua_id number; 
  v_ultima_rua varchar2(3) := '0'; 
begin 
  select f_ultima_atividade(i_produtivo_id) 
    into v_ultima_atividade 
    from dual; 
  select case when tipo = 'P' then 0 else destino_id end 
    into v_ultima_rua_id 
    from movimentacao 
   where id = v_ultima_atividade 
     and (i_hoje = 0 or (i_hoje = 1 and trunc(abast_end) = trunc(sysdate))); 
  if v_ultima_rua_id > 0 then 
    select rua 
      into v_ultima_rua 
      from endereco 
     where id = v_ultima_rua_id; 
  end if; 
  return v_ultima_rua; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: F_VERIFY_PTA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."F_VERIFY_PTA" ( 
  i_carga IN NUMBER 
) return number is 
v_is_pta number; 
begin 
  select count(*) 
    into v_is_pta 
    from CONSINCO.MLO_CARGAEXPPROD 
   where NROCARGA = i_carga 
     and TIPESPECIE = 'PTA'; 
 
  return v_is_pta; 
end; 
/
--------------------------------------------------------------------------------
--FUNCTION: P_PRODUTIVO_ULTIMA_ATV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE FUNCTION "WMS"."P_PRODUTIVO_ULTIMA_ATV" (
  i_prod in number
) return date as
  v_return date;
  v_atividade varchar2(1);
begin
  select atividade
    into v_atividade
    from wms.produtivo
   where id = i_prod;
  select max(case when v_atividade = 'S' then SEP_END else CONF_END end)
    into v_return
    from wms.LOTE B
   where i_prod = case when v_atividade = 'S' then SEP_ID else CONF_ID end;
  return v_return;
end;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_ATUALIZAR--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_ATUALIZAR" is 
  PROCEDURE P_PRODUTOS; 
  PROCEDURE P_PRODUTO_EMBALAGEMS; 
  PROCEDURE P_EMBALAGEM_CODIGOS;  
END; 
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_ATUALIZAR" IS 
 
PROCEDURE P_PRODUTOS IS 
  BEGIN 
    MERGE INTO WMS.PRODUTO DST 
    USING (SELECT VW.ID, 
                  VW.NOME, 
                  VW.FORNECEDOR_ID, 
                  VW.REFFABRICANTE, 
                  1 AS MASK 
             FROM WMS.V_PRODUTO VW 
           UNION ALL 
           SELECT TB.ID, 
                  TB.NOME, 
                  TB.FORNECEDOR_ID, 
                  TB.REFFABRICANTE, 
                  0 AS MASK 
             FROM WMS.PRODUTO TB 
             LEFT JOIN WMS.V_PRODUTO VW 
               ON VW.ID = TB.ID 
            WHERE VW.ID IS NULL) SRC 
    ON (DST.ID = SRC.ID) 
    WHEN MATCHED THEN 
      UPDATE 
         SET DST.NOME       = SRC.NOME, 
             DST.FORNECEDOR_ID          = SRC.FORNECEDOR_ID, 
             DST.REFFABRICANTE = SRC.REFFABRICANTE 
              DELETE 
       WHERE SRC.MASK = 0 
    WHEN NOT MATCHED THEN 
      INSERT 
        (DST.ID, 
         DST.NOME, 
         DST.FORNECEDOR_ID, 
         DST.REFFABRICANTE 
         ) 
      VALUES 
        (SRC.ID, 
         SRC.NOME, 
         SRC.FORNECEDOR_ID, 
         SRC.REFFABRICANTE 
         ); 
 
  END; 
   
PROCEDURE P_PRODUTO_EMBALAGEMS IS 
  BEGIN 
    MERGE INTO WMS.PRODUTO_EMBALAGEM DST 
    USING (SELECT VW.PRODUTO_ID, 
                  VW.EMB, 
                  VW.QTD_EMB, 
                  VW.PESO_BRUTO, 
                  VW.PESO_LIQUIDO, 
                  VW.ALTURA, 
                  VW.LARGURA, 
                  VW.PROFUNDIDADE, 
                  1 AS MASK 
             FROM WMS.V_PRODUTO_EMBALAGEM VW 
           UNION ALL 
           SELECT TB.PRODUTO_ID, 
                  TB.EMB, 
                  TB.QTD_EMB, 
                  TB.PESO_BRUTO, 
                  TB.PESO_LIQUIDO, 
                  TB.ALTURA, 
                  TB.LARGURA, 
                  TB.PROFUNDIDADE, 
                  0 AS MASK 
             FROM WMS.PRODUTO_EMBALAGEM TB 
             LEFT JOIN WMS.V_PRODUTO_EMBALAGEM VW 
               ON VW.PRODUTO_ID = TB.PRODUTO_ID AND VW.QTD_EMB = TB.QTD_EMB 
            WHERE VW.PRODUTO_ID IS NULL AND VW.QTD_EMB IS NULL) SRC 
    ON (DST.PRODUTO_ID = SRC.PRODUTO_ID AND DST.QTD_EMB = SRC.QTD_EMB) 
    WHEN MATCHED THEN 
      UPDATE 
         SET DST.EMB   = SRC.EMB, 
             DST.PESO_BRUTO          = SRC.PESO_BRUTO, 
             DST.PESO_LIQUIDO = SRC.PESO_LIQUIDO, 
             DST.ALTURA = SRC.ALTURA, 
             DST.LARGURA = SRC.LARGURA, 
             DST.PROFUNDIDADE = SRC.PROFUNDIDADE 
              DELETE 
       WHERE SRC.MASK = 0 
    WHEN NOT MATCHED THEN 
      INSERT 
        (DST.PRODUTO_ID, 
          DST.EMB, 
          DST.QTD_EMB, 
          DST.PESO_BRUTO, 
          DST.PESO_LIQUIDO, 
          DST.ALTURA, 
          DST.LARGURA, 
          DST.PROFUNDIDADE 
         ) 
      VALUES 
        (SRC.PRODUTO_ID, 
          SRC.EMB, 
          SRC.QTD_EMB, 
          SRC.PESO_BRUTO, 
          SRC.PESO_LIQUIDO, 
          SRC.ALTURA, 
          SRC.LARGURA, 
          SRC.PROFUNDIDADE 
         ); 
 
  END; 
   
PROCEDURE P_EMBALAGEM_CODIGOS IS 
  BEGIN 
    MERGE INTO WMS.EMBALAGEM_CODIGO DST 
    USING (SELECT VW.EMBALAGEM_ID, 
                  VW.CODIGO, 
                  VW.TIPO, 
                  1 AS MASK 
             FROM WMS.V_EMBALAGEM_CODIGO VW 
           UNION ALL 
           SELECT TB.EMBALAGEM_ID, 
                  TB.CODIGO, 
                  TB.TIPO, 
                  0 AS MASK 
             FROM WMS.EMBALAGEM_CODIGO TB 
             LEFT JOIN WMS.V_EMBALAGEM_CODIGO VW 
               ON VW.EMBALAGEM_ID = TB.EMBALAGEM_ID 
            WHERE VW.EMBALAGEM_ID IS NULL) SRC 
    ON (DST.EMBALAGEM_ID = SRC.EMBALAGEM_ID) 
    WHEN MATCHED THEN 
      UPDATE 
         SET DST.CODIGO       = SRC.CODIGO, 
             DST.TIPO          = SRC.TIPO 
              DELETE 
       WHERE SRC.MASK = 0 
    WHEN NOT MATCHED THEN 
      INSERT 
        (DST.EMBALAGEM_ID, 
         DST.CODIGO, 
         DST.TIPO 
         ) 
      VALUES 
        (SRC.EMBALAGEM_ID, 
         SRC.CODIGO, 
         SRC.TIPO 
         ); 
 
  END;     
END; 
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_AUX--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_AUX" as

function test_func (
    p_arg1 in number )
    return varchar2;

end;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_INIT_DBLINK--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_INIT_DBLINK" as
  procedure p_init_data;
  procedure p_clear_all;
  procedure p_insert_produto;
  procedure p_insert_produto_embalagem;
  procedure p_insert_embalagem_codigo;
  procedure p_insert_produto_especie;
  procedure p_insert_endereco_rua;
  procedure p_insert_endereco;
  procedure p_insert_endereco_armazenagem;
  procedure p_insert_endereco_validade;
  procedure p_insert_palete;
end PKG_INIT_DBLINK;
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_INIT_DBLINK" as
  procedure p_init_data as
  begin
    p_clear_all;
    p_insert_produto;
    p_insert_produto_embalagem;
    p_insert_embalagem_codigo;
    p_insert_produto_especie;
    p_insert_endereco_rua;
    p_insert_endereco;
    p_insert_endereco_armazenagem;
    p_insert_endereco_validade;
    p_insert_palete;
    commit;
  end p_init_data;

  procedure p_clear_all as
  begin
    --delete from wms.carga_import;
    --delete from wms.carga;
    --delete from wms.corte;
    --delete from wms.lote_print_log;
    delete from wms.movimentacao;
    delete from wms.produto;
    delete from wms.produto_embalagem;
    delete from wms.embalagem_codigo;
    delete from wms.produto_especie;
    delete from wms.endereco_rua;
    delete from wms.endereco;
    delete from wms.endereco_armazenagem;
    delete from wms.endereco_validade;
    delete from wms.palete;
    commit;
  end p_clear_all;

  procedure p_insert_produto as
  begin
    insert into wms.produto(
      id,
      nome,
      endereco_tipo_id,
      tipo_armazenagem_id,
      dias_validade,
      fornecedor_id,
      status,
      REFFABRICANTE
    )
    select A.SEQPRODUTO,
           A.DESCCOMPLETA,
           (
           select x.ordemascend
             from consinco.mlo_produto@prod z
            inner join consinco.mlo_tipendereco@prod x
               on z.CODTIPENDERECO = x.codtipendereco
            where z.SEQPRODUTO = a.seqproduto
           ) as endereco_tipo,
           (
           select c.id
             from consinco.MLO_ATRIBUTOFIXO@prod b
            inner join wms.tipo_armazenagem c
               on b.descricao = c.nome
            inner join consinco.mlo_produto@prod d
               on d.TIPARMAZENAGEM = b.lista
            Where TIPATRIBUTOFIXO = 'TIPARMAZ'
              and d.SEQPRODUTO = a.seqproduto
              and d.nroempresa = 1
           ) as tipo_armazenagem,
           A.PZOVALIDADEDIA,
           CONSINCO.F_FORNECEDOR_AGG@prod(A.SEQPRODUTO),
           1 as status ,
           A.REFFABRICANTE
      from CONSINCO.MLO_PRODUTO@prod A
     where A.NROEMPRESA = 1
       and exists (
         select 1 from consinco.mlo_prodembalagem@prod k
          where k.seqproduto = a.seqproduto
            and k.statusembalagem = 'A'
       );
  end p_insert_produto;

  procedure p_insert_produto_embalagem as
  begin
    insert into wms.produto_embalagem
    select null as id,
           c.codlinhasepar as ls,
           b.id as produto_id,
           a.embalagem as emb,
           a.qtdembalagem as qtd_emb,
           a.pesobruto as peso_bruto,
           a.pesoliquido as peso_liquido,
           a.altura as altura,
           a.largura as largura,
           a.profundidade as profundidade
      from consinco.mlo_prodembalagem@prod a
     inner join wms.produto b
        on a.seqproduto = b.id
      left join consinco.mlo_prodembwm@prod c
        on c.seqproduto = a.seqproduto
       and c.qtdembalagem =  a.qtdembalagem
       and c.nroempresa = a.nroempresa
     where a.nroempresa = 1
       and a.statusembalagem = 'A';
    commit;
    update wms.produto c
       set embalagem_id = (
         select d.id
           from consinco.MAP_FAMDIVISAO@prod A
          inner join consinco.MAP_PRODUTO@prod B
             on a.seqfamilia = b.seqfamilia
          inner join wms.produto_embalagem d
             on d.qtd_emb = a.padraoembcompra
            and c.id = d.produto_id
          where c.id = b.seqproduto
            and a.nrodivisao = 1
       );
    delete from wms.produto
     where embalagem_id is null;
  end p_insert_produto_embalagem;

  procedure p_insert_embalagem_codigo as
  begin
    insert into wms.embalagem_codigo
    select null,
           b.id,
           c.CODACESSO,
           c.TIPCODIGO
      from wms.produto a
     inner join wms.produto_embalagem b
        on a.id = b.produto_id
     inner join consinco.mlo_prodcodigo@prod c
        on a.id = c.Seqproduto
       and b.produto_id = c.Seqproduto
     where c.Nroempresa = 1
     order by 4, 3;
  end p_insert_embalagem_codigo;

  procedure p_insert_produto_especie as
  begin
    insert into wms.PRODUTO_ESPECIE (ID,ESPECIE_ID,EMBALAGEM_ID,ESTOQUE_MIN,LASTRO,ALTURA,SOBRA,PRODUTO_ID)
    select null as id,
           decode(C.ESPECIEENDERECO, 'A',1, 'M',2, 'P',5, 'V',3) as especie_id,
           b.id as embalagem_id,
           C.ESTQMINIMOREP as estoque_min,
           C.PALETELASTRO as lastro,
           C.PALETEALTURA as altura,
           0 as sobra,
           a.id as produto_id
      from consinco.MLO_PRODESPENDERECO@prod C,
           wms.produto a,
           wms.produto_embalagem b
     where a.id = b.produto_id
       and b.qtd_emb = c.qtdembalagem
       and a.id = c.seqproduto
       And c.NROEMPRESA = 1
       and C.ESPECIEENDERECO in ('A','M','P','V')
     order by 3,2;
  end p_insert_produto_especie;

  procedure p_insert_endereco_rua as
  begin
    insert into wms.ENDERECO_RUA
    select null, codrua, 1, 0, 1
      from consinco.mlo_rua@prod;
  end;

  procedure p_insert_endereco as
  begin
    insert into wms.endereco j (
      id,
      tipo_id,
      especie_id,
      rua,
      predio,
      apartamento,
      sala,
      pulmao,
      terreo,
      produto_id,
      embalagem_id,
      qtd_atual,
      status,
      expedicao,
      TIPO_REPOSICAO,
      tipo_especial,
      gerar_reposicao,
      virtual
    )
    select a.seqendereco,
           max(c.ordemascend),
           e.id especie_id,
           codrua as rua,
           nropredio as predio,
           nroapartamento as apartamento,
           nrosala as sala,
           case when e.sigla = 'P' then 1 else 0 end as PULMAO,
           decode(a.indterreoaereo, 'T', 1, 0) as TERREO,
           a.seqproduto,
           f.id,
           case when a.qtdatual >= 0 then a.qtdatual else 0 end,
           1,
           case when e.sigla = 'P' or a.codrua in ('AV','998','996') then 0 else 1 end,
           decode(A.TIPREPOSICAOEND, 'M','A','N','P','C','M'),
           (select count(*)
              from consinco.Mlo_Tipendperm@prod b1
             where b1.seqendereco = a.seqendereco
               and b1.codtipendereco = 'S') as tipo_especial,
           case
             when a.codrua in ('990','995','996','997','998','999','AV') or
                  e.sigla = 'P'
               then 0
               else 1
           end,
           case
             when a.codrua in ('990','995','996','997','998','999','AV')
               then 1
               else 0
           end
      from consinco.mlo_endereco@prod A
     inner join consinco.Mlo_Tipendperm@prod b
        on a.seqendereco = b.seqendereco
     inner join consinco.mlo_tipendereco@prod c
        on b.codtipendereco = c.codtipendereco
     inner join consinco.mlo_especieendereco@prod d
        on d.especieendereco = a.especieendereco
     inner join wms.endereco_especie e
        on e.sigla = d.especieendereco
      left join wms.produto_embalagem f
        on f.qtd_emb = a.qtdembalagem
       and f.produto_id = a.seqproduto
     where b.codtipendereco not in ('S')
       and a.statusendereco not in ('I','B')
       and ((a.seqproduto is null and e.sigla = 'P') or
            (a.seqproduto is not null))
     group by a.seqendereco,
           e.id,
           e.sigla,
           codrua,
           nropredio,
           nroapartamento,
           nrosala,
           a.indterreoaereo,
           a.seqproduto,
           a.qtdatual,
           f.id,
           a.seqpaleterf,
           decode(A.TIPREPOSICAOEND, 'M','A','N','P','C','M')
     order by 2, 3, 4, 5;
  end p_insert_endereco;

  procedure p_insert_endereco_armazenagem as
  begin
    insert into wms.endereco_armazenagem (endereco_id, armazenagem_id)
    select c.id, d.id as tip
      from consinco.mlo_armazenperm@prod a
     inner join consinco.MLO_ATRIBUTOFIXO@prod b
        on a.tiparmazenagem = b.lista
     inner join wms.endereco c
        on c.id = a.seqendereco
     inner join wms.TIPO_ARMAZENAGEM d
        on d.nome = b.descricao
     where b.TIPATRIBUTOFIXO = 'TIPARMAZ'
     order by 1, 2;
  end p_insert_endereco_armazenagem;

  procedure p_insert_endereco_validade as
  begin
    insert into wms.endereco_validade
    select a.seqenderecoqtde, a.seqendereco, a.qtdatual, a.dtavalidade, a.dtarecebimento, 1
      from CONSINCO.MLO_ENDERECOQTDE@prod a
     where exists (
           select 1
             from wms.endereco b
            where a.seqendereco = b.id
              and b.especie_id = 5 /*especie pulmao*/
     );
  end p_insert_endereco_validade;

  procedure p_insert_palete as
  begin
    insert into wms.palete(id, qtd, endereco_id, embalagem_id, carga_id, status)
    select a.seqpaleterf,
           a.lastro*a.altura+a.sobra,
           b.seqendereco,
           c.id,
           nvl(a.nrocargareceb, 0),
           4
      from consinco.mlo_palete@prod a
     inner join consinco.mlo_endereco@prod b
        on a.seqpaleterf = b.seqpaleterf
     inner join wms.produto_embalagem c
        on a.qtdembalagem = c.qtd_emb
       and c.produto_id = a.seqproduto
     order by 1;
  end p_insert_palete;
end PKG_INIT_DBLINK;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_KANBAN--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_KANBAN" as

function f_get_carga_column(
  i_carga in number
) return number;

function f_get_carga_column_title(
  i_carga in number
) return varchar2;

function f_get_title(
  i_carga in number
) return varchar2;

function f_get_footer(
  i_carga in number
) return varchar2;

function f_get_box(
  i_carga in number
) return varchar2;

function f_get_group_title(
  i_box in number,
  i_data_i in date,
  i_data_f in date
) return varchar2;

function f_get_group_footer(
  i_carga in number,
  i_data_i in date,
  i_data_f in date
) return varchar2;
end;
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_KANBAN" as
function f_get_carga_column(
    i_carga in number
) return number is
    v_return number;
begin

select decode(A.STATUS,
       0, 0,
       1, 1,
       2, case
              when (select STATUSCARGA
                      from consinco.mlo_cargaexped D
                     where D.nrocarga = A.ID) = 'L'
               and (select count(*)
                      from corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) = 0
                then 4
              when (select STATUSCARGA
                      from consinco.mlo_cargaexped D
                     where D.nrocarga = A.ID) = 'F'
               and (select count(*)
                      from wms.corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) = 0
                then 5
              when (select count(*)
                      from wms.corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) > 0
                then 2
                else 3
              end
       )
  into v_return
  from WMS.CARGA         A,
       WMS.CARGA_IMPORT  B,
       CONSINCO.MLO_CARGAEXPED C
 where A.ID = B.ID
  and A.ID = C.NROCARGA
  and exists (select 1 from WMS.LOTE D WHERE A.ID = D.CARGA_ID)
  and A.ID = i_carga;
return v_return;
end f_get_carga_column;

function f_get_carga_column_title(
    i_carga in number
) return varchar2 is
    v_return varchar2(100);
begin
select decode(A.STATUS,
       0, 'No iniciado',
       1, 'Iniciado',
       2, case
              when (select STATUSCARGA
                      from consinco.mlo_cargaexped D
                     where D.nrocarga = A.ID) = 'L'
               and (select count(*)
                      from corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) = 0
                then 'Liberado'
              when (select STATUSCARGA
                      from consinco.mlo_cargaexped D
                     where D.nrocarga = A.ID) = 'F'
               and (select count(*)
                      from wms.corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) = 0
                then 'Faturado'
              when (select count(*)
                      from wms.corte D
                     where D.CARGA_ID = A.ID
                       and D.DONE = 0) > 0
                then 'CORTE'
                else 'Finalizado'
              end
       )
  into v_return
  from WMS.CARGA         A,
       WMS.CARGA_IMPORT  B,
       CONSINCO.MLO_CARGAEXPED C
 where A.ID = B.ID
  and A.ID = C.NROCARGA
  and exists (select 1 from WMS.LOTE D WHERE A.ID = D.CARGA_ID)
  and A.ID = i_carga;
return v_return;
end f_get_carga_column_title;

function f_get_title(
  i_carga in number
) return varchar2 is
  v_return varchar2(100);
  v_finalizada number;
  v_qtd_conf number;
  v_total number;
  v_box number;
begin
  select count(*)
    into v_finalizada
    from WMS.LOTE E
   where E.CARGA_ID = i_carga
     and E.STATUS = 4
  ;
  select count(*)
    into v_qtd_conf
    from wms.lote
   where carga_id = i_carga
     and status = 3
     and LS not in ('FR','ME','CA','MF')
  ;
  select count(*)
    into v_total
    from WMS.LOTE E
   where E.CARGA_ID = i_carga
  ;
  select box_id/10
    into v_box
    from WMS.CARGA_IMPORT
   where ID = i_carga
  ;
  v_return := '<span '||
              case when v_finalizada > 0
                then 'class="c-green"'
                else 'class=""'
              end || '>'|| i_carga || ' - ' ||
              v_finalizada || '/' || v_total ||
              ' - C. ' || v_qtd_conf ||
              '</span>';
return v_return;
end f_get_title;

function f_get_footer(
  i_carga in number
) return varchar2 is
  v_return varchar2(1000);
begin
  select 'B.' || box_id/10 || ' / ' || destino
    into v_return
    from wms.carga_import
   where id = i_carga;
  return v_return;
end f_get_footer;

function f_get_box(
  i_carga in number
) return varchar2 is
  v_return varchar2(1000);
begin
  select 'B.' || substr(lpad(box_id, 3, '0'), 1, 2)
    into v_return
    from wms.carga_import B
   where id = i_carga;
  return v_return;
end f_get_box;

function f_get_group_title (
  i_box in number,
  i_data_i in date,
  i_data_f in date
) return varchar2 is
  v_return varchar2(1000);
  v_valor number;
begin
  select sum(VALORCARGA)
    into v_valor
    from WMS.CARGA         A,
         WMS.CARGA_IMPORT  B,
         CONSINCO.MLO_CARGAEXPED C
   where A.ID = B.ID
     and A.ID = C.NROCARGA
     and TRUNC(A.CREATED) between i_data_i and i_data_f
     and exists (select 1 from WMS.LOTE D WHERE A.ID = D.CARGA_ID)
     and C.TIPENTREGA != 'R'
     and B.BOX_ID != 999
     and B.BOX_ID = i_box;
  
  v_return := 'B.'||i_box||' - '|| to_char(v_valor,'FML999G999G999G999G990D00');
  return v_return;
end f_get_group_title;

function f_get_group_footer(
  i_carga in number,
  i_data_i in date,
  i_data_f in date
) return varchar2 as
  v_box number;
  v_qtd_volume number;
  v_qtd_item number;
  v_peso number;
  v_volume number;
  v_valor number;
  v_return varchar2(1000);
begin
  select box_id
    into v_box
    from wms.carga_import
   where id = i_carga
  ;
  select sum(valorcarga)
    into v_valor
    from consinco.mlo_cargaexped
   where nrobox = v_box
     and trunc(dtahorgeracao) between i_data_i and i_data_f
  ;
  select sum(a.qtd_volume), sum(a.qtd_item), sum(a.peso), sum(a.volume)
    into v_qtd_volume, v_qtd_item, v_peso, v_volume
    from wms.lote a
   inner join carga_import b
      on b.id = a.carga_id
   where b.box_id = v_box
     and trunc(b.created) between i_data_i and i_data_f
     and B.BOX_ID = v_box
  ;
  
  v_return := 'Valor: ' || to_char(v_valor,'FML999G999G999G999G990D00') ||
              '<br>Qtd.Itens: '||v_qtd_item||
              '<br>Qtd.Volume: '||v_qtd_volume ||
              '<br>Peso: ' ||to_char(v_peso,'999G999G999G999G990D00') ||
              '<br>Volume: '|| to_char(v_volume,'999G999G999G999G990D0000');
  return v_return;
end f_get_group_footer;
end;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_MOTORISTA_CARGA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_MOTORISTA_CARGA" as
  procedure p_add_placa(
    i_placa varchar2,
    i_user varchar2
  );
  
  procedure p_vincular_motorista(
    i_motorista number,
    i_user varchar2,
    i_plc_codigo number
  );
  
  procedure p_add_motorista_dia(
    i_motorista number,
    i_box number,
    i_user varchar2,
    i_desc varchar2 default null
  );
  
  procedure p_update_box(
    i_cgd_code number,
    i_box number,
    i_user varchar2
  );
  
  procedure p_update_desc(
    i_cgd_code number,
    i_desc varchar2,
    i_user varchar2
  );
  
  procedure p_del_motorista_dia(
    i_motorista number
  );
  
  procedure p_add_carga(
    i_motorista number,
    i_carga number,
    i_user varchar2,
    i_tipo varchar2,
    o_return out number
  );
  
  procedure p_update_carga(
    i_motorista number,
    i_carga number,
    i_user varchar2
  );
  
  procedure p_del_carga(
    i_carga number,
    i_tipo varchar2
  );
  
  procedure p_finish_dia(
    i_cgd_code number
  );
  
  procedure p_clear_virtual(
    i_motorista number,
    i_data_inicial date,
    i_data_final date
  );
  
  procedure p_publicar_cargas(
    i_motorista number,
    i_data_inicial date,
    i_data_final date,
    i_user varchar2
  );
end;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_MOV_HORIZONTAL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_MOV_HORIZONTAL" as 
  procedure init; 
end; 
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_MOV_HORIZONTAL" as 
  procedure init as 
  begin 
    null; 
  end; 
end; 
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_PRODUTIVO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_PRODUTIVO" as
procedure p_inativar_permanente(
  i_produtivo number
);
end;
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_PRODUTIVO" as
  procedure p_inativar_permanente(
    i_produtivo number
  ) as
  begin
    update PRODUTIVO
       set STATUS = -1
     where ID = i_produtivo
    ;
  end;
end;
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_RECEBIMENTO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_RECEBIMENTO" as  
  procedure p_check_palete(  
    i_palete_id in number,  
    i_user in varchar2  
  );  
    
  procedure p_set_conf_palete(  
    i_conf_id IN NUMBER,  
    i_palete_id IN NUMBER  
  );  
    
  procedure p_check_codigo_barras(  
    i_palete_id in number,  
    i_codigo_barras in varchar2  
  );  
    
  function f_get_validade_parametro(  
    i_produto_id in number,  
    i_tipo in varchar2  
  ) return number;  
    
  function f_check_validade_recebimento(  
    i_produto_id in number,  
    i_validade in date  
  ) return boolean;  
    
  procedure p_solicitar_validade(  
    i_palete_id in number,  
    i_validade in date,  
    i_conf_qtd in number  
  );  
    
  procedure p_finalizar_solicitacao(  
    i_id in number,  
    i_status in number  
  );  
    
  procedure p_finalizar_palete(  
    i_palete_id in number,  
    i_validade in date,  
    i_conf_qtd in number  
  );  
   
  procedure p_criar_movimentacao( 
    i_palete_id in number 
  ); 
end;  
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_RECEBIMENTO" as  
--------------------------------------------------------------------------------  
--------------------------------------------------------------------------------  
  procedure p_criar_movimentacao( 
    i_palete_id in number 
  ) as  
    v_movimentacao_id number; 
  begin 
    select movimentacao_seq.nextval 
      into v_movimentacao_id 
      from dual; 
    insert into movimentacao ( 
      id, 
      tipo, 
      palete_id, 
      origem_id, 
      destino_id, 
      status, 
      qtd, 
      emb, 
      qtd_emb 
    ) 
    select v_movimentacao_id, 
           'E', 
           a.id as palete_id, 
           c.box_id, 
           a.endereco_id, 
           0, 
           a.conf_qtd, 
           b.emb, 
           b.qtd_emb 
      from palete a 
     inner join produto_embalagem b 
        on a.embalagem_id = b.id 
     inner join carga_import c 
        on a.carga_id = c.id 
     where a.id = i_palete_id; 
    insert into movimentacao_palete (palete_id, movimentacao_id) 
    values (i_palete_id, v_movimentacao_id); 
  end; 
--------------------------------------------------------------------------------  
  procedure p_finalizar_palete(  
    i_palete_id in number,  
    i_validade in date,  
    i_conf_qtd in number  
  ) as  
  begin  
    update palete  
       set conf_qtd = i_conf_qtd,  
           conf_end = sysdate,  
           validade = i_validade,  
           status = 2  
     where id = i_palete_id  
    ; 
    p_criar_movimentacao(i_palete_id); 
  end;  
--------------------------------------------------------------------------------  
  procedure p_finalizar_solicitacao(  
    i_id in number,  
    i_status in number  
  ) as  
    v_validade date;  
    v_palete_id number;  
  begin  
    update palete_validade  
       set status = i_status  
     where id = i_id  
    ;  
    select palete_id, validade  
      into v_palete_id, v_validade  
      from palete_validade  
     where id = i_id  
    ;  
    if i_status = 1 then  
      update palete  
         set validade = v_validade,  
             status = 2  
       where id = v_palete_id  
      ;  
    elsif i_status = -1 then  
      update palete  
         set conf_qtd = null,  
             conf_end = null,  
             validade = null,  
             status = 1  
       where id = v_palete_id  
      ;  
    else  
      raise_application_error(-20009,'Erro interno. Entre em contato com o TI.');  
    end if;  
    commit;  
  end p_finalizar_solicitacao;  
--------------------------------------------------------------------------------  
  procedure p_solicitar_validade(  
    i_palete_id in number,  
    i_validade in date,  
    i_conf_qtd in number  
  ) as  
    v_exists number;  
  begin  
    select count(*)  
      into v_exists  
      from PALETE_VALIDADE  
     where palete_id = i_palete_id  
       and validade = i_validade;  
      
    if v_exists = 0 then  
      insert into PALETE_VALIDADE(  
        palete_id,  
        validade,  
        status,  
        conf_qtd  
      ) values (  
        i_palete_id,  
        i_validade,  
        0,  
        i_conf_qtd  
      );  
      update palete  
         set conf_qtd = i_conf_qtd,  
             conf_end = sysdate  
       where id = i_palete_id  
      ;  
    else  
      raise_application_error(-20008,'Ja foi realizada uma solicitao para esta data.');  
    end if;  
  end p_solicitar_validade;  
--------------------------------------------------------------------------------  
  function f_check_validade_recebimento(  
    i_produto_id in number,  
    i_validade in date  
  ) return boolean as  
    v_dias_parametro number;  
    v_sysdate date := trunc(sysdate);  
    v_shelflife number;  
  begin  
    select DIAS_VALIDADE  
      into v_shelflife  
      from PRODUTO  
     where ID = i_produto_id;  
    v_dias_parametro := f_get_validade_parametro(i_produto_id, 'R');  
    if v_sysdate - v_dias_parametro < i_validade - v_shelflife then  
      return true;  
    else  
      return false;  
    end if;  
  end f_check_validade_recebimento;  
--------------------------------------------------------------------------------  
  function f_get_validade_parametro(  
    i_produto_id in number,  
    i_tipo in varchar2  
  ) return number as  
    v_produto_exists number;  
    v_fornecedor_id number;  
    v_fornecedor_exists number;  
    v_dias number;  
  begin  
    select count(*)  
      into v_produto_exists  
      from REGRA_VALIDADE A  
     where PRODUTO_ID = i_produto_id  
       and (VALOR_RECEBIMENTO is not null and i_tipo = 'R')  
        or (VALOR_EXPEDICAO is not null and i_tipo = 'E');  
      
    if v_produto_exists = 1 then  
      select case  
               when B.VALOR_RECEBIMENTO < 1 and i_tipo = 'R'  
                 then (1-B.VALOR_RECEBIMENTO) * A.DIAS_VALIDADE  
               when B.VALOR_RECEBIMENTO >= 1 and i_tipo = 'R'  
                 then A.DIAS_VALIDADE - B.VALOR_RECEBIMENTO  
             end  
        into v_dias  
        from PRODUTO A  
       inner join REGRA_VALIDADE B  
          on A.ID = B.PRODUTO_ID  
       where A.ID = i_produto_id;  
      return v_dias;  
    end if;  
      
    select count(*)  
      into v_fornecedor_exists  
      from REGRA_VALIDADE A  
     where FORNECEDOR_ID = F_FORNECEDOR_AGG(i_produto_id)  
       and (VALOR_RECEBIMENTO is not null and i_tipo = 'R')  
        or (VALOR_EXPEDICAO is not null and i_tipo = 'E');  
      
    if v_fornecedor_exists = 1 then  
      select case  
               when B.VALOR_RECEBIMENTO < 1 and i_tipo = 'R'  
                 then (1-B.VALOR_RECEBIMENTO) * A.DIAS_VALIDADE  
               when B.VALOR_RECEBIMENTO >= 1 and i_tipo = 'R'  
                 then A.DIAS_VALIDADE - B.VALOR_RECEBIMENTO  
             end  
        into v_dias  
        from PRODUTO A  
       inner join REGRA_VALIDADE B  
          on F_FORNECEDOR_AGG(A.ID) = B.FORNECEDOR_ID  
       where A.ID = i_produto_id;  
      return v_dias;  
    end if;   
    select case  
             when B.VALOR_RECEBIMENTO < 1 and i_tipo = 'R'  
               then (1-B.VALOR_RECEBIMENTO) * A.DIAS_VALIDADE  
             when B.VALOR_RECEBIMENTO >= 1 and i_tipo = 'R'  
               then A.DIAS_VALIDADE - B.VALOR_RECEBIMENTO  
           end  
      into v_dias  
      from PRODUTO A  
     inner join REGRA_VALIDADE B  
        on B.EMPRESA_ID is not null  
     where A.ID = i_produto_id;  
    return v_dias;  
  end f_get_validade_parametro;  
--------------------------------------------------------------------------------  
  procedure p_check_codigo_barras(  
    i_palete_id in number,  
    i_codigo_barras in varchar2  
  ) as  
    v_exists number;  
  begin  
    select count(distinct b.produto_id)  
      into v_exists  
      from embalagem_codigo a  
     inner join produto_embalagem b  
        on a.embalagem_id = b.id  
     inner join produto c  
        on b.produto_id = c.id  
     where a.codigo =  i_codigo_barras;  
      
    if v_exists = 0 then  
      raise_application_error(-20005,'Codigoo de barras nao esta cadastrado no sistema.');  
    elsif v_exists > 1 then  
      raise_application_error(-20006,'Duplicidade de codigoo de barras. Entre em contato com o cadastro.');  
    end if;  
    select count(*)  
      into v_exists  
      from PRODUTO_EMBALAGEM A  
     inner join EMBALAGEM_CODIGO B  
        on B.EMBALAGEM_ID = A.ID  
     inner join PALETE C  
        on C.EMBALAGEM_ID = A.ID  
     inner join PRODUTO D  
        on D.ID = A.PRODUTO_ID  
     inner join PRODUTO_ESPECIE E  
        on E.EMBALAGEM_ID = A.ID  
     where E.ESPECIE_ID = 5  
       and B.CODIGO = i_codigo_barras  
       and C.ID = i_palete_id;  
    if v_exists = 0 then  
      raise_application_error(-20007,'Codigoo de barras invalido para este palete.');  
    end if;  
  end p_check_codigo_barras;  
--------------------------------------------------------------------------------  
  procedure p_set_conf_palete(  
    i_conf_id IN NUMBER,  
    i_palete_id IN NUMBER  
  ) as  
  begin  
    update PALETE  
       set CONF_ID = i_conf_id,  
           CONF_START = sysdate,  
           STATUS = 1  
     where ID = i_palete_id;  
  end p_set_conf_palete;  
--------------------------------------------------------------------------------  
  procedure p_check_palete(  
    i_palete_id in number,  
    i_user in varchar2  
  ) as  
    v_status number;  
    v_conf_id number;  
    v_solicitacao number;  
  begin  
    select a.status, a.conf_id, b.status  
      into v_status, v_conf_id, v_solicitacao  
      from palete a  
      left join palete_validade b  
        on a.id = b.palete_id  
       and b.status in (0)  
     where a.id = i_palete_id  
    ;  
    if v_status = 0 then  
      p_set_conf_palete(  
        i_user,  
        i_palete_id  
      );  
    elsif v_status = 1 and v_conf_id != i_user then  
      --Palete sendo conferido por outro conferente  
      raise_application_error(-20001,'Palete sendo conferido pelo conferente'||v_conf_id||'.');  
    elsif v_status = 1 and v_conf_id = i_user and v_solicitacao = 0 then  
      --Palete em processo de solicita de valida  
      raise_application_error(-20002,'Aguardando aprovacao da validade fora do prazo.');  
    elsif v_status = 2 then  
      --Processo de conferencia deste palete esta finalizada 
      --Verificar se a movimentacao ja foi finalizada 
       
      raise_application_error(-20003,'Conferencia do palete finalizada.');  
    end if;  
    exception  
      when no_data_found then  
        raise_application_error(-20004,'Palete nao existe.');  
  end p_check_palete;  
--------------------------------------------------------------------------------  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--PACKAGE: PKG_WMSDEV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."PKG_WMSDEV" as 
  procedure p_init_data;  
  procedure p_clear_all;  
  procedure p_insert_produto;  
  procedure p_insert_produto_embalagem;  
  procedure p_insert_embalagem_codigo;  
  procedure p_insert_produto_especie;  
  procedure p_insert_endereco_rua; 
  procedure p_insert_endereco;  
  procedure p_insert_endereco_armazenagem;  
  procedure p_insert_endereco_validade;  
  procedure p_insert_palete;  
end pkg_wmsdev;  
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."PKG_WMSDEV" as 
  procedure p_init_data as  
  begin  
    --teste diff  
    p_clear_all;  
    p_insert_produto;  
    p_insert_produto_embalagem;  
    p_insert_embalagem_codigo;  
    p_insert_produto_especie;  
    p_insert_endereco_rua; 
  	p_insert_endereco;  
    p_insert_endereco_armazenagem;  
    p_insert_endereco_validade;  
    p_insert_palete;  
    commit;  
  end p_init_data;  
    
  procedure p_clear_all as  
  begin  
    delete from wms.carga_import;  
    delete from wms.carga;  
    delete from wms.corte; 
    delete from wms.lote_print_log; 
    delete from wms.movimentacao; 
    delete from wms.produto; 
    delete from wms.produto_embalagem; 
    delete from wms.embalagem_codigo; 
    delete from wms.produto_especie; 
    delete from wms.endereco_rua; 
    delete from wms.endereco; 
    delete from wms.endereco_armazenagem; 
    delete from wms.endereco_validade; 
    delete from wms.palete; 
    commit;  
  end p_clear_all;  
    
  procedure p_insert_produto as  
  begin  
  	insert into wms.produto(  
      id,  
      nome,  
      endereco_tipo_id,   
      tipo_armazenagem_id,  
      dias_validade,  
      fornecedor_id,  
      status, 
      REFFABRICANTE  
    )  
    select A.SEQPRODUTO,  
           A.DESCCOMPLETA,  
           (  
           select x.ordemascend  
             from consinco.mlo_produto z  
            inner join consinco.mlo_tipendereco x  
               on z.CODTIPENDERECO = x.codtipendereco  
            where z.SEQPRODUTO = a.seqproduto  
           ) as endereco_tipo,  
           (  
           select c.id  
             from consinco.MLO_ATRIBUTOFIXO b  
            inner join wms.tipo_armazenagem c  
               on b.descricao = c.nome  
            inner join consinco.mlo_produto d  
               on d.TIPARMAZENAGEM = b.lista  
            Where TIPATRIBUTOFIXO = 'TIPARMAZ'  
              and d.SEQPRODUTO = a.seqproduto  
              and d.nroempresa = 1  
           ) as tipo_armazenagem,  
           A.PZOVALIDADEDIA,  
           F_FORNECEDOR_AGG(A.SEQPRODUTO),  
           1 as status , 
           A.REFFABRICANTE 
      from CONSINCO.MLO_PRODUTO A  
     where A.NROEMPRESA = 1  
       and exists (  
         select 1 from consinco.mlo_prodembalagem k  
          where k.seqproduto = a.seqproduto  
            and k.statusembalagem = 'A'  
       );  
  end p_insert_produto;  
    
  procedure p_insert_produto_embalagem as  
  begin  
  	insert into wms.produto_embalagem  
    select null as id,   
           c.codlinhasepar as ls,  
           b.id as produto_id, 
           a.embalagem as emb,  
           a.qtdembalagem as qtd_emb,  
           a.pesobruto as peso_bruto,  
           a.pesoliquido as peso_liquido,  
           a.altura as altura,  
           a.largura as largura,  
           a.profundidade as profundidade  
      from consinco.mlo_prodembalagem a  
     inner join wms.produto b  
        on a.seqproduto = b.id  
      left join consinco.mlo_prodembwm c  
        on c.seqproduto = a.seqproduto 
       and c.qtdembalagem =  a.qtdembalagem 
       and c.nroempresa = a.nroempresa 
     where a.nroempresa = 1  
       and a.statusembalagem = 'A';  
    commit; 
    update wms.produto c  
       set embalagem_id = (  
         select d.id  
           from consinco.MAP_FAMDIVISAO A  
          inner join consinco.MAP_PRODUTO B  
             on a.seqfamilia = b.seqfamilia  
          inner join wms.produto_embalagem d  
             on d.qtd_emb = a.padraoembcompra  
            and c.id = d.produto_id  
          where c.id = b.seqproduto  
            and a.nrodivisao = 1  
       );  
    delete from wms.produto  
     where embalagem_id is null;  
  end p_insert_produto_embalagem;  
    
  procedure p_insert_embalagem_codigo as  
  begin  
  	insert into wms.embalagem_codigo  
    select null,  
           b.id,  
           c.CODACESSO,  
           c.TIPCODIGO  
      from wms.produto a  
     inner join wms.produto_embalagem b  
        on a.id = b.produto_id  
     inner join consinco.mlo_prodcodigo c  
        on a.id = c.Seqproduto  
       and b.produto_id = c.Seqproduto  
     where c.Nroempresa = 1  
     order by 4, 3;  
  end p_insert_embalagem_codigo;  
    
  procedure p_insert_produto_especie as  
  begin  
  	insert into wms.PRODUTO_ESPECIE (ID,ESPECIE_ID,EMBALAGEM_ID,ESTOQUE_MIN,LASTRO,ALTURA,SOBRA,PRODUTO_ID)  
    select null as id,  
           decode(C.ESPECIEENDERECO, 'A',1, 'M',2, 'P',5, 'V',3) as especie_id,  
           b.id as embalagem_id,  
           C.ESTQMINIMOREP as estoque_min,  
           C.PALETELASTRO as lastro,  
           C.PALETEALTURA as altura,  
           0 as sobra,  
           a.id as produto_id  
      from consinco.MLO_PRODESPENDERECO C,  
           wms.produto a,  
           wms.produto_embalagem b  
     where a.id = b.produto_id  
       and b.qtd_emb = c.qtdembalagem  
       and a.id = c.seqproduto  
       And c.NROEMPRESA = 1  
       and C.ESPECIEENDERECO in ('A','M','P','V')  
     order by 3,2;  
  end p_insert_produto_especie;  
   
  procedure p_insert_endereco_rua as 
  begin 
    insert into wms.ENDERECO_RUA 
    select null, codrua, 1, 0, 1 
      from consinco.mlo_rua; 
  end; 
    
  procedure p_insert_endereco as  
  begin  
  	insert into wms.endereco j (  
      id,   
      tipo_id,   
      especie_id,  
      rua,  
      predio,  
      apartamento,  
      sala,  
      pulmao,  
      terreo,  
      produto_id,  
      embalagem_id,  
      qtd_atual,  
      status,  
      expedicao,  
      TIPO_REPOSICAO,  
      tipo_especial,  
      gerar_reposicao,  
      virtual 
    )  
    select a.seqendereco,  
           max(c.ordemascend),  
           e.id especie_id,  
           codrua as rua,  
           nropredio as predio,  
           nroapartamento as apartamento,  
           nrosala as sala,  
           case when e.sigla = 'P' then 1 else 0 end as PULMAO,  
           decode(a.indterreoaereo, 'T', 1, 0) as TERREO,  
           a.seqproduto,  
           f.id,  
           case when a.qtdatual >= 0 then a.qtdatual else 0 end,  
           1,  
           case when e.sigla = 'P' or a.codrua in ('AV','998','996') then 0 else 1 end,  
           decode(A.TIPREPOSICAOEND, 'M','A','N','P','C','M'),  
           (select count(*)  
              from consinco.Mlo_Tipendperm b1  
             where b1.seqendereco = a.seqendereco  
               and b1.codtipendereco = 'S') as tipo_especial,  
           case  
             when a.codrua in ('990','995','996','997','998','999','AV') or  
                  e.sigla = 'P'  
               then 0  
               else 1  
           end,  
           case  
             when a.codrua in ('990','995','996','997','998','999','AV')  
               then 1  
               else 0  
           end 
      from consinco.mlo_endereco A  
     inner join consinco.Mlo_Tipendperm b  
        on a.seqendereco = b.seqendereco  
     inner join consinco.mlo_tipendereco c  
        on b.codtipendereco = c.codtipendereco  
     inner join consinco.mlo_especieendereco d  
        on d.especieendereco = a.especieendereco  
     inner join wms.endereco_especie e  
        on e.sigla = d.especieendereco  
      left join wms.produto_embalagem f  
        on f.qtd_emb = a.qtdembalagem  
       and f.produto_id = a.seqproduto  
     where b.codtipendereco not in ('S')  
       and a.statusendereco not in ('I','B')  
       and ((a.seqproduto is null and e.sigla = 'P') or  
            (a.seqproduto is not null))  
     group by a.seqendereco,  
           e.id,  
           e.sigla,  
           codrua,  
           nropredio,  
           nroapartamento,  
           nrosala,  
           a.indterreoaereo,  
           a.seqproduto,  
           a.qtdatual,  
           f.id,  
           a.seqpaleterf,  
           decode(A.TIPREPOSICAOEND, 'M','A','N','P','C','M')  
     order by 2, 3, 4, 5;  
  end p_insert_endereco;  
    
  procedure p_insert_endereco_armazenagem as  
  begin  
  	insert into wms.endereco_armazenagem (endereco_id, armazenagem_id)  
    select c.id, d.id as tip  
      from consinco.mlo_armazenperm a  
     inner join consinco.MLO_ATRIBUTOFIXO b  
        on a.tiparmazenagem = b.lista  
     inner join wms.endereco c  
        on c.id = a.seqendereco  
     inner join wms.TIPO_ARMAZENAGEM d  
        on d.nome = b.descricao  
     where b.TIPATRIBUTOFIXO = 'TIPARMAZ'  
     order by 1, 2;  
  end p_insert_endereco_armazenagem;  
    
  procedure p_insert_endereco_validade as  
  begin  
  	insert into wms.endereco_validade  
    select a.seqenderecoqtde, a.seqendereco, a.qtdatual, a.dtavalidade, a.dtarecebimento, 1  
      from CONSINCO.MLO_ENDERECOQTDE a  
     where exists (  
           select 1  
             from wms.endereco b  
            where a.seqendereco = b.id 
              and b.especie_id = 5 /*especie pulmao*/ 
     );  
  end p_insert_endereco_validade;  
    
  procedure p_insert_palete as  
  begin  
    insert into wms.palete(id, qtd, endereco_id, embalagem_id, carga_id, status) 
  	select a.seqpaleterf, 
           a.lastro*a.altura+a.sobra, 
           b.seqendereco, 
           c.id, 
           nvl(a.nrocargareceb, 0), 
           4 
      from consinco.mlo_palete a 
     inner join consinco.mlo_endereco b 
        on a.seqpaleterf = b.seqpaleterf 
     inner join wms.produto_embalagem c 
        on a.qtdembalagem = c.qtd_emb 
       and c.produto_id = a.seqproduto 
     order by 1; 
  end p_insert_palete;  
end pkg_wmsdev;  
----------------------------  
/
--------------------------------------------------------------------------------
--PACKAGE: WS_NOTIFY_API--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PACKAGE "WMS"."WS_NOTIFY_API" IS  
  --  
  -- API Package Spec for Node Notify Websocket REST Calls  
  --  
  
  --  
  -- Websocket REST Call defaults  
  --  
  g_ws_rest_host     VARCHAR2(50) := '192.168.1.20';  
  g_ws_rest_port     VARCHAR2(50) := '8005';  
  g_ws_rest_path     VARCHAR2(50) := '/notifyuser';  
  g_ws_rest_proto    VARCHAR2(50) := 'http'; -- http or https  
  g_ws_rest_base_url VARCHAR2(200) := ws_notify_api.g_ws_rest_proto ||  
                                      '://' || ws_notify_api.g_ws_rest_host || ':' ||  
                                      ws_notify_api.g_ws_rest_port ||  
                                      ws_notify_api.g_ws_rest_path;  
  -- security defaults  
  g_ws_basic_auth_user VARCHAR2(100) := '';  
  g_ws_basic_auth_pwd  VARCHAR2(100) := '';  
  -- wallet info: only if g_ws_rest_proto = https  
  g_ssl_wallet_path VARCHAR2(200) := 'file:/home/oracle/wallet'; -- set your local wallet path  
  g_ssl_wallet_pwd  VARCHAR2(100) := 'pwd'; -- set your wallet password  
  --  
  -- Exceptions Error Codes  
  --  
  error_http_status_code CONSTANT NUMBER := -20002;  
  --  
  -- Public Functions and Procedures  
  --  
  
  -- Send Websocket Notification over REST to connected users  
  -- #param i_userid  
  -- #param i_room ("private" or "public")  
  -- #param i_type (info, success, warn, error)  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_rest_notify_user(i_userid   IN VARCHAR2,  
                                i_room     IN VARCHAR2,  
                                i_type     IN VARCHAR2,  
                                i_title    IN VARCHAR2,  
                                i_message  IN VARCHAR2,  
                                i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Private / Type: Info  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_private_info(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Private / Type: Success  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_private_success(i_userid   IN VARCHAR2,  
                                           i_title    IN VARCHAR2,  
                                           i_message  IN VARCHAR2,  
                                           i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Private / Type: Warn  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_private_warn(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Private / Type: Error  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_private_error(i_userid   IN VARCHAR2,  
                                         i_title    IN VARCHAR2,  
                                         i_message  IN VARCHAR2,  
                                         i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Public / Type: Info  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_public_info(i_userid   IN VARCHAR2,  
                                       i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Public / Type: Success  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_public_success(i_userid   IN VARCHAR2,  
                                          i_title    IN VARCHAR2,  
                                          i_message  IN VARCHAR2,  
                                          i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Public / Type: Warn  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_public_warn(i_userid   IN VARCHAR2,  
                                       i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to User / Room: Public / Type: Error  
  -- #param i_userid  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_user_public_error(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to all Users / Room: Public / Type: Info  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_all_public_info(i_title    IN VARCHAR2,  
                                      i_message  IN VARCHAR2,  
                                      i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to all Users / Room: Public / Type: Success  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_all_public_success(i_title    IN VARCHAR2,  
                                         i_message  IN VARCHAR2,  
                                         i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to all Users / Room: Public / Type: Warn  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_all_public_warn(i_title    IN VARCHAR2,  
                                      i_message  IN VARCHAR2,  
                                      i_optparam IN VARCHAR2 := NULL);  
  --  
  -- Send Websocket Notification to all Users / Room: Public / Type: Error  
  -- #param i_title  
  -- #param i_message  
  -- #param i_optparam (Optional Parameter String)  
  PROCEDURE do_notify_all_public_error(i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL);  
END ws_notify_api;  
/
CREATE OR REPLACE EDITIONABLE PACKAGE BODY "WMS"."WS_NOTIFY_API" IS  
  --  
  -- API Package Body for Node Notify Websocket REST Calls  
  --  
  
  --  
  /****************************************************************************  
  * Purpose: Check Server response HTTP error (2XX Status codes)  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE check_error_http_status IS  
    --  
    l_status_code VARCHAR2(100);  
    l_name        VARCHAR2(200);  
    l_value       VARCHAR2(200);  
    l_error_msg   CLOB;  
    --  
  BEGIN  
    --  
    -- get http headers from response  
    FOR i IN 1 .. apex_web_service.g_headers.count LOOP  
      l_status_code := apex_web_service.g_status_code;  
      l_name        := apex_web_service.g_headers(i).name;  
      l_value       := apex_web_service.g_headers(i).value;  
      -- If not successful throw error  
      IF l_status_code NOT LIKE '2%' THEN  
        l_error_msg := 'Response HTTP Status NOT OK' || chr(10) || 'Name: ' ||  
                       l_name || chr(10) || 'Value: ' || l_value || chr(10) ||  
                       'Status Code: ' || l_status_code;  
        raise_application_error(error_http_status_code,  
                                l_error_msg);  
      END IF;  
    END LOOP;  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END check_error_http_status;  
  --  
  /****************************************************************************  
  * Purpose: Set HTTP headers for REST calls  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE set_http_headers(i_title   IN VARCHAR2,  
                             i_message IN VARCHAR2) IS  
    --  
    l_user_agent VARCHAR2(100);  
    l_server     ws_notify_api.g_ws_rest_host%TYPE;  
    --  
  BEGIN  
    -- Clients Envs  
    l_user_agent := 'Mozilla/5.0';  
    l_server     := ws_notify_api.g_ws_rest_host;  
    --  
    -- set http headers  
    -- Host  
    apex_web_service.g_request_headers(1).name := 'Host';  
    apex_web_service.g_request_headers(1).value := l_server;  
    -- User-Agent  
    apex_web_service.g_request_headers(2).name := 'User-Agent';  
    apex_web_service.g_request_headers(2).value := l_user_agent;  
    -- Title  
    apex_web_service.g_request_headers(3).name := 'notify-title';  
    apex_web_service.g_request_headers(3).value := i_title;  
    -- Message  
    apex_web_service.g_request_headers(4).name := 'notify-message';  
    apex_web_service.g_request_headers(4).value := i_message;  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END set_http_headers;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification over REST to connected users  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_rest_notify_user(i_userid   IN VARCHAR2,  
                                i_room     IN VARCHAR2,  
                                i_type     IN VARCHAR2,  
                                i_title    IN VARCHAR2,  
                                i_message  IN VARCHAR2,  
                                i_optparam IN VARCHAR2 := NULL) IS  
    --  
    l_response       CLOB;  
    l_url            VARCHAR2(200);  
    l_http_auth_user ws_notify_api.g_ws_basic_auth_user%TYPE;  
    l_http_auth_pwd  ws_notify_api.g_ws_basic_auth_pwd%TYPE;  
    l_param_name     VARCHAR2(400);  
    l_param_value    VARCHAR2(400);  
    l_title          VARCHAR2(1000);  
    l_message        VARCHAR2(4000);  
    l_spacer         VARCHAR2(10) := '||';  
    --  
  BEGIN  
    -- vars  
    l_http_auth_user := ws_notify_api.g_ws_basic_auth_user;  
    l_http_auth_pwd  := ws_notify_api.g_ws_basic_auth_pwd;  
    l_title          := REPLACE(REPLACE(substr(i_title,  
                                               1,  
                                               1000),  
                                        chr(10),  
                                        ' '),  
                                chr(13),  
                                ' ');  
    l_message        := REPLACE(REPLACE(substr(i_message,  
                                               1,  
                                               4000),  
                                        chr(10),  
                                        ' '),  
                                chr(13),  
                                ' ');  
    --  
    -- set HTTP Header (with title und message)  
    ws_notify_api.set_http_headers(i_title   => l_title,  
                                   i_message => l_message);  
    -- build request params  
    IF i_optparam IS NULL THEN  
      l_param_name  := 'userid' || l_spacer || 'room' || l_spacer || 'type';  
      l_param_value := lower(i_userid) || l_spacer || lower(i_room) ||  
                       l_spacer || lower(i_type);  
    ELSE  
      l_param_name  := 'userid' || l_spacer || 'room' || l_spacer || 'type' ||  
                       l_spacer || 'optparam';  
      l_param_value := lower(i_userid) || l_spacer || lower(i_room) ||  
                       l_spacer || lower(i_type) || l_spacer || i_optparam;  
    END IF;  
    -- URL  
    l_url := ws_notify_api.g_ws_rest_base_url;  
    -- REST call  
    -- HTTP  
    IF lower(ws_notify_api.g_ws_rest_proto) = 'http' THEN  
      l_response := apex_web_service.make_rest_request(p_url         => l_url,  
                                                       p_http_method => 'GET',  
                                                       p_username    => l_http_auth_user,  
                                                       p_password    => l_http_auth_pwd,  
                                                       p_parm_name   => apex_util.string_to_table(l_param_name,  
                                                                                                  l_spacer),  
                                                       p_parm_value  => apex_util.string_to_table(l_param_value,  
                                                                                                  l_spacer));  
      -- HTTPS  
    ELSIF lower(ws_notify_api.g_ws_rest_proto) = 'https' THEN  
      l_response := apex_web_service.make_rest_request(p_url         => l_url,  
                                                       p_http_method => 'GET',  
                                                       p_username    => l_http_auth_user,  
                                                       p_password    => l_http_auth_pwd,  
                                                       p_parm_name   => apex_util.string_to_table(l_param_name,  
                                                                                                  l_spacer),  
                                                       p_parm_value  => apex_util.string_to_table(l_param_value,  
                                                                                                  l_spacer),  
                                                       p_wallet_path => ws_notify_api.g_ssl_wallet_path,  
                                                       p_wallet_pwd  => ws_notify_api.g_ssl_wallet_pwd);  
    END IF;  
    --  
    -- check http status (2XX)  
    ws_notify_api.check_error_http_status;  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_rest_notify_user;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Private / Type: Info  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_private_info(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'private',  
                                      i_type     => 'info',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_private_info;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Private / Type: Success  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_private_success(i_userid   IN VARCHAR2,  
                                           i_title    IN VARCHAR2,  
                                           i_message  IN VARCHAR2,  
                                           i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'private',  
                                      i_type     => 'success',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_private_success;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Private / Type: Warn  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_private_warn(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'private',  
                                      i_type     => 'warn',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_private_warn;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Private / Type: Error  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_private_error(i_userid   IN VARCHAR2,  
                                         i_title    IN VARCHAR2,  
                                         i_message  IN VARCHAR2,  
                                         i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'private',  
                                      i_type     => 'error',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_private_error;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Public / Type: Info  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_public_info(i_userid   IN VARCHAR2,  
                                       i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'public',  
                                      i_type     => 'info',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_public_info;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Public / Type: Success  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_public_success(i_userid   IN VARCHAR2,  
                                          i_title    IN VARCHAR2,  
                                          i_message  IN VARCHAR2,  
                                          i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'public',  
                                      i_type     => 'success',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_public_success;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Public / Type: Warn  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_public_warn(i_userid   IN VARCHAR2,  
                                       i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'public',  
                                      i_type     => 'warn',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_public_warn;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to User / Room: Public / Type: Error  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_user_public_error(i_userid   IN VARCHAR2,  
                                        i_title    IN VARCHAR2,  
                                        i_message  IN VARCHAR2,  
                                        i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => i_userid,  
                                      i_room     => 'public',  
                                      i_type     => 'error',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_user_public_error;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to all Users / Room: Public / Type: Info  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_all_public_info(i_title    IN VARCHAR2,  
                                      i_message  IN VARCHAR2,  
                                      i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => 'all',  
                                      i_room     => 'public',  
                                      i_type     => 'info',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_all_public_info;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to all Users / Room: Public / Type: Success  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_all_public_success(i_title    IN VARCHAR2,  
                                         i_message  IN VARCHAR2,  
                                         i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => 'all',  
                                      i_room     => 'public',  
                                      i_type     => 'success',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_all_public_success;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to all Users / Room: Public / Type: Warn  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_all_public_warn(i_title    IN VARCHAR2,  
                                      i_message  IN VARCHAR2,  
                                      i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => 'all',  
                                      i_room     => 'public',  
                                      i_type     => 'warn',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_all_public_warn;  
  --  
  /****************************************************************************  
  * Purpose: Send Websocket Notification to all Users / Room: Public / Type: Error  
  * Author:  Daniel Hochleitner  
  * Created: 17.06.2016  
  * Changed:  
  ****************************************************************************/  
  PROCEDURE do_notify_all_public_error(i_title    IN VARCHAR2,  
                                       i_message  IN VARCHAR2,  
                                       i_optparam IN VARCHAR2 := NULL) IS  
    --  
  BEGIN  
    -- REST call  
    ws_notify_api.do_rest_notify_user(i_userid   => 'all',  
                                      i_room     => 'public',  
                                      i_type     => 'error',  
                                      i_title    => i_title,  
                                      i_message  => i_message,  
                                      i_optparam => i_optparam);  
    --  
  EXCEPTION  
    WHEN OTHERS THEN  
      -- Insert your own exception handling here  
      NULL;  
      RAISE;  
  END do_notify_all_public_error;  
  --  
END ws_notify_api;  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ATIVIDADE_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ATIVIDADE_ENDERECO" (i_carga_id in number) as
v_av varchar2(1);
v_exists number;
v_endereco_id number;
v_qtd_atual number;
begin
  for c1 in (
    select * from atividade
     where carga_id = i_carga_id
       and LS not in ('CA','FR')
  ) loop
    select ATACADOVAREJO
      into v_av
      from WMS.LINHADESEPARACAO
     where LS = c1.LS;
    if v_av = 'A' then
      select count(*)
        into v_exists
        from WMS.endereco
       where produto_id = c1.produto_id
         and especie_id = 1
      ;
      if v_exists = 0 then
        select min(id)
          into v_endereco_id
          from WMS.endereco
         where produto_id = c1.produto_id
           and especie_id = 2
        ;
      else
        select min(id)
          into v_endereco_id
          from WMS.endereco
         where produto_id = c1.produto_id
           and especie_id = 1
        ;
      end if;
    else
      select count(*)
        into v_exists
        from WMS.endereco
       where produto_id = c1.produto_id
         and especie_id = 2
      ;
      if v_exists = 0 then
        select min(id)
          into v_endereco_id
          from WMS.endereco
         where produto_id = c1.produto_id
           and especie_id = 1
        ;
      else
        select min(id)
          into v_endereco_id
          from WMS.endereco
         where produto_id = c1.produto_id
           and especie_id = 2
        ;
      end if;
    end if;
    update WMS.endereco
       set qtd_atual = qtd_atual - c1.qtd_pedido
     where id = v_endereco_id;
    select qtd_atual
      into v_qtd_atual
      from WMS.endereco
     where id = v_endereco_id;
    WMS.P_VERIFICAR_REPOSICAO(v_endereco_id);
  end loop;
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ATRIBUIR_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ATRIBUIR_ATIVIDADE" ( 
  i_carga IN NUMBER, 
  i_lote_id IN NUMBER, 
  i_user IN NUMBER, 
  i_tipo IN VARCHAR2, 
  i_codrua in VARCHAR2 default null 
) as 
v_new_atv number; 
v_lote number; 
v_idle_activity number; 
v_new_carga number; 
begin 
  select LOTE 
    into v_lote 
    from LOTE 
   where ID = i_lote_id; 
    
  if i_tipo = 'S' then 
    select count(*) 
      into v_new_carga 
      from CARGA 
     where ID = i_carga 
       and STATUS = 0 
    ; 
     
    if v_new_carga = 1 then 
      update CARGA 
         set STATUS = 1, 
             DATE_START = case when DATE_START is null then sysdate else DATE_START end 
       where ID = i_carga 
      ; 
    end if; 
 
    update LOTE 
       set SEP_ID = i_user, 
           SEP_START = case when SEP_START is null then sysdate else SEP_START end, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = v_lote 
    ;     
 
    update ATIVIDADE 
       set SEP_ID = i_user, 
           SEP_START = case when SEP_START is null then sysdate else SEP_START end, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = v_lote 
    ; 
  elsif i_tipo = 'C' then 
    select count(*) 
      into v_idle_activity 
      from LOTE 
     where CONF_ID = i_user 
       and CARGA_ID = i_carga 
       and LOTE = v_lote 
       and STATUS = 6 
    ; 
     
    if v_idle_activity = 0 then 
      update LOTE 
         set CONF_ID = i_user, 
             CONF_START = case when CONF_START is null then sysdate else CONF_START end, 
             STATUS = 3 
       where CARGA_ID = i_carga and LOTE = v_lote 
      ; 
 
      update ATIVIDADE 
         set CONF_ID = i_user, 
             CONF_START = case when CONF_START is null then sysdate else CONF_START end, 
             STATUS = 3 
       where CARGA_ID = i_carga and LOTE = v_lote 
      ; 
    else 
      update LOTE 
         set STATUS = 3 
       where CARGA_ID = i_carga and LOTE = v_lote 
      ; 
    end if; 
  elsif i_tipo = 'SF' then 
    select count(*) 
      into v_new_atv 
      from LOTE A 
     where CARGA_ID = i_carga and LOTE = v_lote 
       and STATUS = 0; 
     
    if v_new_atv > 0 then 
      update LOTE 
         set SEP_ID = 9, 
             SEP_START = case when SEP_START is null then sysdate else SEP_START end, 
             STATUS = 1 
       where CARGA_ID = i_carga and LOTE = v_lote 
      ; 
    end if; 
     
    update ATIVIDADE A 
       set SEP_ID = i_user, 
           SEP_START = case when SEP_START is null then sysdate else SEP_START end, 
           SEP_ENDERECO = i_codrua, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = v_lote 
       and A.PRODUTO_ID in ( 
           select B.PRODUTO_ID 
             from V_ESTACAO_SEP B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.CODRUA = i_codrua) 
    ; 
  end if; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ATUALIZAR_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ATUALIZAR_ENDERECO" (  
  i_qtd IN NUMBER,  
  i_produto_id IN NUMBER,  
  i_emb IN VARCHAR2,  
  i_qtd_emb IN NUMBER , 
  i_prioridade IN NUMBER 
) as  
  v_pulmao number;  
  v_endereco_id number;  
  v_new_qtd number;  
  v_tem_reposicao number;  
begin  
  P_ATUALIZAR_ENDERECO_INFO(  
    i_produto_id, i_emb, i_qtd_emb, i_qtd, v_endereco_id, v_pulmao, v_new_qtd  
  );  
  update ENDERECO  
     set QTD_ATUAL = v_new_qtd  
   where ID = v_endereco_id  
  ;  
  if v_new_qtd <= 0 and v_pulmao = 0 then  
    P_REPOSICAO_ENDERECO(v_endereco_id, i_prioridade);  
  end if;  
  commit;  
    
  EXCEPTION  
  when others then  
    insert into teste(c_vc)  
    values (i_qtd||' / '||i_produto_id||' / '||i_emb||'-'||i_qtd_emb);  
    commit;  
    raise_application_error(-20001,'An error was encountered - '||SQLCODE||' -ERROR- '||SQLERRM);  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ATUALIZAR_ENDERECO_INFO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ATUALIZAR_ENDERECO_INFO" (  
  i_produto_id IN NUMBER,  
  i_emb IN VARCHAR2,  
  i_qtd_emb IN NUMBER,  
  i_qtd IN NUMBER,  
  o_endereco_id OUT NUMBER,  
  o_pulmao OUT NUMBER,  
  o_new_qtd OUT NUMBER  
) as  
  v_tem_reposicao number;  
begin  
  select count(*)  
    into v_tem_reposicao  
    from ENDERECO A  
   where A.ID = (  
     select max(B.ID)  
       from ENDERECO B  
      inner join PRODUTO_EMBALAGEM C  
         on B.EMBALAGEM_ID = C.ID  
      where B.PRODUTO_ID = i_produto_id  
        and C.EMB = i_emb  
        and C.QTD_EMB = i_qtd_emb  
        and B.EXPEDICAO = 1  
   )  
  ;  
  select A.ID, A.PULMAO, A.QTD_ATUAL - i_qtd  
    into o_endereco_id, o_pulmao, o_new_qtd  
    from ENDERECO A  
   where A.ID = (  
     select max(B.ID)  
       from ENDERECO B  
      inner join PRODUTO_EMBALAGEM C  
         on B.EMBALAGEM_ID = C.ID  
      where B.PRODUTO_ID = i_produto_id  
        and B.EXPEDICAO = 1  
        and ((v_tem_reposicao > 0  
              and C.EMB = i_emb  
              and C.QTD_EMB = i_qtd_emb  
             ) or (v_tem_reposicao = 0))  
   )  
  ;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CANCELAR_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CANCELAR_ATIVIDADE" (i_user IN NUMBER) as 
begin 
  for c1 in ( 
    select * from PRODUTIVO 
     where ID = i_user 
  ) loop 
    if c1.ATIVIDADE = 'S' then 
      update ATIVIDADE 
         set STATUS = 0, SEP_START = null, SEP_ID = null 
       where SEP_ID = c1.ID 
         and STATUS = 1; 
      update LOTE 
         set STATUS = 0, SEP_START = null, SEP_ID = null 
       where SEP_ID = c1.ID 
         and STATUS = 1; 
    elsif c1.ATIVIDADE = 'C' then 
      update ATIVIDADE A 
         set STATUS = 2, CONF_START = null, CONF_ID = null 
       where CONF_ID = c1.ID 
         and STATUS = 3 
         and exists ( 
           select 1 
             from LOTE B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.STATUS = 3 
         ); 
      update LOTE 
         set STATUS = 2, CONF_START = null, CONF_ID = null 
       where CONF_ID = c1.ID 
         and STATUS = 3; 
    end if; 
  end loop; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CONF_AMOSTRAGEM--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CONF_AMOSTRAGEM" ( 
  i_carga IN NUMBER 
) as 
v_finish_carga number; 
begin 
  update LOTE 
     set STATUS = 4, 
         CONF_END = sysdate 
   where CARGA_ID = i_carga 
     and STATUS = 3 
     and LS in ('ME','MF','FR','CA')    
  ; 
  update ATIVIDADE A 
     set STATUS = 4, 
         CONF_END = sysdate, 
         CONF_QTD = case 
                      when (select count(*) from CORTE B 
                             where B.PRODUTO_ID = A.PRODUTO_ID 
                               and B.QTD_EMB = A.QTD_EMB 
                               and B.CARGA_ID = A.CARGA_ID 
                               and B.LOTE = A.LOTE) > 0 then 
                        CONF_QTD 
                      else 
                        QTD_PEDIDO 
                    end 
   where CARGA_ID = i_carga 
     and STATUS = 3 
     and LS in ('ME','MF','FR','CA') 
  ; 
  select count(*) 
    into v_finish_carga 
    from LOTE 
   where CARGA_ID = i_carga 
     and STATUS < 4 
  ; 
  if v_finish_carga = 0 then 
    consinco.P_WMS_FINISH_SEPC5(i_carga); 
    update CARGA 
       set STATUS = 2, 
           DATE_END = sysdate 
     where ID = i_carga 
    ; 
  end if; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CONF_PROX_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CONF_PROX_ATIVIDADE" ( 
  i_produtivo IN NUMBER, 
  o_carga OUT NUMBER, 
  o_lote OUT NUMBER 
) as 
  v_prioridade number; 
  v_exclusivo number; 
  v_box number; 
  v_idle_activity number; 
begin 
  --Verificar se existe uma ativade pausada que deve ser retomada 
  select count(*) 
    into v_idle_activity 
    from LOTE 
   where CONF_ID = i_produtivo 
     and STATUS = 6 
  ; 
   
  if v_idle_activity = 0 then 
    --Verificar se o produtivo  exclusivo 
    select EXCLUSIVO 
      into v_exclusivo 
      from PRODUTIVO 
     where ID = i_produtivo 
    ; 
    --htp.p('v_exclusivo: '||v_exclusivo); 
     
    --Verificar a prioridade para uma atividade de exclusividade 
    select min(A.PRIORIDADE) 
      into v_prioridade 
      from CARGA         A, 
           LOTE          B, 
           PRODUTIVO     C, 
           PRODUTIVO_BOX D 
     where A.ID = B.CARGA_ID 
       and C.ID = i_produtivo 
       and B.STATUS = 2 
       and D.PRODUTIVO_ID = C.ID 
       and D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
       and C.EXCLUSIVO = 1 
       and B.LS not in ('ME','FR','CA','MF') 
    ; 
    --htp.p('v_prioridade: '||nvl(v_prioridade,1)); 
    if v_prioridade is not null and v_exclusivo = 1 then 
      --htp.p('if'); 
      -- 
      select distinct ID 
        into o_carga 
        from (select distinct A.ID, RANK() OVER(order by F.DTAHORGERAPALETE) n, F.DTAHORGERAPALETE 
                     from CARGA         A, 
                          LOTE          B, 
                          PRODUTIVO     C, 
                          PRODUTIVO_BOX D, 
                          CONSINCO.MLO_CARGAEXPED F 
                    where A.ID = B.CARGA_ID 
                      and C.ID = i_produtivo 
                      and A.ID = F.NROCARGA 
                      and B.STATUS = 2 
                      and D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
                      and D.PRODUTIVO_ID = C.ID 
                      and A.PRIORIDADE = v_prioridade 
                      and B.LS not in ('ME','FR','CA','MF')) 
       where n = 1 
      ; 
      --htp.p('o_carga: '||nvl(o_carga,1)); 
      SELECT min(E.ID) INTO o_lote 
      FROM 
        (SELECT B.ID, 
                RANK() OVER( 
                            ORDER BY B.PESO DESC) N 
         FROM CARGA A, 
              LOTE B, 
              PRODUTIVO C, 
              PRODUTIVO_BOX D 
         WHERE A.ID = B.CARGA_ID 
           AND C.ID = i_produtivo 
           AND B.STATUS = 2 
           AND D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
           AND D.PRODUTIVO_ID = C.ID 
           AND A.ID = o_carga 
           AND B.LS not in ('ME', 
                            'FR', 
                            'CA', 
                            'MF')) E 
      WHERE E.N=1 
      ; 
    else 
      --htp.p('else'); 
      select min(A.PRIORIDADE) 
        into v_prioridade 
        from BOX A 
       where exists ( 
         select 1 
           from CARGA B, 
                LOTE C 
          where A.ID = TO_NUMBER(SUBSTR(TO_CHAR(B.BOX_ID), 1, LENGTH(TO_CHAR(B.BOX_ID))-1)) 
            and C.CARGA_ID = B.ID 
            and C.STATUS = 2 
            and C.LS not in ('ME','FR','CA','MF') 
       ) 
      ; 
      --htp.p('v_box: '||v_prioridade); 
      select min(ID) 
        into v_box  
        from BOX A 
       where PRIORIDADE = v_prioridade 
         and exists ( 
           select 1 
             from CARGA B, 
                  LOTE C 
            where A.ID = TO_NUMBER(SUBSTR(TO_CHAR(B.BOX_ID), 1, LENGTH(TO_CHAR(B.BOX_ID))-1)) 
              and C.CARGA_ID = B.ID 
              and C.STATUS = 2 
              and C.LS not in ('ME','FR','CA','MF') 
         ); 
 
      --htp.p('v_box: '||v_box); 
      select distinct ID 
        into o_carga 
        from (select distinct 
                     A.ID, 
                     RANK() OVER(order by A.PRIORIDADE, F.DTAHORGERAPALETE) n, 
                     F.DTAHORGERAPALETE 
                from CARGA         A, 
                     LOTE          B, 
                     CONSINCO.MLO_CARGAEXPED F 
               where A.ID = B.CARGA_ID 
                 and A.ID = F.NROCARGA 
                 and B.STATUS = 2 
                 and TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) = v_box 
                 and B.LS not in ('ME','FR','CA','MF')) 
       where n = 1 
      ; 
      --htp.p('o_carga: '||o_carga); 
      /* 
      select min(A.ID) 
        into o_carga 
        from CARGA A, 
             LOTE  B, 
             BOX   C 
       where A.ID = B.CARGA_ID 
         and B.STATUS = 2 
         and B.LS not in ('ME','FR','CA','MF') 
         and C.ID = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
         and C.PRIORIDADE = v_prioridade 
      ; 
      --htp.p();*/ 
      SELECT min(E.ID) 
        INTO o_lote 
        FROM (SELECT B.ID, 
                     RANK() OVER(ORDER BY B.PESO DESC) N 
                FROM CARGA A, 
                     LOTE B 
               WHERE A.ID = B.CARGA_ID 
                 AND B.STATUS = 2 
                 AND B.LS not in ('ME','FR','CA','MF') 
                 AND A.ID = o_carga) E 
        WHERE E.N = 1 
      ; 
      --htp.p('o_lote: '||o_lote); 
    end if; 
    o_carga := nvl(o_carga, 0); 
    o_lote := nvl(o_lote, 0); 
    select count(*) 
      into v_idle_activity 
      from LOTE 
     where CONF_ID = i_produtivo 
       and STATUS = 5 
    ; 
     
    if v_idle_activity = 1 then 
      update LOTE 
         set STATUS = 6 
       where CONF_ID = i_produtivo 
         and STATUS = 5 
      ; 
    end if; 
     
  else 
    select CARGA_ID, ID 
      into o_carga, o_lote 
      from LOTE 
     where CONF_ID = i_produtivo 
       and STATUS = 6 
    ; 
  end if; 
  exception 
    when NO_DATA_FOUND 
      then o_carga := nvl(o_carga, 0); 
           o_lote := nvl(o_lote, 0); 
            
  --htp.p('Carga: ' || o_carga); 
  --htp.p('Lote: ' || o_lote); 
  --htp.p('Prioridade: ' || v_prioridade); 
  --htp.p('Exclusivo: ' || v_exclusivo); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CONF_PROX_ATIVIDADE_DEV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CONF_PROX_ATIVIDADE_DEV" ( 
  i_produtivo IN NUMBER, 
  o_carga OUT NUMBER, 
  o_lote OUT NUMBER 
) as 
  v_prioridade number; 
  v_exclusivo number; 
  v_box number; 
  v_idle_activity number; 
begin 
  --Verificar se existe uma ativade pausada que deve ser retomada 
  select count(*) 
    into v_idle_activity 
    from LOTE 
   where CONF_ID = i_produtivo 
     and STATUS = 6 
  ; 
   
  if v_idle_activity = 0 then 
    --Verificar se o produtivo  exclusivo 
    select EXCLUSIVO 
      into v_exclusivo 
      from PRODUTIVO 
     where ID = i_produtivo 
    ; 
    --htp.p('v_exclusivo: '||v_exclusivo); 
     
    --Verificar a prioridade para uma atividade de exclusividade 
    select min(A.PRIORIDADE) 
      into v_prioridade 
      from CARGA         A, 
           LOTE          B, 
           PRODUTIVO     C, 
           PRODUTIVO_BOX D 
     where A.ID = B.CARGA_ID 
       and C.ID = i_produtivo 
       and B.STATUS = 2 
       and D.PRODUTIVO_ID = C.ID 
       and D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
       and C.EXCLUSIVO = 1 
       and B.LS not in ('ME','FR','CA','MF') 
    ; 
    --htp.p('v_prioridade: '||nvl(v_prioridade,1)); 
    if v_prioridade is not null and v_exclusivo = 1 then 
      --htp.p('if'); 
      -- 
      select distinct ID 
        into o_carga 
        from (select distinct A.ID, RANK() OVER(order by F.DTAHORGERAPALETE) n, F.DTAHORGERAPALETE 
                     from CARGA         A, 
                          LOTE          B, 
                          PRODUTIVO     C, 
                          PRODUTIVO_BOX D, 
                          CONSINCO.MLO_CARGAEXPED F 
                    where A.ID = B.CARGA_ID 
                      and C.ID = i_produtivo 
                      and A.ID = F.NROCARGA 
                      and B.STATUS = 2 
                      and D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
                      and D.PRODUTIVO_ID = C.ID 
                      and A.PRIORIDADE = v_prioridade 
                      and B.LS not in ('ME','FR','CA','MF')) 
       where n = 1 
      ; 
      --htp.p('o_carga: '||nvl(o_carga,1)); 
      SELECT min(E.ID) INTO o_lote 
      FROM 
        (SELECT B.ID, 
                RANK() OVER( 
                            ORDER BY B.PESO DESC) N 
         FROM CARGA A, 
              LOTE B, 
              PRODUTIVO C, 
              PRODUTIVO_BOX D 
         WHERE A.ID = B.CARGA_ID 
           AND C.ID = i_produtivo 
           AND B.STATUS = 2 
           AND D.BOX = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
           AND D.PRODUTIVO_ID = C.ID 
           AND A.ID = o_carga 
           AND B.LS not in ('ME', 
                            'FR', 
                            'CA', 
                            'MF')) E 
      WHERE E.N=1 
      ; 
    else 
      --htp.p('else'); 
      select min(A.PRIORIDADE) 
        into v_prioridade 
        from BOX A 
       where exists ( 
         select 1 
           from CARGA B, 
                LOTE C 
          where A.ID = TO_NUMBER(SUBSTR(TO_CHAR(B.BOX_ID), 1, LENGTH(TO_CHAR(B.BOX_ID))-1)) 
            and C.CARGA_ID = B.ID 
            and C.STATUS = 2 
            and C.LS not in ('ME','FR','CA','MF') 
       ) 
      ; 
      --htp.p('v_box: '||v_prioridade); 
      select min(ID) 
        into v_box  
        from BOX A 
       where PRIORIDADE = v_prioridade 
         and exists ( 
           select 1 
             from CARGA B, 
                  LOTE C 
            where A.ID = TO_NUMBER(SUBSTR(TO_CHAR(B.BOX_ID), 1, LENGTH(TO_CHAR(B.BOX_ID))-1)) 
              and C.CARGA_ID = B.ID 
              and C.STATUS = 2 
              and C.LS not in ('ME','FR','CA','MF') 
         ); 
 
      --htp.p('v_box: '||v_box); 
      select distinct ID 
        into o_carga 
        from (select distinct 
                     A.ID, 
                     RANK() OVER(order by A.PRIORIDADE, F.DTAHORGERAPALETE) n, 
                     F.DTAHORGERAPALETE 
                from CARGA         A, 
                     LOTE          B, 
                     CONSINCO.MLO_CARGAEXPED F 
               where A.ID = B.CARGA_ID 
                 and A.ID = F.NROCARGA 
                 and B.STATUS = 2 
                 and TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) = v_box 
                 and B.LS not in ('ME','FR','CA','MF')) 
       where n = 1 
      ; 
      --htp.p('o_carga: '||o_carga); 
      /* 
      select min(A.ID) 
        into o_carga 
        from CARGA A, 
             LOTE  B, 
             BOX   C 
       where A.ID = B.CARGA_ID 
         and B.STATUS = 2 
         and B.LS not in ('ME','FR','CA','MF') 
         and C.ID = TO_NUMBER(SUBSTR(TO_CHAR(A.BOX_ID), 1, LENGTH(TO_CHAR(A.BOX_ID))-1)) 
         and C.PRIORIDADE = v_prioridade 
      ; 
      --htp.p();*/ 
      SELECT min(E.ID) 
        INTO o_lote 
        FROM (SELECT B.ID, 
                     RANK() OVER(ORDER BY B.PESO DESC) N 
                FROM CARGA A, 
                     LOTE B 
               WHERE A.ID = B.CARGA_ID 
                 AND B.STATUS = 2 
                 AND B.LS not in ('ME','FR','CA','MF') 
                 AND A.ID = o_carga) E 
        WHERE E.N = 1 
      ; 
      --htp.p('o_lote: '||o_lote); 
    end if; 
    o_carga := nvl(o_carga, 0); 
    o_lote := nvl(o_lote, 0); 
    select count(*) 
      into v_idle_activity 
      from LOTE 
     where CONF_ID = i_produtivo 
       and STATUS = 5 
    ; 
     
    if v_idle_activity = 1 then 
      update LOTE 
         set STATUS = 6 
       where CONF_ID = i_produtivo 
         and STATUS = 5 
      ; 
    end if; 
     
  else 
    select CARGA_ID, LOTE 
      into o_carga, o_lote 
      from LOTE 
     where CONF_ID = i_produtivo 
       and STATUS = 6 
    ; 
  end if; 
  exception 
    when NO_DATA_FOUND 
      then o_carga := nvl(o_carga, 0); 
           o_lote := nvl(o_lote, 0); 
            
  --htp.p('Carga: ' || o_carga); 
  --htp.p('Lote: ' || o_lote); 
  --htp.p('Prioridade: ' || v_prioridade); 
  --htp.p('Exclusivo: ' || v_exclusivo); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CONF_SAVE_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CONF_SAVE_ATIVIDADE" ( 
  i_carga in number, 
  i_lote in number, 
  i_produto in number, 
  i_qtdemb in number, 
  i_qtd in number 
) as 
begin 
  update ATIVIDADE A 
     set A.CONF_QTD = nvl(CONF_QTD,0) + i_qtd, 
         A.CONF_END = sysdate, 
         A.STATUS = 4 
   where A.CARGA_ID = i_carga 
     and A.LOTE  = i_lote 
     and A.PRODUTO_ID = i_produto 
     and A.QTD_EMB = i_qtdemb; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_CORTE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_CORTE" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_produto_id IN NUMBER, 
  i_user IN NUMBER, 
  i_conf IN VARCHAR2, 
  i_ped IN VARCHAR2, 
  i_pessoa IN NUMBER default 0, 
  i_qtdemb IN NUMBER, 
  i_mesa_user IN VARCHAR2 default null 
) as 
begin 
  insert into CORTE ( 
    CARGA_ID, 
    LOTE, 
    PRODUTO_ID, 
    CONF_ID, 
    CONF_QTD, 
    QTD_PEDIDO, 
    DONE, 
    PESSOA_ID, 
    QTD_EMB, 
    CREATED_BY 
  ) 
  values  ( 
    i_carga, 
    i_lote, 
    i_produto_id, 
    i_user, 
    i_conf, 
    i_ped, 
    0, 
    i_pessoa, 
    i_qtdemb, 
    i_mesa_user 
  ); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_DEV_CLEAR--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_DEV_CLEAR" (i_carga IN NUMBER) as 
begin 
  delete from ATIVIDADE 
   where (CARGA_ID = i_carga or i_carga =0); 
 
  delete from LOTE 
   where (CARGA_ID = i_carga or i_carga =0); 
 
  delete from CARGA 
   where (ID = i_carga or i_carga =0); 
 
  delete from CARGA_IMPORT 
   where (ID = i_carga or i_carga =0); 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ENDERECO_MOVIMENTACAO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ENDERECO_MOVIMENTACAO" ( 
  i_id IN NUMBER, 
  io_qtd IN OUT NUMBER, 
  i_prioridade IN NUMBER 
) as  
  v_especie_id number;  
  v_produto_id number;  
  v_endereco_mov number;  
  v_tipo_movimento varchar2(1); 
  v_destino_terreo number; 
begin  
  select especie_id, produto_id  
    into v_especie_id, v_produto_id  
    from endereco A  
   where id = i_id  
  ;  
  for c1 in (  
    select DISTINCT A.ID, A.QTD_ATUAL, B.DATA_VALIDADE, C.EMB, C.QTD_EMB, A.TERREO 
      from ENDERECO A  
     inner join ENDERECO_VALIDADE B  
        on B.ENDERECO_ID = A.ID  
     inner join PRODUTO_EMBALAGEM C  
        on C.ID = A.EMBALAGEM_ID  
     where A.PRODUTO_ID = v_produto_id  
       and ESPECIE_ID = case when v_especie_id = 2 then 1 else 5 end  
     order by A.QTD_ATUAL, B.DATA_VALIDADE  
  ) loop  
    select A.terreo 
      into v_destino_terreo 
      from endereco A 
     where id = i_id; 
      
    if c1.terreo = 0 and v_destino_terreo = 1 then 
      v_tipo_movimento := 'D'; 
    elsif c1.terreo = 1 and v_destino_terreo = 0 then 
      v_tipo_movimento := 'A'; 
    elsif c1.terreo = 1 and v_destino_terreo = 1 then 
      v_tipo_movimento := 'R'; 
    end if; 
    if c1.qtd_atual >= io_qtd then  
      insert into movimentacao (tipo, origem_id, destino_id, qtd, emb, qtd_emb, status, prioridade)  
      values (v_tipo_movimento, c1.id, i_id, io_qtd, c1.emb, c1.qtd_emb, 0, i_prioridade)  
      ;  
      update endereco  
         set qtd_atual = qtd_atual - io_qtd  
       where id = c1.id  
      ;  
      io_qtd := 0;  
      EXIT;  
    else  
      insert into movimentacao (tipo, origem_id, destino_id, qtd, emb, qtd_emb, status, prioridade)  
      values (v_tipo_movimento, c1.id, i_id, c1.qtd_atual, c1.emb, c1.qtd_emb, 0, i_prioridade)  
      ;  
      update endereco  
         set qtd_atual = 0  
       where id = c1.id  
      ;  
      io_qtd := io_qtd - c1.qtd_atual;  
    end if;  
  end loop;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ERRO_SEPARACAO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ERRO_SEPARACAO" ( 
  i_atividade_id IN NUMBER, 
  i_qtderro IN NUMBER, 
  i_nao_criar_alerta IN NUMBER default null --null para criar alerta 
) as 
  v_exists number; 
  v_box number; 
  v_err_seq number; 
  v_err_seq_alert number; 
  v_local varchar2(100); 
  v_sep_id number; 
begin 
  select count(*) 
    into v_exists 
    from ERRO_SEPARACAO A 
   where A.ATIVIDADE_ID = i_atividade_id 
  ; 
   
  if v_exists = 0 then 
    v_err_seq := ERRO_SEPARACAO_SEQ.nextval; 
     
    insert into ERRO_SEPARACAO( 
      ID, 
      ATIVIDADE_ID, 
      QTD_ERRO 
    ) values( 
      v_err_seq, 
      i_atividade_id, 
      i_qtderro 
    ); 
  else 
    select max(ID) 
      into v_err_seq 
      from ERRO_SEPARACAO A 
     where ATIVIDADE_ID = i_atividade_id 
    ; 
  end if; 
   
  if i_nao_criar_alerta is null then 
    select distinct BOX_ID 
      into v_box 
      from CARGA J 
     inner join ATIVIDADE K 
        on J.ID = K.CARGA_ID 
     where K.ID = i_atividade_id 
    ; 
 
    select SEP_ENDERECO, SEP_ID 
      into v_local, v_sep_id 
      from ATIVIDADE 
     where ID = i_atividade_id 
    ; 
 
    update ERRO_SEPARACAO_ALERTA 
       set DONE_PUBLICO = 1, 
           DONE_PRIVADO = 1, 
           DONE_ADMIN = 1 
     where ERRO_SEPARACAO_ID = v_err_seq 
    ; 
 
    v_err_seq_alert := ERRO_SEPARACAO_ALERTA_SEQ.nextval; 
 
    insert into ERRO_SEPARACAO_ALERTA ( 
      ID, 
      ERRO_SEPARACAO_ID, 
      BOX_ID, 
      LOCAL, 
      DONE_PUBLICO, 
      DONE_PRIVADO, 
      DONE_ADMIN 
    ) values ( 
      v_err_seq_alert, 
      v_err_seq, 
      v_box, 
      v_local, 
      0, 
      0, 
      0 
    ); 
    ws_notify_api.do_rest_notify_user( 
      i_userid   => to_char(v_sep_id), 
      i_room     => 'private', 
      i_type     => 'error', 
      i_title    => 'My test title', 
      i_message  => to_char(v_err_seq_alert) 
    ); 
  end if; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ERRO_SEPARADOR--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ERRO_SEPARADOR" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_produto IN NUMBER, 
  i_qtderro IN NUMBER, 
  i_embalagem IN VARCHAR2, 
  i_qtdembalagem IN NUMBER, 
  i_sep in NUMBER, 
  i_sep_nome IN VARCHAR2, 
  i_conf in NUMBER 
) as 
  v_cont number; 
  v_conf varchar2(100); 
  v_box number; 
  v_err_seq number; 
begin 
  select count(*) 
    into v_cont 
    from APEX.TB_CDA_ERRO_SEP 
   where ERR_CARGA = i_carga 
     and ERR_LOTE = i_lote 
     and ERR_SEQPRODUTO = i_produto 
     and ERR_EMBALAGEM = i_embalagem 
     and ERR_QTDEMBALAGEM = i_qtdembalagem 
  ; 
   
  if v_cont = 0 then 
    execute immediate 'select apex.TB_CDA_ERRO_SEP_SEQ.Nextval from dual' into v_err_seq; 
     
    insert into APEX.TB_CDA_ERRO_SEP( 
      ERR_CODE, 
      ERR_CODPRODUTIVO, 
      ERR_DATA, 
      ERR_SEQPRODUTO, 
      ERR_QTD, 
      ERR_CARGA, 
      ERR_LOTE, 
      ERR_SEPARADOR, 
      ERR_EMBALAGEM, 
      ERR_QTDEMBALAGEM 
    ) values ( 
      v_err_seq, 
      i_conf, 
      sysdate, 
      i_produto, 
      i_qtderro, 
      i_carga, 
      i_lote, 
      i_sep, 
      i_embalagem, 
      i_qtdembalagem 
    ); 
  else 
    select ERR_CODE 
      into v_err_seq 
      from APEX.TB_CDA_ERRO_SEP 
     where ERR_CARGA = i_carga 
       and ERR_LOTE = i_lote 
       and ERR_SEQPRODUTO = i_produto 
     and ERR_EMBALAGEM = i_embalagem 
     and ERR_QTDEMBALAGEM = i_qtdembalagem 
    ;  
  end if; 
   
  select BOX_ID 
    into v_box 
    from CARGA J 
   where J.ID = i_carga; 
 
  select APELIDO 
    into v_conf 
    from PRODUTIVO 
   where ID = i_conf; 
 
  insert into APEX.TB_WMS_CHAMAR_SEP ( 
    WCS_CONF, 
    WCS_SEP, 
    WCS_BOX, 
    DONE, 
    DONE_PROD, 
    DTAINCLUSAO, 
    CARGA, 
    LOTE, 
    CODPRODUTIVO, 
    ERR_CODE 
  ) values ( 
    v_conf, 
    i_sep_nome, 
    v_box, 
    0, 
    0, 
    sysdate, 
    i_carga, 
    i_lote, 
    i_sep, 
    v_err_seq 
  ); 
  ws_notify_api.do_rest_notify_user( 
    i_userid   => to_char(i_sep), 
    i_room     => 'private', 
    i_type     => 'error', 
    i_title    => 'My test title', 
    i_message  => 'My test message content...' 
  ); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_ERRO_SEPARADOR_DEV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_ERRO_SEPARADOR_DEV" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_produto IN NUMBER, 
  i_qtderro IN NUMBER, 
  i_embalagem IN VARCHAR2, 
  i_qtdembalagem IN NUMBER, 
  i_sep in NUMBER, 
  i_sep_nome IN VARCHAR2, 
  i_conf in NUMBER 
) as 
  v_cont number; 
  v_conf varchar2(100); 
  v_box number; 
  v_err_seq number; 
begin 
  select count(*) 
    into v_cont 
    from APEX.TB_CDA_ERRO_SEP 
   where ERR_CARGA = i_carga 
     and ERR_LOTE = i_lote 
     and ERR_SEQPRODUTO = i_produto 
     and ERR_EMBALAGEM = i_embalagem 
     and ERR_QTDEMBALAGEM = i_qtdembalagem 
  ; 
   
  if v_cont = 0 then 
    execute immediate 'select apex.TB_CDA_ERRO_SEP_SEQ.Nextval from dual' into v_err_seq; 
     
    insert into APEX.TB_CDA_ERRO_SEP( 
      ERR_CODE, 
      ERR_CODPRODUTIVO, 
      ERR_DATA, 
      ERR_SEQPRODUTO, 
      ERR_QTD, 
      ERR_CARGA, 
      ERR_LOTE, 
      ERR_SEPARADOR, 
      ERR_EMBALAGEM, 
      ERR_QTDEMBALAGEM 
    ) values ( 
      v_err_seq, 
      i_conf, 
      sysdate, 
      i_produto, 
      i_qtderro, 
      i_carga, 
      i_lote, 
      i_sep, 
      i_embalagem, 
      i_qtdembalagem 
    ); 
  else 
    select ERR_CODE 
      into v_err_seq 
      from APEX.TB_CDA_ERRO_SEP 
     where ERR_CARGA = i_carga 
       and ERR_LOTE = i_lote 
       and ERR_SEQPRODUTO = i_produto 
     and ERR_EMBALAGEM = i_embalagem 
     and ERR_QTDEMBALAGEM = i_qtdembalagem 
    ;  
  end if; 
   
  select BOX_ID 
    into v_box 
    from CARGA J 
   where J.ID = i_carga; 
 
  select APELIDO 
    into v_conf 
    from PRODUTIVO 
   where ID = i_conf; 
 
  insert into APEX.TB_WMS_CHAMAR_SEP ( 
    WCS_CONF, 
    WCS_SEP, 
    WCS_BOX, 
    DONE, 
    DONE_PROD, 
    DTAINCLUSAO, 
    CARGA, 
    LOTE, 
    CODPRODUTIVO, 
    ERR_CODE 
  ) values ( 
    v_conf, 
    i_sep_nome, 
    v_box, 
    0, 
    0, 
    sysdate, 
    i_carga, 
    i_lote, 
    i_sep, 
    v_err_seq 
  ); 
  ws_notify_api.do_rest_notify_user( 
    i_userid   => to_char(i_sep), 
    i_room     => 'private', 
    i_type     => 'error', 
    i_title    => 'My test title', 
    i_message  => 'My test message content...' 
  ); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_FINALIZAR_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_FINALIZAR_ATIVIDADE" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_tipo IN VARCHAR2, 
  i_codrua in VARCHAR2 default null 
) as 
v_count number; 
v_finish_carga number; 
v_finish number; 
begin 
  if i_tipo = 'S' then 
    update LOTE 
       set SEP_END = sysdate, 
           STATUS = 2 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
 
    update ATIVIDADE 
       set SEP_END = sysdate, 
           STATUS = 2, 
           SEP_QTD = QTD_PEDIDO 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
  elsif i_tipo = 'C' then 
    update LOTE 
       set CONF_END = sysdate, 
           STATUS = 4 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
    select count(*) 
      into v_finish_carga 
      from LOTE 
     where CARGA_ID = i_carga 
       and STATUS < 4 
    ; 
    if v_finish_carga = 0 then 
      consinco.P_WMS_FINISH_SEPC5(i_carga); 
      update CARGA 
         set STATUS = 2, 
             DATE_END = sysdate 
       where ID = i_carga 
      ; 
    end if; 
  elsif i_tipo = 'SF' then 
    update ATIVIDADE A 
       set SEP_END = sysdate, 
           SEP_QTD = QTD_PEDIDO, 
           STATUS = 2 
     where A.CARGA_ID = i_carga 
       and A.LOTE = i_lote 
       and A.PRODUTO_ID in ( 
           select B.PRODUTO_ID 
             from V_ESTACAO_SEP B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.CODRUA = i_codrua) 
    ; 
    /* --NO DESCOMENTAR AT FINALIZAR A IMPLEMENTAO 
    --DA CONFERENCIA POR AMOSTRAGEM 
    update LOTE 
       set CONF_START = sysdate, 
           STATUS = 3 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and LS in ('ME','MF','FR','CA') 
    ;     
 
    update ATIVIDADE 
       set CONF_START = sysdate, 
           STATUS = 3 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and LS in ('ME','MF','FR','CA') 
    ;*/ 
    commit; 
    select count(*) 
      into v_count 
      from V_ESTACAO_SEP 
     where CARGA_ID = i_carga 
       and LOTE = i_lote 
       and STATUS < 2 
    ; 
    if v_count = 0 then 
      update LOTE 
         set SEP_END = sysdate, 
             STATUS = 2 
       where CARGA_ID = i_carga and LOTE = i_lote 
      ; 
    end if; 
  end if; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_FINALIZAR_ATIVIDADE_DEV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_FINALIZAR_ATIVIDADE_DEV" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_tipo IN VARCHAR2, 
  i_produtivo IN NUMBER, 
  i_codrua IN VARCHAR2 default null 
) as 
v_count number; 
v_finish_carga number; 
v_finish number; 
v_inativo number; 
begin 
  if i_tipo = 'S' then 
    update LOTE 
       set SEP_END = sysdate, 
           STATUS = 2 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ;     
 
    update ATIVIDADE 
       set SEP_END = sysdate, 
           STATUS = 2, 
           SEP_QTD = QTD_PEDIDO 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
    --INICIO Processo de conferencia por amostragem--*************************** 
    update LOTE 
       set CONF_START = sysdate, 
           STATUS = 3, 
           CONF_ID = 9 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and LS in ('ME','MF','FR','CA') 
    ; 
 
    update ATIVIDADE 
       set CONF_START = sysdate, 
           STATUS = 3, 
           CONF_ID = 9 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and LS in ('ME','MF','FR','CA') 
    ; 
    --FIM Processo de conferencia por amostragem--****************************** 
  elsif i_tipo = 'C' then 
    update LOTE 
       set CONF_END = sysdate, 
           STATUS = 4 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
    select count(*) 
      into v_finish_carga 
      from LOTE 
     where CARGA_ID = i_carga 
       and STATUS != 4 
    ; 
    if v_finish_carga = 0 then 
      consinco.P_WMS_FINISH_SEPC5(i_carga); 
      update CARGA 
         set STATUS = 2, 
             DATE_END = sysdate 
       where ID = i_carga 
      ; 
    end if; 
  elsif i_tipo = 'SF' then 
    update ATIVIDADE A 
       set SEP_END = sysdate, 
           SEP_QTD = QTD_PEDIDO, 
           STATUS = 2 
     where A.CARGA_ID = i_carga 
       and A.LOTE = i_lote 
       and A.PRODUTO_ID in ( 
           select B.PRODUTO_ID 
             from V_ESTACAO_SEP B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.CODRUA = i_codrua) 
    ; 
    commit; 
    select count(*) 
      into v_count 
      from V_ESTACAO_SEP 
     where CARGA_ID = i_carga 
       and LOTE = i_lote 
       and STATUS < 2 
    ; 
    if v_count = 0 then 
      update LOTE 
         set SEP_END = sysdate, 
             STATUS = 2 
       where CARGA_ID = i_carga and LOTE = i_lote 
      ; 
      --INICIO Processo de conferencia por amostragem--************************* 
      update LOTE 
         set CONF_START = sysdate, 
             STATUS = 3, 
             CONF_ID = 9 
       where CARGA_ID = i_carga and LOTE = i_lote 
         and LS in ('ME','MF','FR','CA') 
      ;     
 
      update ATIVIDADE 
         set CONF_START = sysdate, 
             STATUS = 3, 
             CONF_ID = 9 
       where CARGA_ID = i_carga and LOTE = i_lote 
         and LS in ('ME','MF','FR','CA') 
      ; 
      --FIM Processo de conferencia por amostragem--**************************** 
    end if; 
  end if; 
  commit; 
   
  select count(*) 
    into v_inativo 
    from PRODUTIVO A 
   where STATUS = 0 
     and ID = i_produtivo 
  ; 
     
  if v_inativo = 1 then 
    ws_notify_api.do_rest_notify_user( 
      i_userid   => to_char(i_produtivo), 
      i_room     => 'private', 
      i_type     => 'warn', 
      i_title    => 'My test title', 
      i_message  => 'My test message content...' 
    ); 
  end if; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_FINALIZAR_MOVIMENTACAO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_FINALIZAR_MOVIMENTACAO" (i_mov_id number, i_produtivo number) as
  v_tipo_produtivo varchar2(1);
begin
  select ATIVIDADE
    into v_tipo_produtivo
    from PRODUTIVO
   where ID = i_produtivo;
  if v_tipo_produtivo = 'A' then
    update wms.movimentacao
       set abast_end = sysdate,
           status = case when tipo in ('R','E') then 2 else 4 end
     where id = i_mov_id;
  else
    update wms.movimentacao
       set emp_end = sysdate,
           status = case when tipo in ('A','R','E') then 4 else 2 end
     where id = i_mov_id;
  end if;
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_FINISH_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_FINISH_ATIVIDADE" ( --LEGACY 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_user IN NUMBER, 
  i_tipo IN VARCHAR2, 
  i_codrua in VARCHAR2 default null 
) as 
v_count number; 
begin 
  if i_tipo = 'SF' then 
    update ATIVIDADE A 
       set SEP_END = sysdate, 
           SEP_QTD = QTD_PEDIDO, 
           STATUS = 2 
     where A.CARGA_ID = i_carga 
       and A.LOTE = i_lote 
       and A.PRODUTO_ID in ( 
           select B.PRODUTO_ID 
             from V_ESTACAO_SEP B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.CODRUA = i_codrua) 
    ; 
    commit; 
   
    select count(*) 
      into v_count 
      from V_ESTACAO_SEP 
     where CARGA_ID = i_carga 
       and LOTE = i_lote 
       and STATUS < 2; 
     
    if v_count = 0 then 
      update LOTE 
         set SEP_END = sysdate, 
             STATUS = 2 
       where CARGA_ID = i_carga and LOTE = i_lote 
      ; 
    end if; 
  end if; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_MOVIMENTACAO_VISUAL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_MOVIMENTACAO_VISUAL" (
  i_origem_id in number,
  i_destino_id in number,
  i_qtd in number,
  i_tipo in varchar2,
  i_emb_id in number,
  i_user in varchar2
) as
  v_qtd_emb number;
  v_emb varchar2(3);
  v_next_id number;
  v_palete_id number;
begin
  select min(id)
    into v_palete_id
    from palete
   where endereco_id = i_origem_id;

  select movimentacao_seq.nextval
    into v_next_id
    from dual;
    
  select emb, qtd_emb
    into v_emb, v_qtd_emb
    from produto_embalagem
   where id = i_emb_id
  ;
  insert into movimentacao_visual (
    tipo,
    origem_id,
    destino_id,
    embalagem_id,
    qtd,
    movimentacao_id,
    palete_id,
    created_by
  ) values (
    i_tipo,
    i_origem_id,
    i_destino_id,
    i_emb_id,
    i_qtd,
    v_next_id,
    v_palete_id,
    i_user
  );
  insert into movimentacao (
    id,
    tipo,
    origem_id,
    destino_id,
    status,
    qtd,
    emb,
    qtd_emb,
    prioridade,
    palete_id
  ) values (
    v_next_id,
    i_tipo,
    i_origem_id,
    i_destino_id,
    0,
    i_qtd*v_qtd_emb,
    v_emb,
    v_qtd_emb,
    1,
    v_palete_id
  );
  update endereco
     set qtd_atual = qtd_atual - i_qtd*v_qtd_emb
   where id = i_origem_id;
  update endereco
     set qtd_atual = qtd_atual + i_qtd*v_qtd_emb
   where id = i_destino_id;
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_MUDAR_BOX--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_MUDAR_BOX" ( 
  i_carga IN NUMBER, 
  i_new_box IN NUMBER, 
  i_user IN VARCHAR2 
) as 
begin 
  update CARGA_IMPORT 
     set BOX_ID = i_new_box, 
         UPDATED_BY = i_user 
   where ID = i_carga 
  ; 
  update CARGA 
     set BOX_ID = i_new_box, 
         UPDATED_BY = i_user 
   where ID = i_carga 
  ; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_MUDAR_DESTINO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_MUDAR_DESTINO" ( 
  i_carga IN NUMBER, 
  i_new_destino IN VARCHAR2, 
  i_user IN VARCHAR2 
) as 
begin 
  update CARGA_IMPORT 
     set DESTINO = i_new_destino, 
         UPDATED_BY = i_user 
   where ID = i_carga 
  ; 
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL" ( 
  i_carga   IN NUMBER, 
  i_lote    IN NUMBER, 
  i_user    IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(6000); 
begin 
  select F_GET_ZPL(i_carga, i_lote) 
    into str 
    from dual; 
  str := '^XA' || str || '^XZ'; 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                               remote_port => '9100', 
                               charset     => 'US7ASCII'); 
  ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
  utl_tcp.close_connection(c); 
 
  insert into LOTE_PRINT_LOG (CARGA_ID, LOTE, SEP_ID) 
  values (i_carga, i_lote, i_user); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL2--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL2" ( 
  i_carga   IN NUMBER, 
  i_lote    IN NUMBER, 
  i_user    IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(6000); 
begin 
  select F_GET_ZPL12(i_carga, i_lote) 
    into str 
    from dual; 
  str := '^XA' || str || '^XZ'; 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                               remote_port => '9100', 
                               charset     => 'US7ASCII'); 
  ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
  utl_tcp.close_connection(c); 
 
  insert into LOTE_PRINT_LOG (CARGA_ID, LOTE, SEP_ID) 
  values (i_carga, i_lote, i_user); 
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPLTESTE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPLTESTE" ( 
  i_carga   IN NUMBER, 
  i_lote    IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(6000); 
begin 
  select F_GET_ZPL12(i_carga, i_lote) 
    into str 
    from dual; 
  str := '^XA' || str || '^XZ'; 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                               remote_port => '9100', 
                               charset     => 'US7ASCII'); 
  ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
  utl_tcp.close_connection(c); 
 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL_ELMA--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL_ELMA" ( 
  i_carga   IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(4000); 
begin 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                           remote_port => '9100', 
                           charset     => 'US7ASCII'); 
  for c1 in ( 
    select F_GET_ZPL(A.CARGA_ID, A.LOTE) zpl from lote A 
     where A.CARGA_ID = i_carga 
       and A.LS in ('CA','FR','ME') 
     order by A.LS, A.LOTE 
  ) loop 
    str := '^XA' || c1.zpl || '^XZ'; 
    ret_val := utl_tcp.WRITE_TEXT(c, str); 
  end loop; 
  utl_tcp.close_connection(c); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL_ELMA2--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL_ELMA2" ( 
  i_carga   IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(4000); 
begin 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                             remote_port => '9100', 
                             charset     => 'US7ASCII'); 
  for c1 in ( 
    select F_GET_ZPL(A.CARGA_ID, A.LOTE) zpl from lote A 
     where A.CARGA_ID = i_carga 
       and A.LS in ('CA','FR','ME') 
  ) loop 
    str := '^XA' || c1.zpl || '^XZ'; 
 
    ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
     
  end loop; 
  utl_tcp.close_connection(c); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL_ESTACAO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL_ESTACAO" ( 
  i_carga   IN NUMBER, 
  i_lote    IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(4000); 
begin 
  select F_GET_ZPL(i_carga, i_lote) 
    into str 
    from dual; 
  str := '^XA' || str || '^XZ'; 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                               remote_port => '9100', 
                               charset     => 'US7ASCII'); 
  ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
  utl_tcp.close_connection(c); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL_REC--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL_REC" ( 
  i_carga   IN NUMBER, 
  i_lote    IN NUMBER, 
  i_user    IN NUMBER, 
  i_printer IN VARCHAR2 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(6000); 
begin 
  select F_GET_ZPL_REC(i_carga, i_lote) 
    into str 
    from dual; 
  str := '^XA' || str || '^XZ'; 
  c := utl_tcp.open_connection(remote_host => i_printer, 
                               remote_port => '9100', 
                               charset     => 'US7ASCII'); 
  ret_val := utl_tcp.WRITE_TEXT(c, str); 
 
  utl_tcp.close_connection(c); 
 
  --insert into LOTE_PRINT_LOG (CARGA_ID, LOTE, SEP_ID) 
  --values (i_carga, i_lote, i_user); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_PRINT_ZPL_REC_CG--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_PRINT_ZPL_REC_CG" ( 
  i_carga   IN NUMBER, 
  i_user    IN NUMBER, 
  i_printer IN VARCHAR2, 
  i_id      IN NUMBER 
) as 
  c utl_tcp.connection; 
  ret_val pls_integer; 
  str varchar2(6000); 
begin 
c := utl_tcp.open_connection(remote_host => i_printer, 
                           remote_port => '9100', 
                           charset     => 'US7ASCII'); 
  for c1 in ( 
    select WMS.F_GET_ZPL_REC(A.CARGA_ID, A.ID) zpl from WMS.PALETE A 
     where A.CARGA_ID = i_carga 
     and nvl(i_id,0) = 0 or i_id = id 
  ) loop 
    str := '^XA' || c1.zpl || '^XZ'; 
    ret_val := utl_tcp.WRITE_TEXT(c, str); 
  end loop; 
  utl_tcp.close_connection(c); 
 
  --insert into LOTE_PRINT_LOG (CARGA_ID, LOTE, SEP_ID) 
  --values (i_carga, i_lote, i_user); 
end; 
 
 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_REPOSICAO_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_REPOSICAO_ENDERECO" ( 
  i_id IN NUMBER, 
  i_prioridade IN NUMBER 
) as  
v_new_qtd number;  
v_qtd_restante number;  
v_endereco_mov number;  
BEGIN  
  v_new_qtd := F_REPOSICAO_ENDERECO(i_id);  
  if v_new_qtd > 0 then  
    v_qtd_restante := v_new_qtd;  
    P_ENDERECO_MOVIMENTACAO(i_id, v_qtd_restante, i_prioridade);  
    
    update ENDERECO  
       set QTD_ATUAL = v_new_qtd - v_qtd_restante  
     where ID = i_id;  
  else  
    insert into teste(c_vc, c_num)  
    values ('Sem reposicao para o id ' || i_id, i_id);  
    commit;  
  end if;  
    
END;  
----------------------------  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_SEP_PROX_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_SEP_PROX_ATIVIDADE" ( 
  i_produtivo IN NUMBER, 
  o_carga OUT NUMBER, 
  o_lote OUT NUMBER 
) as 
  v_prioridade number; 
  v_exclusivo number; 
  v_is_mabel number; 
  v_mabel varchar2(2); 
begin 
  --Verificar se atividade  mabel 
  select count(*) 
    into v_is_mabel 
    from PRODUTIVO_LS A, 
         LINHADESEPARACAO B 
   where PRODUTIVO_ID = i_produtivo 
     and A.LS_ID = B.ID 
     and B.LS = 'MF' 
  ; 
 
  select EXCLUSIVO 
    into v_exclusivo 
    from PRODUTIVO 
   where ID = i_produtivo; 
  --htp.p('Exclusivo: '||v_exclusivo); 
   
  --Mudana em todos os wheres que envolvem linha de separao 
  --DE: B.LS not in ('ME','FR','TE','CA') 
  --PARA: ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
  select min(A.PRIORIDADE) 
    into v_prioridade  
    from CARGA            A, 
         LOTE             B, 
         PRODUTIVO_LS     C, 
         LINHADESEPARACAO D, 
         PRODUTIVO        E 
   where A.ID = B.CARGA_ID 
     and B.LS = D.LS 
     and D.ID = C.LS_ID 
     and E.ID = C.PRODUTIVO_ID 
     and E.ID = i_produtivo 
     and B.STATUS = 0 
     and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
  ; 
  --htp.p('Prioridade: '||v_prioridade); 
  if v_prioridade is not null and v_exclusivo = 1 then 
    select distinct ID 
      into o_carga 
      from (select distinct A.ID, RANK() OVER(order by F.DTAHORGERAPALETE) n, F.DTAHORGERAPALETE 
              from CARGA            A, 
                   LOTE             B, 
                   PRODUTIVO_LS     C, 
                   LINHADESEPARACAO D, 
                   PRODUTIVO        E, 
                   CONSINCO.MLO_CARGAEXPED F 
             where A.ID = B.CARGA_ID 
               and A.ID = F.NROCARGA 
               and B.LS = D.LS 
               and D.ID = C.LS_ID 
               and E.ID = C.PRODUTIVO_ID 
               and E.ID = i_produtivo 
               and A.PRIORIDADE = v_prioridade 
               and B.STATUS = 0 
               and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0))) 
     where n = 1 
    ; 
    select min(B.ID) 
      into o_lote 
      from CARGA            A, 
           LOTE             B, 
           PRODUTIVO_LS     C, 
           LINHADESEPARACAO D, 
           PRODUTIVO        E 
     where A.ID = B.CARGA_ID 
       and B.LS = D.LS 
       and D.ID = C.LS_ID 
       and E.ID = C.PRODUTIVO_ID 
       and E.ID = i_produtivo 
       and B.STATUS = 0 
       and A.ID = o_carga 
       and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
    ; 
  else 
    select min(A.PRIORIDADE) 
      into v_prioridade 
      from CARGA A, 
           LOTE  B 
     where A.ID = B.CARGA_ID 
       and B.STATUS = 0 
       and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
    ; 
    --htp.p(v_prioridade); 
    select distinct ID 
      into o_carga 
      from (select distinct A.ID, RANK() OVER(order by C.DTAHORGERAPALETE) n, C.DTAHORGERAPALETE 
              from CARGA A, 
                   LOTE B, 
                   CONSINCO.MLO_CARGAEXPED C 
             where A.ID = B.CARGA_ID 
               and A.ID = C.NROCARGA 
               and B.STATUS = 0 
               and A.PRIORIDADE = v_prioridade 
               and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0))) 
     where n = 1; 
 
    /* 
    select min(A.ID) 
      into o_carga 
      from CARGA A, 
           LOTE B 
     where A.ID = B.CARGA_ID 
       and B.STATUS = 0 
       and A.PRIORIDADE = v_prioridade 
       and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
    ;*/ 
     
    select min(B.ID) 
      into o_lote 
      from CARGA A, 
           LOTE B 
     where A.ID = B.CARGA_ID 
       and B.STATUS = 0 
       and A.ID = o_carga 
       and ((B.LS in ('MF') and v_is_mabel = 1 ) or (B.LS not in ('ME','FR','TE','CA','MF') and v_is_mabel = 0)) 
    ; 
  end if; 
  o_carga := nvl(o_carga, 0); 
  o_lote := nvl(o_lote, 0); 
   
  exception 
  when NO_DATA_FOUND 
    then o_carga := nvl(o_carga, 0); 
         o_lote := nvl(o_lote, 0); 
   
  --htp.p('-----------------------'); 
  --htp.p('Carga: ' || o_carga); 
  --htp.p('Lote: ' || o_lote); 
  --htp.p('Prioridade: ' || v_prioridade); 
  --htp.p('Exclusivo: ' || v_exclusivo); 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_SET_ATIVIDADE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_SET_ATIVIDADE" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_user IN NUMBER, 
  i_tipo IN VARCHAR2, 
  i_codrua in VARCHAR2 default null 
) as 
v_new_atv number; 
begin 
  if i_tipo = 'S' then 
    update LOTE 
       set SEP_ID = i_user, 
           SEP_START = sysdate, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ;     
 
    update ATIVIDADE 
       set SEP_ID = i_user, 
           SEP_START = sysdate, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
  elsif i_tipo = 'C' then 
    update LOTE 
       set CONF_ID = i_user, 
           CONF_START = sysdate, 
           STATUS = 3 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ;     
 
    update ATIVIDADE 
       set CONF_ID = i_user, 
           CONF_START = sysdate, 
           STATUS = 3 
     where CARGA_ID = i_carga and LOTE = i_lote 
    ; 
  elsif i_tipo = 'SF' then 
    select count(*) 
      into v_new_atv 
      from LOTE A 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and STATUS = 0; 
     
    if v_new_atv > 0 then 
      update LOTE 
         set SEP_ID = 9, 
             SEP_START = sysdate, 
             STATUS = 1 
       where CARGA_ID = i_carga and LOTE = i_lote 
      ; 
    end if; 
     
    update ATIVIDADE A 
       set SEP_ID = i_user, 
           SEP_START = sysdate, 
           SEP_ENDERECO = i_codrua, 
           STATUS = 1 
     where CARGA_ID = i_carga and LOTE = i_lote 
       and A.PRODUTO_ID in ( 
           select B.PRODUTO_ID 
             from V_ESTACAO_SEP B 
            where A.CARGA_ID = B.CARGA_ID 
              and A.LOTE = B.LOTE 
              and B.CODRUA = i_codrua) 
    ; 
  end if; 
  commit; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_SET_ATIVIDADE_MOV--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_SET_ATIVIDADE_MOV" (
  i_produtivo in number,
  i_tipo in varchar2,
  i_status in number,
  i_palete in number
) as
begin
  if i_tipo = 'A' then
    update movimentacao
       set abast_id = i_produtivo,
           abast_start = sysdate,
           status = i_status
     where palete_id = i_palete
    ;
  else
    update movimentacao
       set emp_id = i_produtivo,
           emp_start = sysdate,
           status = i_status
     where palete_id = i_palete
    ;
  end if;
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_SET_CONF_PALETE--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_SET_CONF_PALETE" (i_conf_id IN NUMBER, i_palete_id IN NUMBER) as  
begin  
  update PALETE  
     set CONF_ID = i_conf_id,  
         CONF_START = sysdate,  
         STATUS = 1  
   where ID = i_palete_id;  
end;  
----------------------------  
/
--------------------------------------------------------------------------------
--PROCEDURE: P_SET_SEP_ENDERECO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_SET_SEP_ENDERECO" ( 
  i_carga IN NUMBER, 
  i_lote IN NUMBER, 
  i_is_pta IN NUMBER 
) is 
begin 
  for c2 in ( 
    select A.CODPROD as PRODUTO_ID, 
           A.QTDEMBALAGEM as QTD_EMB, 
           case 
             when i_is_pta > 0 then 
               F_GET_LOCAL_PTA(a.codprod) 
             else 
               A.LOCAL 
           end as LOCAL 
      from V_ATIVIDADE_SEP A 
     where A.carga = i_carga 
       And A.seqlote = i_lote 
  ) loop 
    update ATIVIDADE A 
       set A.SEP_ENDERECO = c2.LOCAL 
     where A.PRODUTO_ID = c2.PRODUTO_ID 
       and A.QTD_EMB = c2.QTD_EMB 
       and A.CARGA_ID = i_carga 
       and A.LOTE = i_lote 
       and A.SEP_ENDERECO is null 
    ; 
  end loop; 
end; 
/
--------------------------------------------------------------------------------
--PROCEDURE: P_VERIFICAR_REPOSICAO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_VERIFICAR_REPOSICAO" (v_endereco_id in number) as
  v_qtd_minima number;
  v_exists number;
  v_qtd_reposicao number;
  v_emb varchar2(3);
  v_qtd_emb number;
  v_origem_id number;
  v_qtd_temp number;
begin
  for c1 in (
    select *
      from endereco
     where id = v_endereco_id
  ) loop
    select a.estoque_min * b.qtd_emb,
           a.lastro*a.altura*b.qtd_emb,
           b.emb,
           b.qtd_emb
      into v_qtd_minima, v_qtd_reposicao, v_emb, v_qtd_emb
      from wms.produto_especie a
     inner join wms.produto_embalagem b
        on b.id = a.embalagem_id
     where a.especie_id = c1.especie_id
       and a.produto_id = c1.produto_id
    ;
    if c1.qtd_atual <= v_qtd_minima then
      if c1.especie_id = 1 then
        select count(*)
          into v_exists
          from wms.endereco
         where especie_id = 5
           and virtual = 0
           and produto_id = c1.produto_id
           and qtd_atual > 0;
      else
        select count(*)
          into v_exists
          from wms.endereco
         where especie_id = 1
           and produto_id = c1.produto_id
           and qtd_atual > 0;
      end if;
      if v_exists > 0 then
        if c1.especie_id = 1 then
          select id, qtd_atual
            into v_origem_id, v_qtd_temp
            from (
            select id, rank() over (order by qtd_atual) as n, qtd_atual
              from wms.endereco a
             where especie_id = 5
               and virtual = 0
               and qtd_atual > 0
               and produto_id = c1.produto_id
             order by 2)
           where rownum = 1
          ;
          if v_qtd_temp > v_qtd_reposicao then
            insert into wms.movimentacao (
              tipo,
              origem_id,
              destino_id,
              status,
              qtd,
              emb,
              qtd_emb,
              prioridade
            ) values (
              'A',
              c1.id,
              v_origem_id,
              0,
              v_qtd_temp - v_qtd_reposicao,
              v_emb,
              v_qtd_emb,
              0
            );
            v_qtd_temp := v_qtd_reposicao;
          end if;
          insert into wms.movimentacao (
            tipo,
            origem_id,
            destino_id,
            status,
            qtd,
            emb,
            qtd_emb,
            prioridade
          ) values (
            'D',
            v_origem_id,
            c1.id,
            0,
            v_qtd_temp,
            v_emb,
            v_qtd_emb,
            0
          );
        else
          select id, qtd_atual
            into v_origem_id, v_qtd_temp
            from (
            select id, rank() over (order by qtd_atual) as n, qtd_atual
              from wms.endereco a
             where especie_id = 1
               and virtual = 0
               and qtd_atual > 0
               and produto_id = c1.produto_id
             order by 2)
           where rownum = 1
          ;
          if v_qtd_temp > v_qtd_reposicao then
            v_qtd_temp := v_qtd_reposicao;
          end if;
          insert into wms.movimentacao (
            tipo,
            origem_id,
            destino_id,
            status,
            qtd,
            emb,
            qtd_emb,
            prioridade
          ) values (
            'R',
            v_origem_id,
            c1.id,
            0,
            v_qtd_temp,
            v_emb,
            v_qtd_emb,
            0
          );
        end if;
      end if;
    end if;
  end loop;
end;
/
--------------------------------------------------------------------------------
--PROCEDURE: P_WMS_CORTAR_PRODUTO--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE PROCEDURE "WMS"."P_WMS_CORTAR_PRODUTO" ( 
  i_carga IN NUMBER, 
  i_produto IN NUMBER, 
  i_embalagem IN NUMBER, 
  i_qtd IN NUMBER, 
  i_seqpessoa IN NUMBER, 
  i_qtd_pedido IN NUMBER, 
  i_corte_id IN NUMBER, 
  i_user IN VARCHAR2 default null 
) as 
v_qtd_resta number; 
v_qtd_update number; 
v_new_qtd number; 
v_seqendereco number; 
v_seqhist number; 
v_seqlanc number; 
begin 
  insert into WMS.CORTE_LOG ( 
    corte_id, 
    pessoa_id, 
    qtd_emb, 
    qtd_pedido, 
    qtd_digitado, 
    created_by 
  ) 
  values ( 
    i_corte_id, 
    i_seqpessoa, 
    i_embalagem, 
    i_qtd_pedido, 
    i_qtd, 
    i_user 
  ) 
  ; 
  --Update responsvel por fazer o update na mad_pedvendaitem 
  update consinco.MRL_CARGAEXPPROD A 
     set A.QTDEMBANTERIOR           = NULL, 
         A.QTDUNITIMPORTADA         = 0, 
         A.QTDUNITCONFERIDA         = i_qtd*i_embalagem, 
         A.USUCONFERENCIA           = i_user, 
         A.DTAHORCONFERENCIA        = sysdate, 
         A.QTDUNITCONFERIDAANTERIOR = A.QTDEMBALAGEM * A.QTDEMBSOLICITADA, 
         A.QTDCONFMESA              = NULL, 
         A.QTDUNITCONFERIDA_RF      = i_qtd*i_embalagem 
   where A.SEQPESSOA = i_seqpessoa 
     And A.SEQPRODUTO = i_produto 
     And A.NROCARGA = i_carga 
     And A.NROEMPRESA = 1 
     --And A.SEQPESSOAEND = 0 
     --And A.NROPEDVENDA = 0 
     And A.INDEMBALADO = 'N' 
     And A.SEQLOCALITEM = 0 
     And A.SEQLOTEESTOQUE = 0 
     And A.QTDEMBALAGEM = i_embalagem 
  ; 
  /* 
  update CONSINCO.MLO_CARGAEXPPROD 
     set QTDEMBSEPARADA = i_qtd, 
         INDGERACORTEITEMWM = 'S' 
   where nrocarga = i_carga 
     and seqproduto = i_produto 
     and qtdembalagem = i_embalagem 
     and seqpessoa = i_seqpessoa 
  ;*/ 
  --commit; 
end; 
/
--------------------------------------------------------------------------------
--TRIGGER: ATIVIDADE_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ATIVIDADE_AUD" 
    after update or delete on atividade  
    for each row  
declare  
    t varchar2(128) := 'ATIVIDADE';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.lote_id is null and :new.lote_id is not null) or   
        (:old.lote_id is not null and :new.lote_id is null) or   
        :old.lote_id != :new.lote_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTE_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lote_id, :new.lote_id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
    if (:old.pessoa_id is null and :new.pessoa_id is not null) or   
        (:old.pessoa_id is not null and :new.pessoa_id is null) or   
        :old.pessoa_id != :new.pessoa_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
  
    end if;  
    if (:old.prioridade is null and :new.prioridade is not null) or   
        (:old.prioridade is not null and :new.prioridade is null) or   
        :old.prioridade != :new.prioridade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
    end if;  
    if (:old.lote is null and :new.lote is not null) or   
        (:old.lote is not null and :new.lote is null) or   
        :old.lote != :new.lote then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
  
    end if;  
    if (:old.ls is null and :new.ls is not null) or   
        (:old.ls is not null and :new.ls is null) or   
        :old.ls != :new.ls then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LS', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
  
    end if;  
    if (:old.produto_id is null and :new.produto_id is not null) or   
        (:old.produto_id is not null and :new.produto_id is null) or   
        :old.produto_id != :new.produto_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
  
    end if;  
    if (:old.qtd_pedido is null and :new.qtd_pedido is not null) or   
        (:old.qtd_pedido is not null and :new.qtd_pedido is null) or   
        :old.qtd_pedido != :new.qtd_pedido then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_pedido, :new.qtd_pedido);  
  
    end if;  
    if (:old.emb_id is null and :new.emb_id is not null) or   
        (:old.emb_id is not null and :new.emb_id is null) or   
        :old.emb_id != :new.emb_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'EMB_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.emb_id, :new.emb_id);  
  
    end if;  
    if (:old.emb is null and :new.emb is not null) or   
        (:old.emb is not null and :new.emb is null) or   
        :old.emb != :new.emb then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'EMB', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.emb, :new.emb);  
  
    end if;  
    if (:old.qtd_emb is null and :new.qtd_emb is not null) or   
        (:old.qtd_emb is not null and :new.qtd_emb is null) or   
        :old.qtd_emb != :new.qtd_emb then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
  
    end if;  
    if (:old.peso is null and :new.peso is not null) or   
        (:old.peso is not null and :new.peso is null) or   
        :old.peso != :new.peso then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
  
    end if;  
    if (:old.volume is null and :new.volume is not null) or   
        (:old.volume is not null and :new.volume is null) or   
        :old.volume != :new.volume then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'VOLUME', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.sep_id is null and :new.sep_id is not null) or   
        (:old.sep_id is not null and :new.sep_id is null) or   
        :old.sep_id != :new.sep_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'SEP_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
  
    end if;  
    if (:old.sep_qtd is null and :new.sep_qtd is not null) or   
        (:old.sep_qtd is not null and :new.sep_qtd is null) or   
        :old.sep_qtd != :new.sep_qtd then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'SEP_QTD', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.sep_qtd, :new.sep_qtd);  
  
    end if;  
    if (:old.sep_endereco is null and :new.sep_endereco is not null) or   
        (:old.sep_endereco is not null and :new.sep_endereco is null) or   
        :old.sep_endereco != :new.sep_endereco then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'SEP_ENDERECO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.sep_endereco, :new.sep_endereco);  
  
    end if;  
    if (:old.sep_start is null and :new.sep_start is not null) or   
        (:old.sep_start is not null and :new.sep_start is null) or   
        :old.sep_start != :new.sep_start then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'SEP_START', :old.id, null, 'U', sysdate, u, 'DATE', :old.sep_start, :new.sep_start);  
  
    end if;  
    if (:old.sep_end is null and :new.sep_end is not null) or   
        (:old.sep_end is not null and :new.sep_end is null) or   
        :old.sep_end != :new.sep_end then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'SEP_END', :old.id, null, 'U', sysdate, u, 'DATE', :old.sep_end, :new.sep_end);  
  
    end if;  
    if (:old.conf_id is null and :new.conf_id is not null) or   
        (:old.conf_id is not null and :new.conf_id is null) or   
        :old.conf_id != :new.conf_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CONF_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
  
    end if;  
    if (:old.conf_qtd is null and :new.conf_qtd is not null) or   
        (:old.conf_qtd is not null and :new.conf_qtd is null) or   
        :old.conf_qtd != :new.conf_qtd then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CONF_QTD', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.conf_qtd, :new.conf_qtd);  
  
    end if;  
    if (:old.corte_qtd is null and :new.corte_qtd is not null) or   
        (:old.corte_qtd is not null and :new.corte_qtd is null) or   
        :old.corte_qtd != :new.corte_qtd then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CORTE_QTD', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.corte_qtd, :new.corte_qtd);  
  
    end if;  
    if (:old.conf_start is null and :new.conf_start is not null) or   
        (:old.conf_start is not null and :new.conf_start is null) or   
        :old.conf_start != :new.conf_start then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'CONF_START', :old.id, null, 'U', sysdate, u, 'DATE', :old.conf_start, :new.conf_start);  
  
    end if;  
    if (:old.conf_end is null and :new.conf_end is not null) or   
        (:old.conf_end is not null and :new.conf_end is null) or   
        :old.conf_end != :new.conf_end then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'CONF_END', :old.id, null, 'U', sysdate, u, 'DATE', :old.conf_end, :new.conf_end);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTE_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lote_id, :new.lote_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LS', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_pedido, :new.qtd_pedido);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'EMB_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.emb_id, :new.emb_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'EMB', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.emb, :new.emb);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'VOLUME', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'SEP_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'SEP_QTD', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.sep_qtd, :new.sep_qtd);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'SEP_ENDERECO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.sep_endereco, :new.sep_endereco);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'SEP_START', :old.id, null, 'D', sysdate, u, 'DATE', :old.sep_start, :new.sep_start);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'SEP_END', :old.id, null, 'D', sysdate, u, 'DATE', :old.sep_end, :new.sep_end);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CONF_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CONF_QTD', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.conf_qtd, :new.conf_qtd);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CORTE_QTD', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.corte_qtd, :new.corte_qtd);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'CONF_START', :old.id, null, 'D', sysdate, u, 'DATE', :old.conf_start, :new.conf_start);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'CONF_END', :old.id, null, 'D', sysdate, u, 'DATE', :old.conf_end, :new.conf_end);  
  
end if;  
end atividade_aud;  
 

/
ALTER TRIGGER "WMS"."ATIVIDADE_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ATIVIDADE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ATIVIDADE_BIU" 
    before insert or update   
    on atividade  
    for each row  
begin  
    if :new.id is null then  
        :new.id := atividade_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end atividade_biu;  
 

/
ALTER TRIGGER "WMS"."ATIVIDADE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ATIVIDADE_QTD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ATIVIDADE_QTD" 
BEFORE 
insert on "ATIVIDADE" 
for each row 
begin 
UPDATE LOTE  
SET QTD_ITEM = NVL(QTD_ITEM,0)+1, 
QTD_VOLUME = NVL(QTD_VOLUME,0)+(:NEW.QTD_PEDIDO/:NEW.QTD_EMB) 
WHERE CARGA_ID = :NEW.CARGA_ID 
AND LOTE = :NEW.LOTE; 
end; 
 

/
ALTER TRIGGER "WMS"."ATIVIDADE_QTD" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: BI_TESTE_DIFF--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."BI_TESTE_DIFF" 
  before insert on "TESTE_DIFF"                
  for each row   
begin    
  if :NEW."C_NUMBER" is null then  
    select "TESTE_DIFF_SEQ".nextval into :NEW."C_NUMBER" from sys.dual;  
  end if;  
end; 
 

/
ALTER TRIGGER "WMS"."BI_TESTE_DIFF" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: BOX_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."BOX_AUD" 
    after update or delete on box  
    for each row  
declare  
    t varchar2(128) := 'BOX';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.prioridade is null and :new.prioridade is not null) or   
        (:old.prioridade is not null and :new.prioridade is null) or   
        :old.prioridade != :new.prioridade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
end if;  
end box_aud;  
 

/
ALTER TRIGGER "WMS"."BOX_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: BOX_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."BOX_BIU" 
    before insert or update   
    on box  
    for each row  
begin  
    if :new.id is null then  
        :new.id := box_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end box_biu;  
 

/
ALTER TRIGGER "WMS"."BOX_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CARGA_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CARGA_AUD" 
    after update or delete on carga  
    for each row  
declare  
    t varchar2(128) := 'CARGA';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.lotes is null and :new.lotes is not null) or   
        (:old.lotes is not null and :new.lotes is null) or   
        :old.lotes != :new.lotes then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTES', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lotes, :new.lotes);  
  
    end if;  
    if (:old.prioridade is null and :new.prioridade is not null) or   
        (:old.prioridade is not null and :new.prioridade is null) or   
        :old.prioridade != :new.prioridade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
    end if;  
    if (:old.box_id is null and :new.box_id is not null) or   
        (:old.box_id is not null and :new.box_id is null) or   
        :old.box_id != :new.box_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'BOX_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
  
    end if;  
    if (:old.peso is null and :new.peso is not null) or   
        (:old.peso is not null and :new.peso is null) or   
        :old.peso != :new.peso then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
  
    end if;  
    if (:old.volume is null and :new.volume is not null) or   
        (:old.volume is not null and :new.volume is null) or   
        :old.volume != :new.volume then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'VOLUME', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.date_start is null and :new.date_start is not null) or   
        (:old.date_start is not null and :new.date_start is null) or   
        :old.date_start != :new.date_start then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'DATE_START', :old.id, null, 'U', sysdate, u, 'DATE', :old.date_start, :new.date_start);  
  
    end if;  
    if (:old.date_end is null and :new.date_end is not null) or   
        (:old.date_end is not null and :new.date_end is null) or   
        :old.date_end != :new.date_end then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'DATE_END', :old.id, null, 'U', sysdate, u, 'DATE', :old.date_end, :new.date_end);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTES', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lotes, :new.lotes);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'BOX_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'VOLUME', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'DATE_START', :old.id, null, 'D', sysdate, u, 'DATE', :old.date_start, :new.date_start);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'DATE_END', :old.id, null, 'D', sysdate, u, 'DATE', :old.date_end, :new.date_end);  
  
end if;  
end carga_aud;  
 

/
ALTER TRIGGER "WMS"."CARGA_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CARGA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CARGA_BIU" 
    before insert or update   
    on carga  
    for each row  
begin  
    if :new.id is null then  
        :new.id := carga_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by :=  
      case 
        when :new.updated_by is null then 
          nvl(sys_context('APEX$SESSION','APP_USER'),user) 
        else 
          :new.updated_by 
      end; 
end carga_biu;  
 

/
ALTER TRIGGER "WMS"."CARGA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CARGA_IMPORT_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CARGA_IMPORT_AUD" 
    after update or delete on carga_import  
    for each row  
declare  
    t varchar2(128) := 'CARGA_IMPORT';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.prioridade is null and :new.prioridade is not null) or   
        (:old.prioridade is not null and :new.prioridade is null) or   
        :old.prioridade != :new.prioridade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
    end if;  
    if (:old.lotes is null and :new.lotes is not null) or   
        (:old.lotes is not null and :new.lotes is null) or   
        :old.lotes != :new.lotes then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTES', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lotes, :new.lotes);  
  
    end if;  
    if (:old.peso is null and :new.peso is not null) or   
        (:old.peso is not null and :new.peso is null) or   
        :old.peso != :new.peso then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
  
    end if;  
    if (:old.volume is null and :new.volume is not null) or   
        (:old.volume is not null and :new.volume is null) or   
        :old.volume != :new.volume then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'VOLUME', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
  
    end if;  
    if (:old.box_id is null and :new.box_id is not null) or   
        (:old.box_id is not null and :new.box_id is null) or   
        :old.box_id != :new.box_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'BOX_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
  
    end if;  
    if (:old.destino is null and :new.destino is not null) or   
        (:old.destino is not null and :new.destino is null) or   
        :old.destino != :new.destino then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'DESTINO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.destino, :new.destino);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTES', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lotes, :new.lotes);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'VOLUME', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'BOX_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'DESTINO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.destino, :new.destino);  
  
end if;  
end carga_import_aud;  
 

/
ALTER TRIGGER "WMS"."CARGA_IMPORT_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CARGA_IMPORT_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CARGA_IMPORT_BIU" 
    before insert or update   
    on carga_import  
    for each row  
begin  
    if :new.id is null then  
        :new.id := carga_import_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by :=  
      case 
        when :new.updated_by is null then 
          nvl(sys_context('APEX$SESSION','APP_USER'),user) 
        else 
          :new.updated_by 
      end; 
end carga_import_biu;  
 

/
ALTER TRIGGER "WMS"."CARGA_IMPORT_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CARGA_T2--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CARGA_T2" 
BEFORE 
insert on "CARGA" 
for each row 
begin 
select a.box_id into :new.BOX_ID   from CARGA_IMPORT a where a.id = :new.id; 
end; 
 

/
ALTER TRIGGER "WMS"."CARGA_T2" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: CORTE_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CORTE_AUD" 
    after update or delete on corte  
    for each row  
declare  
    t varchar2(128) := 'CORTE';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
    if (:old.lote is null and :new.lote is not null) or   
        (:old.lote is not null and :new.lote is null) or   
        :old.lote != :new.lote then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
  
    end if;  
    if (:old.produto_id is null and :new.produto_id is not null) or   
        (:old.produto_id is not null and :new.produto_id is null) or   
        :old.produto_id != :new.produto_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
  
    end if;  
    if (:old.conf_id is null and :new.conf_id is not null) or   
        (:old.conf_id is not null and :new.conf_id is null) or   
        :old.conf_id != :new.conf_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CONF_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
  
    end if;  
    if (:old.conf_qtd is null and :new.conf_qtd is not null) or   
        (:old.conf_qtd is not null and :new.conf_qtd is null) or   
        :old.conf_qtd != :new.conf_qtd then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'CONF_QTD', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.conf_qtd, :new.conf_qtd);  
  
    end if;  
    if (:old.qtd_pedido is null and :new.qtd_pedido is not null) or   
        (:old.qtd_pedido is not null and :new.qtd_pedido is null) or   
        :old.qtd_pedido != :new.qtd_pedido then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.qtd_pedido, :new.qtd_pedido);  
  
    end if;  
    if (:old.done is null and :new.done is not null) or   
        (:old.done is not null and :new.done is null) or   
        :old.done != :new.done then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'DONE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.done, :new.done);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CONF_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'CONF_QTD', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.conf_qtd, :new.conf_qtd);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.qtd_pedido, :new.qtd_pedido);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'DONE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.done, :new.done);  
  
end if;  
end corte_aud;  
 

/
ALTER TRIGGER "WMS"."CORTE_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CORTE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CORTE_BIU" 
    before insert or update   
    on corte  
    for each row  
begin  
    if :new.id is null then  
        :new.id := corte_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate; 
        if :new.created_by is null then 
            :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
        end if; 
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end corte_biu;  
 

/
ALTER TRIGGER "WMS"."CORTE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CORTE_LOG_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CORTE_LOG_AUD" 
    after update or delete on corte_log  
    for each row  
declare  
    t varchar2(128) := 'CORTE_LOG';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.corte_id is null and :new.corte_id is not null) or   
        (:old.corte_id is not null and :new.corte_id is null) or   
        :old.corte_id != :new.corte_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CORTE_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.corte_id, :new.corte_id);  
  
    end if;  
    if (:old.pessoa_id is null and :new.pessoa_id is not null) or   
        (:old.pessoa_id is not null and :new.pessoa_id is null) or   
        :old.pessoa_id != :new.pessoa_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
  
    end if;  
    if (:old.qtd_emb is null and :new.qtd_emb is not null) or   
        (:old.qtd_emb is not null and :new.qtd_emb is null) or   
        :old.qtd_emb != :new.qtd_emb then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
  
    end if;  
    if (:old.qtd_pedido is null and :new.qtd_pedido is not null) or   
        (:old.qtd_pedido is not null and :new.qtd_pedido is null) or   
        :old.qtd_pedido != :new.qtd_pedido then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_pedido, :new.qtd_pedido);  
  
    end if;  
    if (:old.qtd_digitado is null and :new.qtd_digitado is not null) or   
        (:old.qtd_digitado is not null and :new.qtd_digitado is null) or   
        :old.qtd_digitado != :new.qtd_digitado then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_DIGITADO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_digitado, :new.qtd_digitado);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CORTE_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.corte_id, :new.corte_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_PEDIDO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_pedido, :new.qtd_pedido);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_DIGITADO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_digitado, :new.qtd_digitado);  
  
end if;  
end corte_log_aud; 
 

/
ALTER TRIGGER "WMS"."CORTE_LOG_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: CORTE_LOG_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."CORTE_LOG_BIU" 
    before insert or update   
    on corte_log  
    for each row  
begin  
    if :new.id is null then  
        :new.id := corte_log_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        if :new.created_by is null then 
          :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user); 
        end if; 
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end corte_log_biu; 
 

/
ALTER TRIGGER "WMS"."CORTE_LOG_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: EMBALAGEM_CODIGO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."EMBALAGEM_CODIGO_BIU" 
    before insert or update   
    on embalagem_codigo  
    for each row  
begin  
    if :new.id is null then  
        :new.id := embalagem_codigo_seq.nextval;  
    end if;  
end embalagem_codigo_biu;  
 

/
ALTER TRIGGER "WMS"."EMBALAGEM_CODIGO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: EMPRESA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."EMPRESA_BIU" 
    before insert or update   
    on empresa  
    for each row  
begin  
    if :new.id is null then  
        :new.id := empresa_seq.nextval;  
    end if;  
end empresa_biu;  
 

/
ALTER TRIGGER "WMS"."EMPRESA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_ARMAZENAGEM_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_ARMAZENAGEM_BIU" 
    before insert or update   
    on endereco_armazenagem  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_armazenagem_seq.nextval;  
    end if;  
end endereco_armazenagem_biu;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_ARMAZENAGEM_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_BI--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_BI" 
    before insert   
    on endereco  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_seq.nextval;  
    end if;  
end endereco_bi;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_BI" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_ESPECIE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_ESPECIE_BIU" 
    before insert or update   
    on endereco_especie  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_especie_seq.nextval;  
    end if;  
end endereco_especie_biu;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_ESPECIE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_RUA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_RUA_BIU" 
    before insert or update   
    on endereco_rua  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_rua_seq.nextval;  
    end if;  
end endereco_rua_biu;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_RUA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_TIPO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_TIPO_BIU" 
    before insert or update   
    on endereco_tipo  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_tipo_seq.nextval;  
    end if;  
end endereco_tipo_biu;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_TIPO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ENDERECO_VALIDADE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ENDERECO_VALIDADE_BIU" 
    before insert or update   
    on endereco_validade  
    for each row  
begin  
    if :new.id is null then  
        :new.id := endereco_validade_seq.nextval;  
    end if;  
end endereco_validade_biu;  
 

/
ALTER TRIGGER "WMS"."ENDERECO_VALIDADE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ERRO_SEPARACAO_ALERTA_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ERRO_SEPARACAO_ALERTA_AUD" 
    after update or delete on erro_separacao_alerta  
    for each row  
declare  
    t varchar2(128) := 'ERRO_SEPARACAO_ALERTA';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.erro_separacao_id is null and :new.erro_separacao_id is not null) or   
        (:old.erro_separacao_id is not null and :new.erro_separacao_id is null) or   
        :old.erro_separacao_id != :new.erro_separacao_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ERRO_SEPARACAO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.erro_separacao_id, :new.erro_separacao_id);  
  
    end if;  
    if (:old.box_id is null and :new.box_id is not null) or   
        (:old.box_id is not null and :new.box_id is null) or   
        :old.box_id != :new.box_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'BOX_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
  
    end if;  
    if (:old.local is null and :new.local is not null) or   
        (:old.local is not null and :new.local is null) or   
        :old.local != :new.local then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LOCAL', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.local, :new.local);  
  
    end if;  
    if (:old.done_publico is null and :new.done_publico is not null) or   
        (:old.done_publico is not null and :new.done_publico is null) or   
        :old.done_publico != :new.done_publico then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'DONE_PUBLICO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.done_publico, :new.done_publico);  
  
    end if;  
    if (:old.done_privado is null and :new.done_privado is not null) or   
        (:old.done_privado is not null and :new.done_privado is null) or   
        :old.done_privado != :new.done_privado then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'DONE_PRIVADO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.done_privado, :new.done_privado);  
  
    end if;  
    if (:old.done_admin is null and :new.done_admin is not null) or   
        (:old.done_admin is not null and :new.done_admin is null) or   
        :old.done_admin != :new.done_admin then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'DONE_ADMIN', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.done_admin, :new.done_admin);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ERRO_SEPARACAO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.erro_separacao_id, :new.erro_separacao_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'BOX_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.box_id, :new.box_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LOCAL', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.local, :new.local);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'DONE_PUBLICO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.done_publico, :new.done_publico);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'DONE_PRIVADO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.done_privado, :new.done_privado);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'DONE_ADMIN', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.done_admin, :new.done_admin);  
  
end if;  
end erro_separacao_alerta_aud;  
 

/
ALTER TRIGGER "WMS"."ERRO_SEPARACAO_ALERTA_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ERRO_SEPARACAO_ALERTA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ERRO_SEPARACAO_ALERTA_BIU" 
    before insert or update   
    on erro_separacao_alerta  
    for each row  
begin  
    if :new.id is null then  
        :new.id := erro_separacao_alerta_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end erro_separacao_alerta_biu;  
 

/
ALTER TRIGGER "WMS"."ERRO_SEPARACAO_ALERTA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ERRO_SEPARACAO_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ERRO_SEPARACAO_AUD" 
    after update or delete on erro_separacao  
    for each row  
declare  
    t varchar2(128) := 'ERRO_SEPARACAO';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.atividade_id is null and :new.atividade_id is not null) or   
        (:old.atividade_id is not null and :new.atividade_id is null) or   
        :old.atividade_id != :new.atividade_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ATIVIDADE_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.atividade_id, :new.atividade_id);  
  
    end if;  
    if (:old.qtd_erro is null and :new.qtd_erro is not null) or   
        (:old.qtd_erro is not null and :new.qtd_erro is null) or   
        :old.qtd_erro != :new.qtd_erro then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_ERRO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_erro, :new.qtd_erro);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ATIVIDADE_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.atividade_id, :new.atividade_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_ERRO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_erro, :new.qtd_erro);  
  
end if;  
end erro_separacao_aud;  
 

/
ALTER TRIGGER "WMS"."ERRO_SEPARACAO_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: ERRO_SEPARACAO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."ERRO_SEPARACAO_BIU" 
    before insert or update   
    on erro_separacao  
    for each row  
begin  
    if :new.id is null then  
        :new.id := erro_separacao_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end erro_separacao_biu;  
 

/
ALTER TRIGGER "WMS"."ERRO_SEPARACAO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: FORNECEDOR_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."FORNECEDOR_BIU" 
    before insert or update   
    on fornecedor  
    for each row  
begin  
    if :new.id is null then  
        :new.id := fornecedor_seq.nextval;  
    end if;  
end fornecedor_biu;  
 

/
ALTER TRIGGER "WMS"."FORNECEDOR_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: GRUPO_ACESSO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."GRUPO_ACESSO_BIU" 
    before insert or update   
    on grupo_acesso  
    for each row  
begin  
    if :new.id is null then  
        :new.id := grupo_acesso_seq.nextval;  
    end if;  
end grupo_acesso_biu;  
 

/
ALTER TRIGGER "WMS"."GRUPO_ACESSO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: GRUPO_PERMISSAO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."GRUPO_PERMISSAO_BIU" 
    before insert or update   
    on grupo_permissao  
    for each row  
begin  
    if :new.id is null then  
        :new.id := grupo_permissao_seq.nextval;  
    end if;  
end grupo_permissao_biu;  
 

/
ALTER TRIGGER "WMS"."GRUPO_PERMISSAO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: IMPRESSORA_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."IMPRESSORA_AUD" 
    after update or delete on impressora  
    for each row  
declare  
    t varchar2(128) := 'IMPRESSORA';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.nome is null and :new.nome is not null) or   
        (:old.nome is not null and :new.nome is null) or   
        :old.nome != :new.nome then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'NOME', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
  
    end if;  
    if (:old.ip is null and :new.ip is not null) or   
        (:old.ip is not null and :new.ip is null) or   
        :old.ip != :new.ip then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'IP', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.ip, :new.ip);  
  
    end if;  
    if (:old.descricao is null and :new.descricao is not null) or   
        (:old.descricao is not null and :new.descricao is null) or   
        :old.descricao != :new.descricao then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'DESCRICAO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.descricao, :new.descricao);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'NOME', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'IP', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.ip, :new.ip);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'DESCRICAO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.descricao, :new.descricao);  
  
end if;  
end impressora_aud;  
 

/
ALTER TRIGGER "WMS"."IMPRESSORA_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: IMPRESSORA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."IMPRESSORA_BIU" 
    before insert or update   
    on impressora  
    for each row  
begin  
    if :new.id is null then  
        :new.id := impressora_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end impressora_biu;  
 

/
ALTER TRIGGER "WMS"."IMPRESSORA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LINHADESEPARACAO_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LINHADESEPARACAO_AUD" 
    after update or delete on linhadeseparacao  
    for each row  
declare  
    t varchar2(128) := 'LINHADESEPARACAO';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.ls is null and :new.ls is not null) or   
        (:old.ls is not null and :new.ls is null) or   
        :old.ls != :new.ls then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LS', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
  
    end if;  
    if (:old.nome is null and :new.nome is not null) or   
        (:old.nome is not null and :new.nome is null) or   
        :old.nome != :new.nome then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'NOME', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
  
    end if;  
    if (:old.atacadovarejo is null and :new.atacadovarejo is not null) or   
        (:old.atacadovarejo is not null and :new.atacadovarejo is null) or   
        :old.atacadovarejo != :new.atacadovarejo then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'ATACADOVAREJO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.atacadovarejo, :new.atacadovarejo);  
  
    end if;  
    if (:old.tiposepar is null and :new.tiposepar is not null) or   
        (:old.tiposepar is not null and :new.tiposepar is null) or   
        :old.tiposepar != :new.tiposepar then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'TIPOSEPAR', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.tiposepar, :new.tiposepar);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.pesomax is null and :new.pesomax is not null) or   
        (:old.pesomax is not null and :new.pesomax is null) or   
        :old.pesomax != :new.pesomax then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESOMAX', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.pesomax, :new.pesomax);  
  
    end if;  
    if (:old.volumemax is null and :new.volumemax is not null) or   
        (:old.volumemax is not null and :new.volumemax is null) or   
        :old.volumemax != :new.volumemax then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'VOLUMEMAX', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.volumemax, :new.volumemax);  
  
    end if;  
    if (:old.maxatv_abast is null and :new.maxatv_abast is not null) or   
        (:old.maxatv_abast is not null and :new.maxatv_abast is null) or   
        :old.maxatv_abast != :new.maxatv_abast then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'MAXATV_ABAST', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.maxatv_abast, :new.maxatv_abast);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LS', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'NOME', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'ATACADOVAREJO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.atacadovarejo, :new.atacadovarejo);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'TIPOSEPAR', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.tiposepar, :new.tiposepar);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESOMAX', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.pesomax, :new.pesomax);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'VOLUMEMAX', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.volumemax, :new.volumemax);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'MAXATV_ABAST', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.maxatv_abast, :new.maxatv_abast);  
  
end if;  
end linhadeseparacao_aud;  
 

/
ALTER TRIGGER "WMS"."LINHADESEPARACAO_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LINHADESEPARACAO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LINHADESEPARACAO_BIU" 
    before insert or update   
    on linhadeseparacao  
    for each row  
begin  
    if :new.id is null then  
        :new.id := linhadeseparacao_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end linhadeseparacao_biu;  
 

/
ALTER TRIGGER "WMS"."LINHADESEPARACAO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LOTE_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LOTE_AUD" 
    after update or delete on lote  
    for each row  
declare  
    t varchar2(128) := 'LOTE';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
    if (:old.pessoa_id is null and :new.pessoa_id is not null) or   
        (:old.pessoa_id is not null and :new.pessoa_id is null) or   
        :old.pessoa_id != :new.pessoa_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
  
    end if;  
    if (:old.prioridade is null and :new.prioridade is not null) or   
        (:old.prioridade is not null and :new.prioridade is null) or   
        :old.prioridade != :new.prioridade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
  
    end if;  
    if (:old.lote is null and :new.lote is not null) or   
        (:old.lote is not null and :new.lote is null) or   
        :old.lote != :new.lote then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
  
    end if;  
    if (:old.ls_id is null and :new.ls_id is not null) or   
        (:old.ls_id is not null and :new.ls_id is null) or   
        :old.ls_id != :new.ls_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LS_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.ls_id, :new.ls_id);  
  
    end if;  
    if (:old.ls is null and :new.ls is not null) or   
        (:old.ls is not null and :new.ls is null) or   
        :old.ls != :new.ls then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LS', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
  
    end if;  
    if (:old.peso is null and :new.peso is not null) or   
        (:old.peso is not null and :new.peso is null) or   
        :old.peso != :new.peso then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
  
    end if;  
    if (:old.volume is null and :new.volume is not null) or   
        (:old.volume is not null and :new.volume is null) or   
        :old.volume != :new.volume then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'VOLUME', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
  
    end if;  
    if (:old.qtd_item is null and :new.qtd_item is not null) or   
        (:old.qtd_item is not null and :new.qtd_item is null) or   
        :old.qtd_item != :new.qtd_item then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_ITEM', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_item, :new.qtd_item);  
  
    end if;  
    if (:old.qtd_volume is null and :new.qtd_volume is not null) or   
        (:old.qtd_volume is not null and :new.qtd_volume is null) or   
        :old.qtd_volume != :new.qtd_volume then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_VOLUME', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_volume, :new.qtd_volume);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.sep_id is null and :new.sep_id is not null) or   
        (:old.sep_id is not null and :new.sep_id is null) or   
        :old.sep_id != :new.sep_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'SEP_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
  
    end if;  
    if (:old.sep_start is null and :new.sep_start is not null) or   
        (:old.sep_start is not null and :new.sep_start is null) or   
        :old.sep_start != :new.sep_start then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'SEP_START', :old.id, null, 'U', sysdate, u, 'DATE', :old.sep_start, :new.sep_start);  
  
    end if;  
    if (:old.sep_end is null and :new.sep_end is not null) or   
        (:old.sep_end is not null and :new.sep_end is null) or   
        :old.sep_end != :new.sep_end then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'SEP_END', :old.id, null, 'U', sysdate, u, 'DATE', :old.sep_end, :new.sep_end);  
  
    end if;  
    if (:old.conf_id is null and :new.conf_id is not null) or   
        (:old.conf_id is not null and :new.conf_id is null) or   
        :old.conf_id != :new.conf_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CONF_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
  
    end if;  
    if (:old.conf_start is null and :new.conf_start is not null) or   
        (:old.conf_start is not null and :new.conf_start is null) or   
        :old.conf_start != :new.conf_start then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'CONF_START', :old.id, null, 'U', sysdate, u, 'DATE', :old.conf_start, :new.conf_start);  
  
    end if;  
    if (:old.conf_end is null and :new.conf_end is not null) or   
        (:old.conf_end is not null and :new.conf_end is null) or   
        :old.conf_end != :new.conf_end then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
        ) values (  
            history_seq.nextval, t, 'CONF_END', :old.id, null, 'U', sysdate, u, 'DATE', :old.conf_end, :new.conf_end);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESSOA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.pessoa_id, :new.pessoa_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRIORIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.prioridade, :new.prioridade);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LS_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.ls_id, :new.ls_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LS', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso, :new.peso);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'VOLUME', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.volume, :new.volume);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_ITEM', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_item, :new.qtd_item);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_VOLUME', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_volume, :new.qtd_volume);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'SEP_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'SEP_START', :old.id, null, 'D', sysdate, u, 'DATE', :old.sep_start, :new.sep_start);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'SEP_END', :old.id, null, 'D', sysdate, u, 'DATE', :old.sep_end, :new.sep_end);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CONF_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.conf_id, :new.conf_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'CONF_START', :old.id, null, 'D', sysdate, u, 'DATE', :old.conf_start, :new.conf_start);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_date, new_date  
    ) values (  
        history_seq.nextval, t, 'CONF_END', :old.id, null, 'D', sysdate, u, 'DATE', :old.conf_end, :new.conf_end);  
  
end if;  
end lote_aud;  
 

/
ALTER TRIGGER "WMS"."LOTE_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LOTE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LOTE_BIU" 
    before insert or update   
    on lote  
    for each row  
begin  
    if :new.id is null then  
        :new.id := lote_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end lote_biu;  
 

/
ALTER TRIGGER "WMS"."LOTE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LOTE_PRINT_LOG_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LOTE_PRINT_LOG_AUD" 
    after update or delete on lote_print_log  
    for each row  
declare  
    t varchar2(128) := 'LOTE_PRINT_LOG';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
    if (:old.lote is null and :new.lote is not null) or   
        (:old.lote is not null and :new.lote is null) or   
        :old.lote != :new.lote then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LOTE', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.lote, :new.lote);  
  
    end if;  
    if (:old.sep_id is null and :new.sep_id is not null) or   
        (:old.sep_id is not null and :new.sep_id is null) or   
        :old.sep_id != :new.sep_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'SEP_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LOTE', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.lote, :new.lote);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'SEP_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.sep_id, :new.sep_id);  
  
end if;  
end lote_print_log_aud;  
 

/
ALTER TRIGGER "WMS"."LOTE_PRINT_LOG_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: LOTE_PRINT_LOG_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."LOTE_PRINT_LOG_BIU" 
    before insert or update   
    on lote_print_log  
    for each row  
begin  
    if :new.id is null then  
        :new.id := lote_print_log_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end lote_print_log_biu;  
 

/
ALTER TRIGGER "WMS"."LOTE_PRINT_LOG_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: MOVIMENTACAO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."MOVIMENTACAO_BIU" 
    before insert or update   
    on movimentacao  
    for each row  
begin  
    if :new.id is null then  
        :new.id := movimentacao_seq.nextval;  
    end if;  
    if :new.prioridade is null then  
        :new.prioridade := 9;  
    end if;  
end movimentacao_biu;  
 

/
ALTER TRIGGER "WMS"."MOVIMENTACAO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: MOVIMENTACAO_PALETE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."MOVIMENTACAO_PALETE_BIU" 
    before insert or update   
    on movimentacao_palete  
    for each row  
begin  
    if :new.id is null then  
        :new.id := movimentacao_palete_seq.nextval;  
    end if;  
end movimentacao_palete_biu;  
 

/
ALTER TRIGGER "WMS"."MOVIMENTACAO_PALETE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: MOVIMENTACAO_T1--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."MOVIMENTACAO_T1" 
BEFORE
update on WMS."MOVIMENTACAO"
for each row
begin
if :new.status = 4 and :new.tipo = 'P' then
  update endereco
     set qtd_atual = qtd_atual - :new.qtd
   where id = :new.origem_id;
  update lote
     set sep_id = :new.abast_id,
         sep_start = sysdate,
         sep_end = sysdate,
         status = 2
   where id = :new.lote_id;
elsif :new.status = 4 and :new.tipo in ('R','D') then
  update endereco
     set qtd_atual = qtd_atual - :new.qtd
   where id = :new.origem_id;
  update endereco
     set qtd_atual = qtd_atual + :new.qtd
   where id = :new.destino_id;
elsif :new.status = 4 and :new.tipo in ('E') then
  update endereco
     set qtd_atual = :new.qtd
   where id = :new.destino_id;
end if;
end;

/
ALTER TRIGGER "WMS"."MOVIMENTACAO_T1" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: MOVIMENTACAO_VISUAL_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."MOVIMENTACAO_VISUAL_AUD" 
    after update or delete on movimentacao_visual 
    for each row 
declare 
    t varchar2(128) := 'MOVIMENTACAO_VISUAL'; 
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user); 
begin 
if updating then 
    if (:old.id is null and :new.id is not null) or  
        (:old.id is not null and :new.id is null) or  
        :old.id != :new.id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id); 
 
    end if; 
    if (:old.origem_id is null and :new.origem_id is not null) or  
        (:old.origem_id is not null and :new.origem_id is null) or  
        :old.origem_id != :new.origem_id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'ORIGEM_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.origem_id, :new.origem_id); 
 
    end if; 
    if (:old.destino_id is null and :new.destino_id is not null) or  
        (:old.destino_id is not null and :new.destino_id is null) or  
        :old.destino_id != :new.destino_id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'DESTINO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.destino_id, :new.destino_id); 
 
    end if; 
    if (:old.qtd is null and :new.qtd is not null) or  
        (:old.qtd is not null and :new.qtd is null) or  
        :old.qtd != :new.qtd then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'QTD', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd, :new.qtd); 
 
    end if; 
    if (:old.embalagem_id is null and :new.embalagem_id is not null) or  
        (:old.embalagem_id is not null and :new.embalagem_id is null) or  
        :old.embalagem_id != :new.embalagem_id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'EMBALAGEM_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.embalagem_id, :new.embalagem_id); 
 
    end if; 
    if (:old.tipo is null and :new.tipo is not null) or  
        (:old.tipo is not null and :new.tipo is null) or  
        :old.tipo != :new.tipo then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc 
        ) values ( 
            history_seq.nextval, t, 'TIPO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.tipo, :new.tipo); 
 
    end if; 
    if (:old.palete_id is null and :new.palete_id is not null) or  
        (:old.palete_id is not null and :new.palete_id is null) or  
        :old.palete_id != :new.palete_id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'PALETE_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.palete_id, :new.palete_id); 
 
    end if; 
    if (:old.movimentacao_id is null and :new.movimentacao_id is not null) or  
        (:old.movimentacao_id is not null and :new.movimentacao_id is null) or  
        :old.movimentacao_id != :new.movimentacao_id then  
        insert into history ( 
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
        ) values ( 
            history_seq.nextval, t, 'MOVIMENTACAO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.movimentacao_id, :new.movimentacao_id); 
 
    end if; 
elsif deleting then 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'ORIGEM_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.origem_id, :new.origem_id); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'DESTINO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.destino_id, :new.destino_id); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'QTD', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd, :new.qtd); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'EMBALAGEM_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.embalagem_id, :new.embalagem_id); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc 
    ) values ( 
        history_seq.nextval, t, 'TIPO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.tipo, :new.tipo); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'PALETE_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.palete_id, :new.palete_id); 
    insert into history ( 
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number 
    ) values ( 
        history_seq.nextval, t, 'MOVIMENTACAO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.movimentacao_id, :new.movimentacao_id); 
 
end if; 
end movimentacao_visual_aud; 

/
ALTER TRIGGER "WMS"."MOVIMENTACAO_VISUAL_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: MOVIMENTACAO_VISUAL_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."MOVIMENTACAO_VISUAL_BIU" 
    before insert or update 
    on movimentacao_visual 
    for each row 
begin 
    if :new.id is null then 
        :new.id := movimentacao_visual_seq.nextval; 
    end if; 
    if inserting then 
        :new.created := sysdate; 
    end if; 
    :new.updated := sysdate; 
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user); 
end movimentacao_visual_biu; 

/
ALTER TRIGGER "WMS"."MOVIMENTACAO_VISUAL_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PALETE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PALETE_BIU" 
    before insert or update   
    on palete  
    for each row  
begin  
    if :new.id is null then  
        :new.id := palete_seq.nextval;  
    end if;  
end palete_biu;  
 

/
ALTER TRIGGER "WMS"."PALETE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PALETE_VALIDADE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PALETE_VALIDADE_BIU" 
    before insert or update   
    on palete_validade  
    for each row  
begin  
    if :new.id is null then  
        :new.id := palete_validade_seq.nextval;  
    end if;  
end palete_validade_biu;  
 

/
ALTER TRIGGER "WMS"."PALETE_VALIDADE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRINT_ERROR_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRINT_ERROR_AUD" 
    after update or delete on print_error  
    for each row  
declare  
    t varchar2(128) := 'PRINT_ERROR';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
    if (:old.lote is null and :new.lote is not null) or   
        (:old.lote is not null and :new.lote is null) or   
        :old.lote != :new.lote then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LOTE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
  
    end if;  
    if (:old.info is null and :new.info is not null) or   
        (:old.info is not null and :new.info is null) or   
        :old.info != :new.info then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'INFO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.info, :new.info);  
  
    end if;  
    if (:old.alert_status is null and :new.alert_status is not null) or   
        (:old.alert_status is not null and :new.alert_status is null) or   
        :old.alert_status != :new.alert_status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ALERT_STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.alert_status, :new.alert_status);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LOTE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.lote, :new.lote);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'INFO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.info, :new.info);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ALERT_STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.alert_status, :new.alert_status);  
  
end if;  
end print_error_aud;  
 

/
ALTER TRIGGER "WMS"."PRINT_ERROR_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRINT_ERROR_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRINT_ERROR_BIU" 
    before insert or update   
    on print_error  
    for each row  
begin  
    if :new.id is null then  
        :new.id := print_error_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end print_error_biu;  
 

/
ALTER TRIGGER "WMS"."PRINT_ERROR_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_AUD" 
    after update or delete on produtivo  
    for each row  
declare  
    t varchar2(128) := 'PRODUTIVO';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.status is null and :new.status is not null) or   
        (:old.status is not null and :new.status is null) or   
        :old.status != :new.status then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'STATUS', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.status, :new.status);  
  
    end if;  
    if (:old.nome is null and :new.nome is not null) or   
        (:old.nome is not null and :new.nome is null) or   
        :old.nome != :new.nome then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'NOME', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
  
    end if;  
    if (:old.apelido is null and :new.apelido is not null) or   
        (:old.apelido is not null and :new.apelido is null) or   
        :old.apelido != :new.apelido then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'APELIDO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.apelido, :new.apelido);  
  
    end if;  
    if (:old.nome_api_msg is null and :new.nome_api_msg is not null) or   
        (:old.nome_api_msg is not null and :new.nome_api_msg is null) or   
        :old.nome_api_msg != :new.nome_api_msg then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'NOME_API_MSG', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.nome_api_msg, :new.nome_api_msg);  
  
    end if;  
    if (:old.atividade is null and :new.atividade is not null) or   
        (:old.atividade is not null and :new.atividade is null) or   
        :old.atividade != :new.atividade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'ATIVIDADE', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.atividade, :new.atividade);  
  
    end if;  
    if (:old.funcao is null and :new.funcao is not null) or   
        (:old.funcao is not null and :new.funcao is null) or   
        :old.funcao != :new.funcao then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'FUNCAO', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.funcao, :new.funcao);  
  
    end if;  
    if (:old.padrao is null and :new.padrao is not null) or   
        (:old.padrao is not null and :new.padrao is null) or   
        :old.padrao != :new.padrao then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PADRAO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.padrao, :new.padrao);  
  
    end if;  
    if (:old.exclusivo is null and :new.exclusivo is not null) or   
        (:old.exclusivo is not null and :new.exclusivo is null) or   
        :old.exclusivo != :new.exclusivo then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'EXCLUSIVO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.exclusivo, :new.exclusivo);  
  
    end if;  
    if (:old.order_atv is null and :new.order_atv is not null) or   
        (:old.order_atv is not null and :new.order_atv is null) or   
        :old.order_atv != :new.order_atv then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'ORDER_ATV', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.order_atv, :new.order_atv);  
  
    end if;  
    if (:old.empnivel is null and :new.empnivel is not null) or   
        (:old.empnivel is not null and :new.empnivel is null) or   
        :old.empnivel != :new.empnivel then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'EMPNIVEL', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.empnivel, :new.empnivel);  
  
    end if;  
    if (:old.emptipo is null and :new.emptipo is not null) or   
        (:old.emptipo is not null and :new.emptipo is null) or   
        :old.emptipo != :new.emptipo then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'EMPTIPO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.emptipo, :new.emptipo);  
  
    end if;  
    if (:old.estacao is null and :new.estacao is not null) or   
        (:old.estacao is not null and :new.estacao is null) or   
        :old.estacao != :new.estacao then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ESTACAO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.estacao, :new.estacao);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'STATUS', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.status, :new.status);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'NOME', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'APELIDO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.apelido, :new.apelido);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'NOME_API_MSG', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.nome_api_msg, :new.nome_api_msg);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'ATIVIDADE', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.atividade, :new.atividade);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'FUNCAO', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.funcao, :new.funcao);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PADRAO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.padrao, :new.padrao);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'EXCLUSIVO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.exclusivo, :new.exclusivo);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'ORDER_ATV', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.order_atv, :new.order_atv);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'EMPNIVEL', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.empnivel, :new.empnivel);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'EMPTIPO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.emptipo, :new.emptipo);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ESTACAO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.estacao, :new.estacao);  
  
end if;  
end produtivo_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_BIU" 
    before insert or update   
    on produtivo  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produtivo_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end produtivo_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_BOX_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_BOX_AUD" 
    after update or delete on produtivo_box  
    for each row  
declare  
    t varchar2(128) := 'PRODUTIVO_BOX';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.produtivo_id is null and :new.produtivo_id is not null) or   
        (:old.produtivo_id is not null and :new.produtivo_id is null) or   
        :old.produtivo_id != :new.produtivo_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
  
    end if;  
    if (:old.box is null and :new.box is not null) or   
        (:old.box is not null and :new.box is null) or   
        :old.box != :new.box then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'BOX', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.box, :new.box);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'BOX', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.box, :new.box);  
  
end if;  
end produtivo_box_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_BOX_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_BOX_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_BOX_BIU" 
    before insert or update   
    on produtivo_box  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produtivo_box_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end produtivo_box_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_BOX_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_LS_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_LS_AUD" 
    after update or delete on produtivo_ls  
    for each row  
declare  
    t varchar2(128) := 'PRODUTIVO_LS';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.produtivo_id is null and :new.produtivo_id is not null) or   
        (:old.produtivo_id is not null and :new.produtivo_id is null) or   
        :old.produtivo_id != :new.produtivo_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
  
    end if;  
    if (:old.ls_id is null and :new.ls_id is not null) or   
        (:old.ls_id is not null and :new.ls_id is null) or   
        :old.ls_id != :new.ls_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LS_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.ls_id, :new.ls_id);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LS_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.ls_id, :new.ls_id);  
  
end if;  
end produtivo_ls_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_LS_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_LS_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_LS_BIU" 
    before insert or update   
    on produtivo_ls  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produtivo_ls_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end produtivo_ls_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_LS_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_RUA_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_RUA_AUD" 
    after update or delete on produtivo_rua  
    for each row  
declare  
    t varchar2(128) := 'PRODUTIVO_RUA';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.produtivo_id is null and :new.produtivo_id is not null) or   
        (:old.produtivo_id is not null and :new.produtivo_id is null) or   
        :old.produtivo_id != :new.produtivo_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
  
    end if;  
    if (:old.rua is null and :new.rua is not null) or   
        (:old.rua is not null and :new.rua is null) or   
        :old.rua != :new.rua then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'RUA', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.rua, :new.rua);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTIVO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produtivo_id, :new.produtivo_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'RUA', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.rua, :new.rua);  
  
end if;  
end produtivo_rua_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_RUA_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_RUA_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_RUA_BIU" 
    before insert or update   
    on produtivo_rua  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produtivo_rua_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end produtivo_rua_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_RUA_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTIVO_WEBSOCKET--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTIVO_WEBSOCKET" 
  after update on produtivo  
  for each row  
declare 
  v_em_atividade number; 
begin 
  select count(*) 
    into v_em_atividade 
    from ATIVIDADE A 
   where ((:new.ATIVIDADE = 'S' and A.STATUS = 1 and A.SEP_ID = :new.ID) 
       or (:new.ATIVIDADE = 'C' and A.STATUS = 3 and A.CONF_ID = :new.ID) 
  ); 
     
  if :old.status = 1 and :new.status = 0 and v_em_atividade = 0 then 
    ws_notify_api.do_rest_notify_user( 
      i_userid   => to_char(:old.id), 
      i_room     => 'private', 
      i_type     => 'warn', 
      i_title    => 'My test title', 
      i_message  => 'My test message content...' 
    ); 
  end if; 
end produtivo_aud; 
 

/
ALTER TRIGGER "WMS"."PRODUTIVO_WEBSOCKET" ENABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTO_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTO_AUD" 
    after update or delete on produto  
    for each row  
declare  
    t varchar2(128) := 'PRODUTO';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.nome is null and :new.nome is not null) or   
        (:old.nome is not null and :new.nome is null) or   
        :old.nome != :new.nome then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'NOME', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'NOME', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.nome, :new.nome);  
  
end if;  
end produto_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTO_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTO_BIU" 
    before insert   
    on produto  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produto_seq.nextval;  
    end if;  
end produto_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTO_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTO_EMBALAGEM_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTO_EMBALAGEM_AUD" 
    after update or delete on produto_embalagem  
    for each row  
declare  
    t varchar2(128) := 'PRODUTO_EMBALAGEM';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.ls is null and :new.ls is not null) or   
        (:old.ls is not null and :new.ls is null) or   
        :old.ls != :new.ls then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'LS', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
  
    end if;  
    if (:old.produto_id is null and :new.produto_id is not null) or   
        (:old.produto_id is not null and :new.produto_id is null) or   
        :old.produto_id != :new.produto_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
  
    end if;  
    if (:old.emb is null and :new.emb is not null) or   
        (:old.emb is not null and :new.emb is null) or   
        :old.emb != :new.emb then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
        ) values (  
            history_seq.nextval, t, 'EMB', :old.id, null, 'U', sysdate, u, 'VARCHAR2', :old.emb, :new.emb);  
  
    end if;  
    if (:old.qtd_emb is null and :new.qtd_emb is not null) or   
        (:old.qtd_emb is not null and :new.qtd_emb is null) or   
        :old.qtd_emb != :new.qtd_emb then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
  
    end if;  
    if (:old.peso_bruto is null and :new.peso_bruto is not null) or   
        (:old.peso_bruto is not null and :new.peso_bruto is null) or   
        :old.peso_bruto != :new.peso_bruto then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO_BRUTO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso_bruto, :new.peso_bruto);  
  
    end if;  
    if (:old.peso_liquido is null and :new.peso_liquido is not null) or   
        (:old.peso_liquido is not null and :new.peso_liquido is null) or   
        :old.peso_liquido != :new.peso_liquido then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PESO_LIQUIDO', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.peso_liquido, :new.peso_liquido);  
  
    end if;  
    if (:old.altura is null and :new.altura is not null) or   
        (:old.altura is not null and :new.altura is null) or   
        :old.altura != :new.altura then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ALTURA', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.altura, :new.altura);  
  
    end if;  
    if (:old.largura is null and :new.largura is not null) or   
        (:old.largura is not null and :new.largura is null) or   
        :old.largura != :new.largura then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'LARGURA', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.largura, :new.largura);  
  
    end if;  
    if (:old.profundidade is null and :new.profundidade is not null) or   
        (:old.profundidade is not null and :new.profundidade is null) or   
        :old.profundidade != :new.profundidade then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'PROFUNDIDADE', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.profundidade, :new.profundidade);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'LS', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.ls, :new.ls);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PRODUTO_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.produto_id, :new.produto_id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_vc, new_vc  
    ) values (  
        history_seq.nextval, t, 'EMB', :old.id, null, 'D', sysdate, u, 'VARCHAR2', :old.emb, :new.emb);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'QTD_EMB', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.qtd_emb, :new.qtd_emb);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO_BRUTO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso_bruto, :new.peso_bruto);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PESO_LIQUIDO', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.peso_liquido, :new.peso_liquido);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ALTURA', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.altura, :new.altura);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'LARGURA', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.largura, :new.largura);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'PROFUNDIDADE', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.profundidade, :new.profundidade);  
  
end if;  
end produto_embalagem_aud;  
 

/
ALTER TRIGGER "WMS"."PRODUTO_EMBALAGEM_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTO_EMBALAGEM_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTO_EMBALAGEM_BIU" 
    before insert   
    on produto_embalagem  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produto_embalagem_seq.nextval;  
    end if;  
end produto_embalagem_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTO_EMBALAGEM_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PRODUTO_ESPECIE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PRODUTO_ESPECIE_BIU" 
    before insert or update   
    on produto_especie  
    for each row  
begin  
    if :new.id is null then  
        :new.id := produto_especie_seq.nextval;  
    end if;  
end produto_especie_biu;  
 

/
ALTER TRIGGER "WMS"."PRODUTO_ESPECIE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PULMAO_BOX_AUD--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PULMAO_BOX_AUD" 
    after update or delete on pulmao_box  
    for each row  
declare  
    t varchar2(128) := 'PULMAO_BOX';  
    u varchar2(128) := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
begin  
if updating then  
    if (:old.id is null and :new.id is not null) or   
        (:old.id is not null and :new.id is null) or   
        :old.id != :new.id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.id, :new.id);  
  
    end if;  
    if (:old.carga_id is null and :new.carga_id is not null) or   
        (:old.carga_id is not null and :new.carga_id is null) or   
        :old.carga_id != :new.carga_id then   
        insert into history (  
            id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
        ) values (  
            history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'U', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
    end if;  
elsif deleting then  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.id, :new.id);  
    insert into history (  
        id, table_name, column_name, pk1, tab_row_version, action, action_date, action_by, data_type, old_number, new_number  
    ) values (  
        history_seq.nextval, t, 'CARGA_ID', :old.id, null, 'D', sysdate, u, 'NUMBER', :old.carga_id, :new.carga_id);  
  
end if;  
end pulmao_box_aud;  
 

/
ALTER TRIGGER "WMS"."PULMAO_BOX_AUD" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: PULMAO_BOX_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."PULMAO_BOX_BIU" 
    before insert or update   
    on pulmao_box  
    for each row  
begin  
    if :new.id is null then  
        :new.id := pulmao_box_seq.nextval;  
    end if;  
    if inserting then  
        :new.created := sysdate;  
        :new.created_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
    end if;  
    :new.updated := sysdate;  
    :new.updated_by := nvl(sys_context('APEX$SESSION','APP_USER'),user);  
end pulmao_box_biu;  
 

/
ALTER TRIGGER "WMS"."PULMAO_BOX_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: REGRA_VALIDADE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."REGRA_VALIDADE_BIU" 
    before insert or update   
    on regra_validade  
    for each row  
begin  
    if :new.id is null then  
        :new.id := regra_validade_seq.nextval;  
    end if;  
end regra_validade_biu;  
 

/
ALTER TRIGGER "WMS"."REGRA_VALIDADE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: TESTE_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."TESTE_BIU" 
    before insert or update   
    on teste  
    for each row  
begin  
    if :new.id is null then  
        :new.id := teste_seq.nextval;  
    end if;  
end teste_biu;  
 

/
ALTER TRIGGER "WMS"."TESTE_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: TIPO_ARMAZENAGEM_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."TIPO_ARMAZENAGEM_BIU" 
    before insert or update   
    on tipo_armazenagem  
    for each row  
begin  
    if :new.id is null then  
        :new.id := tipo_armazenagem_seq.nextval;  
    end if;  
end tipo_armazenagem_biu;  
 

/
ALTER TRIGGER "WMS"."TIPO_ARMAZENAGEM_BIU" DISABLE;
--------------------------------------------------------------------------------
--TRIGGER: USUARIO_BIU--------------------------------------------------------
CREATE OR REPLACE EDITIONABLE TRIGGER "WMS"."USUARIO_BIU" 
    before insert or update   
    on usuario  
    for each row  
begin  
    if :new.id is null then  
        :new.id := usuario_seq.nextval;  
    end if;  
end usuario_biu;  
 

/
ALTER TRIGGER "WMS"."USUARIO_BIU" DISABLE;
--------------------------------------------------------------------------------
